id: virusTotalPrivateAPI-test-playbook
version: -1
name: virusTotalPrivateAPI-test-playbook
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: e3393036-84e4-44ed-8600-56e48f9e0008
    type: start
    task:
      id: e3393036-84e4-44ed-8600-56e48f9e0008
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": -510
        }
      }
    note: false
    timertriggers: []
  "1":
    id: "1"
    taskid: dd227d7d-df8d-4bdf-81fe-212ddf120b24
    type: regular
    task:
      id: dd227d7d-df8d-4bdf-81fe-212ddf120b24
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 195
        }
      }
    note: false
    timertriggers: []
  "12":
    id: "12"
    taskid: 07508a80-84db-4b42-8438-f8ab9c1bd4c2
    type: title
    task:
      id: 07508a80-84db-4b42-8438-f8ab9c1bd4c2
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2320
        }
      }
    note: false
    timertriggers: []
  "14":
    id: "14"
    taskid: 8a49aaec-df75-4adb-8c38-01f00e92c6ad
    type: regular
    task:
      id: 8a49aaec-df75-4adb-8c38-01f00e92c6ad
      version: -1
      name: vt-get-domain-report
      description: Retrieves a report on a given domain (including the information
        recorded by VirusTotal's passive DNS infrastructure).
      script: '|||vt-private-get-domain-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      domain:
        simple: google.com
      fullResponse: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
  "16":
    id: "16"
    taskid: af52b87a-914c-4a6a-803a-f2fdb142c61d
    type: condition
    task:
      id: af52b87a-914c-4a6a-803a-f2fdb142c61d
      version: -1
      name: Verify Domain Whois Contains
      description: "Checks whether substring is within string. Returns: \nyes - string
        contains substring. \nno - string does not contain substring. \nIf stringSeperator
        is provided, the substring will be split using the separator, and each item
        will be checked.\nIf one of the items will be found in the string, the srcipt
        will return yes.\n"
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "19"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsString
          left:
            value:
              complex:
                root: Domain
                accessor: VirusTotal.Whois
            iscontext: true
          right:
            value:
              simple: GOOGLE
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
  "17":
    id: "17"
    taskid: bb671564-4062-4936-85c7-f664632b3e21
    type: regular
    task:
      id: bb671564-4062-4936-85c7-f664632b3e21
      version: -1
      name: vt-get-file-report
      description: Retrieves a concluded url scan report for a given url.
      script: '|||vt-private-get-file-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      allInfo: {}
      resource:
        simple: 65d7c8c92a2dce75ba037bb6f89258fdd5f786dfe36d0315fdb7e6f31ad78d36
      shortFormat: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
  "18":
    id: "18"
    taskid: 0082b3fd-f2df-40e2-8863-44886ba8d734
    type: condition
    task:
      id: 0082b3fd-f2df-40e2-8863-44886ba8d734
      version: -1
      name: Verify File Malicious
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              complex:
                root: File
                accessor: Malicious
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
  "19":
    id: "19"
    taskid: 367b3d73-077c-4e6e-8eac-933e7a3c7ff8
    type: regular
    task:
      id: 367b3d73-077c-4e6e-8eac-933e7a3c7ff8
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
  "20":
    id: "20"
    taskid: 738b0761-af47-450c-8e99-999fcf1c44bc
    type: regular
    task:
      id: 738b0761-af47-450c-8e99-999fcf1c44bc
      version: -1
      name: vt-private-get-url-report
      description: Retrieves a concluded url scan report for a given url.
      script: '|||vt-private-get-url-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      allInfo: {}
      fullResponse: {}
      resource:
        simple: http://En-us.secureconnection.moneytransaction.kb4.io
      retries: {}
      retry_time: {}
      shortFormat: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
  "21":
    id: "21"
    taskid: e28a600d-edba-497e-8c04-5f8427462fa9
    type: regular
    task:
      id: e28a600d-edba-497e-8c04-5f8427462fa9
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
  "22":
    id: "22"
    taskid: f5b93cf3-ecec-4dbc-8810-f5977bce56d8
    type: regular
    task:
      id: f5b93cf3-ecec-4dbc-8810-f5977bce56d8
      version: -1
      name: vt-private-get-ip-report
      description: Retrieves a report on a given IP address (including the information
        recorded by VirusTotal's Passive DNS infrastructure).
      script: '|||vt-private-get-ip-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 139.130.4.5
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
  "23":
    id: "23"
    taskid: 08de22ac-69ff-4e08-8938-dacf11de84d6
    type: condition
    task:
      id: 08de22ac-69ff-4e08-8938-dacf11de84d6
      version: -1
      name: Verify DBot Score of ip
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              complex:
                root: DBotScore
                accessor: Score
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
  "24":
    id: "24"
    taskid: 9c0f4d1b-70d6-4dc0-8430-3888ada6e8f6
    type: regular
    task:
      id: 9c0f4d1b-70d6-4dc0-8430-3888ada6e8f6
      version: -1
      name: Sleep
      description: Sleep for X seconds
      scriptName: Sleep
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      seconds:
        simple: "60"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
  "25":
    id: "25"
    taskid: f749615b-d766-4b3a-852f-98ed6ac5ed34
    type: regular
    task:
      id: f749615b-d766-4b3a-852f-98ed6ac5ed34
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
  "26":
    id: "26"
    taskid: 60938377-851a-4ced-89fb-1cd8a94f923f
    type: regular
    task:
      id: 60938377-851a-4ced-89fb-1cd8a94f923f
      version: -1
      name: Get info on file
      script: '|||vt-private-get-file-report'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "28"
    scriptarguments:
      allInfo: {}
      resource:
        simple: 8de4b0e8bab8fc35375e20650eae4230
      shortFormat: {}
      threshold: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": -130
        }
      }
    note: false
    timertriggers: []
  "27":
    id: "27"
    taskid: 636a6a0b-d42a-4661-8d4e-d365425c5bee
    type: regular
    task:
      id: 636a6a0b-d42a-4661-8d4e-d365425c5bee
      version: -1
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": -320
        }
      }
    note: false
    timertriggers: []
  "28":
    id: "28"
    taskid: 07cfcabc-56c6-41f5-8a3d-05c1600e2a35
    type: condition
    task:
      id: 07cfcabc-56c6-41f5-8a3d-05c1600e2a35
      version: -1
      name: 'Verify file is malicious '
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "1"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 40
        }
      }
    note: false
    timertriggers: []
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2895,
        "width": 380,
        "x": 50,
        "y": -510
      }
    }
  }
inputs: []
outputs: []
