id: Cherwell - test
version: -1
name: Cherwell - test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c5716ca3-4f4d-4c80-83f5-0989f6f13167
    type: start
    task:
      id: c5716ca3-4f4d-4c80-83f5-0989f6f13167
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 7364c9a1-e22a-471f-8b1a-bac4d4fafab2
    type: regular
    task:
      id: 7364c9a1-e22a-471f-8b1a-bac4d4fafab2
      version: -1
      name: Create Business Object - Incident
      description: Create a business object
      script: '|||cherwell-create-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      json:
        simple: '{"Priority": "3", "CustomerDisplayName": "Test customer", "Description":
          "This incident was created by Cherwell test playbook"}'
      type:
        simple: Incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: 691de06a-ee8a-4d0d-8a57-6ea1d05e41db
    type: condition
    task:
      id: 691de06a-ee8a-4d0d-8a57-6ea1d05e41db
      version: -1
      name: Validate ID's in the context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Cherwell.BusinessObjects.RecordID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Cherwell.BusinessObjects.PublicID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: cf4e5344-8796-40a3-8a55-2ad7c8945941
    type: regular
    task:
      id: cf4e5344-8796-40a3-8a55-2ad7c8945941
      version: -1
      name: Update Business Object - Incident priority to 1
      description: Update a business object with the given fields
      script: '|||cherwell-update-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.BusinessObjects.RecordID}
      json:
        simple: '{"Priority": "1"}'
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 52bf54d6-83b3-40af-80ed-9b5f830dfc11
    type: condition
    task:
      id: 52bf54d6-83b3-40af-80ed-9b5f830dfc11
      version: -1
      name: Validate Priority is 1
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              simple: Cherwell.BusinessObjects.Priority
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: 737e36d2-e3f9-4443-8ac9-f3f033df70a9
    type: regular
    task:
      id: 737e36d2-e3f9-4443-8ac9-f3f033df70a9
      version: -1
      name: Get Business Object - Get the last created incident
      description: Get a business objects by an ID
      script: '|||cherwell-get-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      id_type:
        simple: public_id
      id_value:
        simple: ${Cherwell.BusinessObjects.PublicID}
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 86628cf8-04c4-46d5-8e29-be1de0e3f35c
    type: regular
    task:
      id: 86628cf8-04c4-46d5-8e29-be1de0e3f35c
      version: -1
      name: 'Create File '
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      scriptName: FileCreateAndUpload
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      data:
        simple: This is dummy data for Cherwell test
      entryId: {}
      filename:
        simple: CherwellTestFile.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: 75ababce-538c-4ff0-8017-ce37c837dd73
    type: regular
    task:
      id: 75ababce-538c-4ff0-8017-ce37c837dd73
      version: -1
      name: Upload Attachment to Cherwell
      description: Upload an attachment to a given business object
      script: '|||cherwell-upload-attachment'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      file_entry_id:
        simple: ${File.EntryID}
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.BusinessObjects.RecordID}
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: 6ce5274d-5671-4d6f-8b12-762181322ed8
    type: regular
    task:
      id: 6ce5274d-5671-4d6f-8b12-762181322ed8
      version: -1
      name: Get Attachment Info
      description: Get business object attachments info
      script: '|||cherwell-get-attachments-info'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.UploadedAttachments.PublicID}${Cherwell.UploadedAttachments.RecordId}
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: 3ae65855-afdb-48dc-8080-d854fc5e6adb
    type: regular
    task:
      id: 3ae65855-afdb-48dc-8080-d854fc5e6adb
      version: -1
      name: Download Attachment
      description: Get attachements from given business object
      script: '|||cherwell-download-attachments'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.UploadedAttachments.RecordId}
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 490e855a-dbf0-4215-813f-4148a4313923
    type: condition
    task:
      id: 490e855a-dbf0-4215-813f-4148a4313923
      version: -1
      name: Validate Upload Attachment
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Cherwell.UploadedAttachments.AttachmentFileID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Cherwell.UploadedAttachments.BusinessObjectType
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Cherwell
                accessor: UploadedAttachments.RecordId
            iscontext: true
          right:
            value:
              complex:
                root: Cherwell
                accessor: BusinessObjects.RecordID
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: 0c15b7fd-f8e4-4401-8098-382c7e2b209f
    type: condition
    task:
      id: 0c15b7fd-f8e4-4401-8098-382c7e2b209f
      version: -1
      name: Validate Get Attachment Info
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Cherwell
                accessor: AttachmentsInfo.AttachmentFiledID
            iscontext: true
          right:
            value:
              simple: Cherwell.UploadedAttachments.AttachmentFileID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Cherwell.AttachmentsInfo.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Cherwell.AttachmentsInfo.AttachmentID
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Cherwell
                accessor: AttachmentsInfo.BusinessObjectType
                transformers:
                - operator: atIndex
                  args:
                    index:
                      value:
                        simple: "0"
            iscontext: true
          right:
            value:
              simple: Cherwell.UploadedAttachments.BusinessObjectType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: afd19eab-bf5d-4102-8693-83f9c6b8a97c
    type: condition
    task:
      id: afd19eab-bf5d-4102-8693-83f9c6b8a97c
      version: -1
      name: Validate Download Attachment
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: File
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: Name
                transformers:
                - operator: atIndex
                  args:
                    index:
                      value:
                        simple: "1"
            iscontext: true
          right:
            value:
              simple: CherwellTestFile.txt
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: fb29cccb-12cc-4ff9-83f8-22e3dd4ae8a8
    type: regular
    task:
      id: fb29cccb-12cc-4ff9-83f8-22e3dd4ae8a8
      version: -1
      name: Remove Attachment
      description: Remove the given attachment from the given business object
      script: '|||cherwell-remove-attachment'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      attachment_id:
        simple: ${Cherwell.AttachmentsInfo.AttachmentID}
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.AttachmentsInfo.BusinessObjectRecordId}
      type:
        simple: ${Cherwell.AttachmentsInfo.BusinessObjectType}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: b67cd552-9fae-4b66-83c8-cce30c060b4d
    type: regular
    task:
      id: b67cd552-9fae-4b66-83c8-cce30c060b4d
      version: -1
      name: Link Business Objects - Incident Own Task
      description: Link related business objects
      script: '|||cherwell-link-business-objects'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      child_record_id:
        complex:
          root: Cherwell
          accessor: BusinessObjects.RecordID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "1"
      child_type:
        simple: Task
      parent_record_id:
        complex:
          root: Cherwell
          accessor: BusinessObjects.RecordID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      parent_type:
        simple: incident
      relationship_id:
        simple: 9369187528b417b4a17aaa4646b7f7a78b3c821be9
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 7c6d2209-7b3e-4139-8998-bca2bd47b5be
    type: regular
    task:
      id: 7c6d2209-7b3e-4139-8998-bca2bd47b5be
      version: -1
      name: Create Business Object - Task
      description: Create a business object
      script: '|||cherwell-create-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      json:
        simple: '{"Title": "Test task", "Description": "Test task generated from test
          playbook", "OwnedByTeam": "HR",  "Type":"Work Item", "Status":"New"}'
      type:
        simple: Task
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: 1df1b89e-67b1-4eed-8d23-62d80a3a904b
    type: regular
    task:
      id: 1df1b89e-67b1-4eed-8d23-62d80a3a904b
      version: -1
      name: Delete context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: aa77b1df-8a72-48fc-8129-131833996879
    type: regular
    task:
      id: aa77b1df-8a72-48fc-8129-131833996879
      version: -1
      name: Unlink Business Objects - Incident Own Task
      description: Unlink linked, related business objects
      script: '|||cherwell-unlink-business-objects'
      type: regular
      iscommand: true
      brand: ""
    scriptarguments:
      child_record_id:
        complex:
          root: Cherwell
          accessor: BusinessObjects.RecordID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "1"
      child_type:
        simple: Task
      parent_record_id:
        complex:
          root: Cherwell
          accessor: BusinessObjects.RecordID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      parent_type:
        simple: incident
      relationship_id:
        simple: 9369187528b417b4a17aaa4646b7f7a78b3c821be9
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: b15e1d69-f539-4c92-883e-e36aca261aee
    type: regular
    task:
      id: b15e1d69-f539-4c92-883e-e36aca261aee
      version: -1
      name: 'Query Business Object '
      description: Run advanced queries to search in a given business object.
      script: '|||cherwell-query-business-object'
      type: regular
      iscommand: true
      brand: ""
    scriptarguments:
      max_results: {}
      query:
        simple: Description::contains::test playbook
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: b977b429-4452-4835-8998-709954682ca3
    type: regular
    task:
      id: b977b429-4452-4835-8998-709954682ca3
      version: -1
      name: Get Field Info
      description: Get field info by one of its properties (Name, DIsplay Name or
        ID)
      script: '|||cherwell-get-field-info'
      type: regular
      iscommand: true
      brand: ""
    scriptarguments:
      field_property:
        simple: Customer Display Name
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: 4e993201-8ff0-48f9-809a-0956f3f50c3f
    type: regular
    task:
      id: 4e993201-8ff0-48f9-809a-0956f3f50c3f
      version: -1
      name: Fetch Incidents
      description: Execute FetchIncident for a given instance
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      add_to_context: {}
      brand_name:
        simple: Cherwell
      expect_data: {}
      instance_name:
        simple: ${incident.sourceinstance}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: f9ce1480-9a68-491a-866e-25d01998ba08
    type: title
    task:
      id: f9ce1480-9a68-491a-866e-25d01998ba08
      version: -1
      name: Additional Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
      - "19"
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "22":
    id: "22"
    taskid: a79067b1-0d72-49e8-83fd-ec6aa13ceeaa
    type: title
    task:
      id: a79067b1-0d72-49e8-83fd-ec6aa13ceeaa
      version: -1
      name: Business Object Flow
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3185,
        "width": 1670,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
