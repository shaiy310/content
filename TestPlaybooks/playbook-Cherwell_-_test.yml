id: Cherwell - test
version: -1
name: Cherwell - test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: c5716ca3-4f4d-4c80-83f5-0989f6f13167
    type: start
    task:
      id: c5716ca3-4f4d-4c80-83f5-0989f6f13167
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 7364c9a1-e22a-471f-8b1a-bac4d4fafab2
    type: regular
    task:
      id: 7364c9a1-e22a-471f-8b1a-bac4d4fafab2
      version: -1
      name: Create Business Object - Incident
      description: Create a business object
      script: '|||cherwell-create-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      json:
        simple: '{"Priority": "3", "CustomerDisplayName": "Test customer", "Description":
          "This incident was created by Cherwell test playbook"}'
      type:
        simple: Incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: 830ef0f9-a3c2-4d47-8fbe-4dca048923f7
    type: condition
    task:
      id: 830ef0f9-a3c2-4d47-8fbe-4dca048923f7
      version: -1
      name: Validate ID's in the context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
      - "22"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Cherwell.BusinessObjects.RecordId
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Cherwell.BusinessObjects.PublicId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 6171976f-0d49-4a86-803b-36a44c1e377d
    type: regular
    task:
      id: 6171976f-0d49-4a86-803b-36a44c1e377d
      version: -1
      name: Update Business Object - Incident priority to 1
      description: Update a business object with the given fields
      script: '|||cherwell-update-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "5"
    scriptarguments:
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.BusinessObjects.RecordId}
      json:
        simple: '{"Priority": "1"}'
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 865
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: e2d13b2b-5082-43ae-8673-ed6b8ca161f5
    type: condition
    task:
      id: e2d13b2b-5082-43ae-8673-ed6b8ca161f5
      version: -1
      name: Validate Priority is 1
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualNumber
          left:
            value:
              simple: Cherwell.BusinessObjects.Priority
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: b295646a-d586-44ed-8975-1669eeeececb
    type: regular
    task:
      id: b295646a-d586-44ed-8975-1669eeeececb
      version: -1
      name: Get Business Object - Get the last created incident
      description: Get a business objects by an ID
      script: '|||cherwell-get-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      id_type:
        simple: public_id
      id_value:
        simple: ${Cherwell.BusinessObjects.PublicId}
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 86628cf8-04c4-46d5-8e29-be1de0e3f35c
    type: regular
    task:
      id: 86628cf8-04c4-46d5-8e29-be1de0e3f35c
      version: -1
      name: 'Create File '
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      scriptName: FileCreateAndUpload
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      data:
        simple: This is dummy data for Cherwell test
      entryId: {}
      filename:
        simple: CherwellTestFile.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: 0b332fc0-a63b-42a0-8c0f-2f172aefd117
    type: regular
    task:
      id: 0b332fc0-a63b-42a0-8c0f-2f172aefd117
      version: -1
      name: Upload Attachment to Cherwell
      description: Upload an attachment to a given business object
      script: '|||cherwell-upload-attachment'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      file_entry_id:
        simple: ${File.EntryID}
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.BusinessObjects.RecordId}
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: 378ecb0a-7a6e-44ec-8b96-ffc8feb76b0e
    type: regular
    task:
      id: 378ecb0a-7a6e-44ec-8b96-ffc8feb76b0e
      version: -1
      name: Get Attachment Info
      description: Get business object attachments info
      script: '|||cherwell-get-attachments-info'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "11"
    scriptarguments:
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.UploadedAttachments.RecordId}
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: d5ef1963-2f27-4332-8e70-2e3c930ad89a
    type: regular
    task:
      id: d5ef1963-2f27-4332-8e70-2e3c930ad89a
      version: -1
      name: Download Attachment
      description: Get attachements from given business object
      script: '|||cherwell-download-attachments'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.UploadedAttachments.RecordId}
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 0ca3bb23-7a8a-46a2-802a-bda490ed042f
    type: condition
    task:
      id: 0ca3bb23-7a8a-46a2-802a-bda490ed042f
      version: -1
      name: Validate Upload Attachment
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: Cherwell.UploadedAttachments.AttachmentFileId
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Cherwell.UploadedAttachments.BusinessObjectType
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Cherwell
                accessor: UploadedAttachments.RecordId
            iscontext: true
          right:
            value:
              complex:
                root: Cherwell
                accessor: BusinessObjects.RecordId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: f70ef993-8fe2-47d1-8987-c54805fb2f24
    type: condition
    task:
      id: f70ef993-8fe2-47d1-8987-c54805fb2f24
      version: -1
      name: Validate Get Attachment Info
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "9"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Cherwell
                accessor: AttachmentsInfo.AttachmentFiledId
            iscontext: true
          right:
            value:
              simple: Cherwell.UploadedAttachments.AttachmentFileId
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Cherwell.AttachmentsInfo.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: Cherwell.AttachmentsInfo.AttachmentId
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: Cherwell
                accessor: AttachmentsInfo.BusinessObjectType
                transformers:
                - operator: atIndex
                  args:
                    index:
                      value:
                        simple: "0"
            iscontext: true
          right:
            value:
              simple: Cherwell.UploadedAttachments.BusinessObjectType
            iscontext: true
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: acaa0892-eab8-4c06-8068-0d63a4464426
    type: condition
    task:
      id: acaa0892-eab8-4c06-8068-0d63a4464426
      version: -1
      name: Validate Download Attachment
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "13"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: File
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              complex:
                root: File
                accessor: Name
                transformers:
                - operator: atIndex
                  args:
                    index:
                      value:
                        simple: "1"
            iscontext: true
          right:
            value:
              simple: CherwellTestFile.txt
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: a081b455-314c-4069-8b2a-70fa050a297d
    type: regular
    task:
      id: a081b455-314c-4069-8b2a-70fa050a297d
      version: -1
      name: Remove Attachment
      description: Remove the given attachment from the given business object
      script: '|||cherwell-remove-attachment'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      attachment_id:
        simple: ${Cherwell.AttachmentsInfo.AttachmentId}
      id_type:
        simple: record_id
      id_value:
        simple: ${Cherwell.AttachmentsInfo.BusinessObjectRecordId}
      type:
        simple: ${Cherwell.AttachmentsInfo.BusinessObjectType}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2615
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: ecf8ed39-e21e-4d07-867b-876a5d92ebab
    type: regular
    task:
      id: ecf8ed39-e21e-4d07-867b-876a5d92ebab
      version: -1
      name: Link Business Objects - Incident Own Task
      description: Link related business objects
      script: '|||cherwell-link-business-objects'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "17"
    scriptarguments:
      child_record_id:
        complex:
          root: Cherwell
          accessor: BusinessObjects.RecordId
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "1"
      child_type:
        simple: Task
      parent_record_id:
        complex:
          root: Cherwell
          accessor: BusinessObjects.RecordId
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      parent_type:
        simple: incident
      relationship_id:
        simple: 9369187528b417b4a17aaa4646b7f7a78b3c821be9
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 3a806d2e-5331-4dda-8586-3aaa8f9237b6
    type: regular
    task:
      id: 3a806d2e-5331-4dda-8586-3aaa8f9237b6
      version: -1
      name: Create Business Object - Task
      description: Create a business object
      script: '|||cherwell-create-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      json:
        simple: '{"Title": "Test task", "Description": "Test task generated from test
          playbook", "OwnedByTeam": "HR",  "Type":"Work Item", "Status":"New"}'
      type:
        simple: Task
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 2790
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: 1df1b89e-67b1-4eed-8d23-62d80a3a904b
    type: regular
    task:
      id: 1df1b89e-67b1-4eed-8d23-62d80a3a904b
      version: -1
      name: Delete context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: 6788eabe-5963-4f10-8d62-4a5ab369f76e
    type: regular
    task:
      id: 6788eabe-5963-4f10-8d62-4a5ab369f76e
      version: -1
      name: Unlink Business Objects - Incident Own Task
      description: Unlink linked, related business objects
      script: '|||cherwell-unlink-business-objects'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      child_record_id:
        complex:
          root: Cherwell
          accessor: BusinessObjects.RecordId
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "1"
      child_type:
        simple: Task
      parent_record_id:
        complex:
          root: Cherwell
          accessor: BusinessObjects.RecordId
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      parent_type:
        simple: incident
      relationship_id:
        simple: 9369187528b417b4a17aaa4646b7f7a78b3c821be9
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: b15e1d69-f539-4c92-883e-e36aca261aee
    type: regular
    task:
      id: b15e1d69-f539-4c92-883e-e36aca261aee
      version: -1
      name: 'Query Business Object '
      description: Run advanced queries to search in a given business object.
      script: '|||cherwell-query-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    scriptarguments:
      max_results: {}
      query:
        simple: Description::contains::test playbook
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: b977b429-4452-4835-8998-709954682ca3
    type: regular
    task:
      id: b977b429-4452-4835-8998-709954682ca3
      version: -1
      name: Get Field Info
      description: Get field info by one of its properties (Name, DIsplay Name or
        ID)
      script: '|||cherwell-get-field-info'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
    scriptarguments:
      field_property:
        simple: Customer Display Name
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: 39ff1912-b68f-4b17-8472-4be624c9407e
    type: regular
    task:
      id: 39ff1912-b68f-4b17-8472-4be624c9407e
      version: -1
      name: Fetch Incidents
      description: Execute FetchIncident for a given instance
      scriptName: FetchFromInstance
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      add_to_context:
        simple: "true"
      brand_name:
        simple: Cherwell
      expect_data: {}
      instance_name: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2965
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: f9ce1480-9a68-491a-866e-25d01998ba08
    type: title
    task:
      id: f9ce1480-9a68-491a-866e-25d01998ba08
      version: -1
      name: Additional Commands
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "18"
      - "19"
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2805
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "22":
    id: "22"
    taskid: a79067b1-0d72-49e8-83fd-ec6aa13ceeaa
    type: title
    task:
      id: a79067b1-0d72-49e8-83fd-ec6aa13ceeaa
      version: -1
      name: Business Object Flow
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1340,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "23":
    id: "23"
    taskid: 1a6ca0d3-1ed3-49e2-897d-1c2db1af2cc1
    type: regular
    task:
      id: 1a6ca0d3-1ed3-49e2-897d-1c2db1af2cc1
      version: -1
      name: Delete Business Object
      description: Delete a given business object
      script: '|||cherwell-delete-business-object'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      id_type:
        simple: public_id
      id_value:
        complex:
          root: Cherwell
          accessor: BusinessObjects.PublicId
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
      type:
        simple: incident
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3315
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "24":
    id: "24"
    taskid: 78af4fa3-2142-4bdb-8863-59a8a53f583c
    type: title
    task:
      id: 78af4fa3-2142-4bdb-8863-59a8a53f583c
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 3490
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "25":
    id: "25"
    taskid: f6ab0984-4fce-4e23-8e5c-f5b3dc2823f2
    type: condition
    task:
      id: f6ab0984-4fce-4e23-8e5c-f5b3dc2823f2
      version: -1
      name: Validate Query Business Object
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: Cherwell
                accessor: QueryResults.RecID
            iscontext: true
          right:
            value:
              simple: Cherwell.BusinessObjects.RecordId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "26":
    id: "26"
    taskid: 5927dd73-149f-4e33-8b18-d114043b1b2b
    type: condition
    task:
      id: 5927dd73-149f-4e33-8b18-d114043b1b2b
      version: -1
      name: Validate Query Business Object
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              complex:
                root: FetchedIncidents
                accessor: RecordId
                transformers:
                - operator: atIndex
                  args:
                    index:
                      value:
                        simple: "0"
            iscontext: true
          right:
            value:
              simple: Cherwell.BusinessObjects.RecordId
            iscontext: true
    view: |-
      {
        "position": {
          "x": 910,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3505,
        "width": 1670,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
