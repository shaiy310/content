id: Google-KMS-test
version: -1
name: Google-KMS-test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 6b37caf1-7f7a-4a96-88bf-64ac48c48b1b
    type: start
    task:
      id: 6b37caf1-7f7a-4a96-88bf-64ac48c48b1b
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 1ecdbcd9-ac17-4049-890b-c00bbd37705e
    type: regular
    task:
      id: 1ecdbcd9-ac17-4049-890b-c00bbd37705e
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "35"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 200
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: 5f7e120e-35ad-4595-8fc9-fcd3b8631acd
    type: condition
    task:
      id: 5f7e120e-35ad-4595-8fc9-fcd3b8631acd
      version: -1
      name: Check CryptoKey
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "8"
      - "36"
      - "40"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: containsGeneral
          left:
            value:
              simple: GoogleKMS.CryptoKey.Name
            iscontext: true
          right:
            value:
              simple: TestCryptoKey
    view: |-
      {
        "position": {
          "x": 450,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: a8965242-8e81-489d-8a56-a00468b4fb4d
    type: regular
    task:
      id: a8965242-8e81-489d-8a56-a00468b4fb4d
      version: -1
      name: google-kms-destroy-key
      description: Destroy the primary CryptoKeyVersion of a given CryptoKey
      script: '|||google-kms-destroy-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      crypto_key_version: {}
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: 991267f3-972e-40f7-831b-f63b6affbad8
    type: regular
    task:
      id: 991267f3-972e-40f7-831b-f63b6affbad8
      version: -1
      name: google-kms-get-key
      description: Returns metadata for a given CryptoKey, as well as its primary
        CryptoKeyVersion.
      script: '|||google-kms-get-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 4c532a9d-2257-4b3d-825b-8a1e1581cf2e
    type: condition
    task:
      id: 4c532a9d-2257-4b3d-825b-8a1e1581cf2e
      version: -1
      name: Check key destruction
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: GoogleKMS
                filters:
                - - operator: containsString
                    left:
                      value:
                        simple: GoogleKMS.CryptoKey.Name
                      iscontext: true
                    right:
                      value:
                        simple: new_name
                accessor: CryptoKey.PrimaryCryptoKeyVersion.State
            iscontext: true
          right:
            value:
              simple: DESTROY_SCHEDULED
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: 8a81cb6a-fd70-4081-8fdb-b275bdbe91c5
    type: regular
    task:
      id: 8a81cb6a-fd70-4081-8fdb-b275bdbe91c5
      version: -1
      name: google-kms-restore-key
      description: Restore the primary CryptoKeyVersion of a given CryptoKey
      script: '|||google-kms-restore-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      crypto_key_version: {}
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1330
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: ca67ee52-1bcf-4e65-8972-0f1cdb39b1f1
    type: regular
    task:
      id: ca67ee52-1bcf-4e65-8972-0f1cdb39b1f1
      version: -1
      name: google-kms-get-key
      description: Returns metadata for a given CryptoKey, as well as its primary
        CryptoKeyVersion.
      script: '|||google-kms-get-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1510
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: ea6f6631-43e3-4a98-869b-619815a1f87e
    type: condition
    task:
      id: ea6f6631-43e3-4a98-869b-619815a1f87e
      version: -1
      name: Check key restoration
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "14"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: GoogleKMS
                filters:
                - - operator: containsString
                    left:
                      value:
                        simple: GoogleKMS.CryptoKey.Name
                      iscontext: true
                    right:
                      value:
                        simple: new_name
                accessor: CryptoKey.PrimaryCryptoKeyVersion.State
            iscontext: true
          right:
            value:
              simple: DISABLED
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1680
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: 963b7bc9-cb4d-414e-8b86-1aa7e409e1d6
    type: regular
    task:
      id: 963b7bc9-cb4d-414e-8b86-1aa7e409e1d6
      version: -1
      name: google-kms-enable-key
      description: Enable the primary CryptoKeyVersion of a given CryptoKey
      script: '|||google-kms-enable-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      crypto_key_version: {}
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 1870
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 10cefc95-83bf-46ad-811d-2f102415c874
    type: regular
    task:
      id: 10cefc95-83bf-46ad-811d-2f102415c874
      version: -1
      name: google-kms-get-key
      description: Returns metadata for a given CryptoKey, as well as its primary
        CryptoKeyVersion.
      script: '|||google-kms-get-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2050
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: c528c217-37b3-412e-84b3-5f3f0b2d0a0a
    type: condition
    task:
      id: c528c217-37b3-412e-84b3-5f3f0b2d0a0a
      version: -1
      name: Check key enabled
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: GoogleKMS
                filters:
                - - operator: containsString
                    left:
                      value:
                        simple: GoogleKMS.CryptoKey.Name
                      iscontext: true
                    right:
                      value:
                        simple: new_name
                accessor: CryptoKey.PrimaryCryptoKeyVersion.State
            iscontext: true
          right:
            value:
              simple: ENABLED
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: 5a88bc94-8e27-4f76-806c-8a1729a55e1b
    type: regular
    task:
      id: 5a88bc94-8e27-4f76-806c-8a1729a55e1b
      version: -1
      name: google-kms-disable-key
      description: Disable the primary CryptoKeyVersion of a given CryptoKey
      script: '|||google-kms-disable-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      crypto_key_version: {}
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: 5dd7454b-f058-453e-8a1a-0aa78a4a9627
    type: regular
    task:
      id: 5dd7454b-f058-453e-8a1a-0aa78a4a9627
      version: -1
      name: google-kms-get-key
      description: Returns metadata for a given CryptoKey, as well as its primary
        CryptoKeyVersion.
      script: '|||google-kms-get-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: 02a7af6c-831f-4375-8314-5ae7094de088
    type: condition
    task:
      id: 02a7af6c-831f-4375-8314-5ae7094de088
      version: -1
      name: Check key disabled
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "20"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              complex:
                root: GoogleKMS
                filters:
                - - operator: containsString
                    left:
                      value:
                        simple: GoogleKMS.CryptoKey.Name
                      iscontext: true
                    right:
                      value:
                        simple: new_name
                accessor: CryptoKey.PrimaryCryptoKeyVersion.State
            iscontext: true
          right:
            value:
              simple: DISABLED
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: 8275ebec-d1c2-4705-8dc7-01bd731f90d3
    type: regular
    task:
      id: 8275ebec-d1c2-4705-8dc7-01bd731f90d3
      version: -1
      name: google-kms-enable-key
      description: Enable the primary CryptoKeyVersion of a given CryptoKey
      script: '|||google-kms-enable-key'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    scriptarguments:
      crypto_key:
        simple: new_name
      crypto_key_id:
        simple: new_name1
      crypto_key_version: {}
      key_ring: {}
      key_ring_id: {}
      location: {}
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2950
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "34":
    id: "34"
    taskid: 569ac20f-fac0-4290-8167-dbf37363904e
    type: title
    task:
      id: 569ac20f-fac0-4290-8167-dbf37363904e
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "35":
    id: "35"
    taskid: fd8a147e-b6aa-4a42-89ad-0ce93fa5af7f
    type: regular
    task:
      id: fd8a147e-b6aa-4a42-89ad-0ce93fa5af7f
      version: -1
      name: google-kms-list-keys
      description: Lists all keys in key ring
      script: '|||google-kms-list-keys'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      key_ring_id: {}
      key_state:
        simple: ENABLED
      location_id: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 450,
          "y": 365
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "36":
    id: "36"
    taskid: 4844d56c-07c3-4bbd-8dd9-ec2d431c022d
    type: regular
    task:
      id: 4844d56c-07c3-4bbd-8dd9-ec2d431c022d
      version: -1
      name: google-kms-asymmetric-encrypt
      description: Encrypt using a asymmetric CryptoKey
      script: '|||google-kms-asymmetric-encrypt'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
    scriptarguments:
      crypto_key:
        simple: asy256-4
      crypto_key_version:
        simple: "1"
      is_base64:
        simple: "false"
      key_ring: {}
      location: {}
      plaintext:
        simple: some text
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 950,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "38":
    id: "38"
    taskid: 253d6331-5c89-473e-88e2-a415866c636c
    type: regular
    task:
      id: 253d6331-5c89-473e-88e2-a415866c636c
      version: -1
      name: google-kms-asymmetric-decrypt
      description: Decrypt using an asymmetric CryptoKey
      script: '|||google-kms-asymmetric-decrypt'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "39"
    scriptarguments:
      ciphertext:
        simple: DF5xqeU9YprPUcJf1xgX/2HMavw1McKfY/U2JE7+xlREshgzPdgm6zDXAM29SXKCYfh1kSQVSQECUTOfhrxbRiub8/3H9WSE9qo+JLAbfa6IhL7C1CLXdpD71HBB2vZrsEDa/P837/YLgOX6sS34XXwRXM78Gg+x/1h4w84So81i8NF+/ODaJdScqr+IK+i2yGIXHJK0TEiuLHLx0//UBfuoMLAdHvN/UwTel5k0igop0eiKDyfWFqm9nxYWyqKkiHx+ElobqksouqXizsVnr/csHNj8HRSiv4p8QWXOTlHLtlKQGmAUSZAKX5vBYlqPxz1iTHQ+/545wPWf7T4VSHCGiig2lB2rCvyQsxtehFtw5nI9oSyaimY8iGja8JMC6V0Lk3IitR2n6ytXXjfDKqKzkeP1jZt4bsLSnfrhRRgkx8ulPfKqc1Uuu3d4Ejy+EN9iT23z1OKxK5FOh5rm5SkVcH0ArBUklcvOaPOasMSa+jXqTc3E8Z8arG09h6A3aAsiuUIrcT7hGbAf6E4OuAzt/Y0ifpDX5v/WXc8Jk1jlJNpX5F3KJ70gSA+7fQS47HtwiHCx/8dL/VfNB+hbYZ2KNbgV+UceffG4J+Ykvzx/x0Wom5E2fJ0Htse9lknnLoIj35AxCvvQwGd5L71XmfTFRFqQ7oWct9HdIeKR9m0=
      crypto_key:
        simple: asy256-4
      crypto_key_version:
        simple: "1"
      is_base64:
        simple: "false"
      key_ring: {}
      location: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 950,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "39":
    id: "39"
    taskid: 37842385-5f0e-4144-8d41-18be7e8593de
    type: condition
    task:
      id: 37842385-5f0e-4144-8d41-18be7e8593de
      version: -1
      name: check asymmetric decryption
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: GoogleKMS.AsymmetricDecrypt.Plaintext
            iscontext: true
          right:
            value:
              simple: some text
    view: |-
      {
        "position": {
          "x": 950,
          "y": 1150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "40":
    id: "40"
    taskid: f0bef849-8951-4b95-8cfc-752a98b00aa5
    type: regular
    task:
      id: f0bef849-8951-4b95-8cfc-752a98b00aa5
      version: -1
      name: google-kms-symmetric-encrypt
      description: Encrypts data, so that it can only be recovered by a call to Decrypt.
      script: Google Key Management Service|||google-kms-symmetric-encrypt
      type: regular
      iscommand: true
      brand: Google Key Management Service
    nexttasks:
      '#none#':
      - "42"
    scriptarguments:
      additional_authenticated_data: {}
      crypto_key:
        simple: TestCryptoKey
      is_base64:
        simple: "false"
      key_ring: {}
      location: {}
      plaintext:
        simple: some text
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -30,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "42":
    id: "42"
    taskid: 0daa2b1e-53bc-4b32-8851-12152388d86f
    type: regular
    task:
      id: 0daa2b1e-53bc-4b32-8851-12152388d86f
      version: -1
      name: google-kms-symmetric-decrypt
      description: Decrypts data that was protected by Encrypt.
      script: '|||google-kms-symmetric-decrypt'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "43"
    scriptarguments:
      additional_authenticated_data: {}
      ciphertext:
        simple: CiQACehADCHxWXJOURaSKEJ+QECCA7lMAjOrizAlp3ub8y0wPxYSNQAZIMlNz+UFV+BD/b644q61xMymuLiGAC8UNojb0Lh2iPnP/pcZEfa2xLYOQt73exrfYHSr
      crypto_key:
        simple: TestCryptoKey
      is_base64:
        simple: "false"
      key_ring: {}
      location: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -30,
          "y": 960
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "43":
    id: "43"
    taskid: da28139b-33cf-4f93-8161-021626264466
    type: condition
    task:
      id: da28139b-33cf-4f93-8161-021626264466
      version: -1
      name: check symmetric decrypt
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "34"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: GoogleKMS.SymmetricDecrypt.Plaintext
            iscontext: true
          right:
            value:
              simple: some text
    view: |-
      {
        "position": {
          "x": -30,
          "y": 1150
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3155,
        "width": 1360,
        "x": -30,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
