id: cf69fa8c-4973-44dd-806b-0281dd8c5ca8
version: -1
name: GCS Test - Object Operations
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 92ee8687-6e2e-4aa9-8dab-211b26217316
    type: start
    task:
      id: 92ee8687-6e2e-4aa9-8dab-211b26217316
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "25"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: 28748e80-66b1-40c5-89f4-4e7f35f9fba7
    type: regular
    task:
      id: 28748e80-66b1-40c5-89f4-4e7f35f9fba7
      version: -1
      name: Create bucket demisto-test-2
      description: Creates a new bucket
      script: Google Cloud Storage|||gcs-create-bucket
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "6"
    scriptarguments:
      bucket_acl: {}
      bucket_name:
        simple: demisto-test-2
      default_object_acl: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: 0d57885f-667a-4bed-8463-0a4c4413065c
    type: regular
    task:
      id: 0d57885f-667a-4bed-8463-0a4c4413065c
      version: -1
      name: List objects in bucket
      description: Retrieves the list of objects in a bucket
      script: Google Cloud Storage|||gcs-list-bucket-objects
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      bucket_name:
        simple: demisto-test-2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1390
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: 4e1e181a-aa8e-4452-844a-31439897720c
    type: regular
    task:
      id: 4e1e181a-aa8e-4452-844a-31439897720c
      version: -1
      name: Upload test.txt (create object)
      description: Uploads a file (object) into a bucket
      script: Google Cloud Storage|||gcs-upload-file
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      bucket_name:
        simple: demisto-test-2
      entry_id:
        simple: ${File.EntryID}
      object_acl: {}
      object_name:
        simple: foo/bar/baz.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1915
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: 391843f1-24de-4e7f-8b09-aca8f2dea98e
    type: regular
    task:
      id: 391843f1-24de-4e7f-8b09-aca8f2dea98e
      version: -1
      name: List objects in bucket
      description: Retrieves the list of objects in a bucket
      script: Google Cloud Storage|||gcs-list-bucket-objects
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "15"
    scriptarguments:
      bucket_name:
        simple: demisto-test-2
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 8cbb8f3f-0846-4ab0-86fa-e0020afb828e
    type: regular
    task:
      id: 8cbb8f3f-0846-4ab0-86fa-e0020afb828e
      version: -1
      name: Delete bucket with force=True
      description: Permanently deletes a bucket
      script: Google Cloud Storage|||gcs-delete-bucket
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      bucket_name:
        simple: demisto-test-2
      force:
        simple: "True"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: ae6ec309-f90b-47c1-8e21-3d26638ff714
    type: regular
    task:
      id: ae6ec309-f90b-47c1-8e21-3d26638ff714
      version: -1
      name: Create test.txt file
      description: |
        Will create a file (using the given data input or entry ID) and upload it to current investigation war room.
      scriptName: FileCreateAndUpload
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      data:
        simple: Think I'll take TWO chickens.
      entryId: {}
      filename:
        simple: test.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1740
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: 6da829fd-4247-4789-809b-4f9ebf87cf8e
    type: title
    task:
      id: 6da829fd-4247-4789-809b-4f9ebf87cf8e
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3955
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "13":
    id: "13"
    taskid: bc6c978a-1bc2-4bd8-8ffd-bebc1c7f8e57
    type: regular
    task:
      id: bc6c978a-1bc2-4bd8-8ffd-bebc1c7f8e57
      version: -1
      name: Clear context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "2"
    scriptarguments:
      all: {}
      index: {}
      key:
        simple: GCS
      keysToKeep: {}
      subplaybook:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1040
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: 2312fa3e-a7d8-4df5-80ba-bf54058be63f
    type: condition
    task:
      id: 2312fa3e-a7d8-4df5-80ba-bf54058be63f
      version: -1
      name: Verify no objects in bucket
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              complex:
                root: GCS
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: GCS.BucketObject.Bucket
                      iscontext: true
                    right:
                      value:
                        simple: demisto-test-2
                accessor: BucketObject.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 1565
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 7f6b6a7a-10c5-4b0b-87b5-7b7f063a028f
    type: condition
    task:
      id: 7f6b6a7a-10c5-4b0b-87b5-7b7f063a028f
      version: -1
      name: Verify object created
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "27"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: GCS.BucketObject.Name
            iscontext: true
          right:
            value:
              simple: foo/bar/baz.txt
      - - operator: isEqualString
          left:
            value:
              simple: GCS.BucketObject.Bucket
            iscontext: true
          right:
            value:
              simple: demisto-test-2
      - - operator: isEqualString
          left:
            value:
              simple: GCS.BucketObject.Size
            iscontext: true
          right:
            value:
              simple: "29"
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2265
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: 78dd590a-b62c-4fd2-819b-ca4a4e3ca3c1
    type: condition
    task:
      id: 78dd590a-b62c-4fd2-819b-ca4a4e3ca3c1
      version: -1
      name: Verify downloaded file name and size
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "28"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: File.Name
            iscontext: true
          right:
            value:
              simple: baz.txt
      - - operator: isEqualString
          left:
            value:
              simple: File.Size
            iscontext: true
          right:
            value:
              simple: "29"
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2935
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: 18a8a322-7e34-4b6a-8f6e-3016d0704e72
    type: condition
    task:
      id: 18a8a322-7e34-4b6a-8f6e-3016d0704e72
      version: -1
      name: Verify bucket was force-deleted
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "12"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotExists
          left:
            value:
              complex:
                root: GCS
                filters:
                - - operator: isEqualString
                    left:
                      value:
                        simple: GCS.Bucket.Name
                      iscontext: true
                    right:
                      value:
                        simple: demisto-test-2
                accessor: Bucket.Name
            iscontext: true
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: 27dc165b-c32d-45d8-8d10-d8cb7043b6b2
    type: regular
    task:
      id: 27dc165b-c32d-45d8-8d10-d8cb7043b6b2
      version: -1
      name: Clear context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      all: {}
      index: {}
      key:
        simple: GCS
      keysToKeep: {}
      subplaybook:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: 67139e39-83c5-4250-8284-3a99b3cbdbf4
    type: regular
    task:
      id: 67139e39-83c5-4250-8284-3a99b3cbdbf4
      version: -1
      name: gcs-list-buckets
      description: Retrieves the list of buckets in the project
      script: Google Cloud Storage|||gcs-list-buckets
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "17"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: 5372ba6d-fb13-44b0-8081-9ebc3d024cd6
    type: regular
    task:
      id: 5372ba6d-fb13-44b0-8081-9ebc3d024cd6
      version: -1
      name: Clear context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "26"
    scriptarguments:
      all: {}
      index: {}
      key:
        simple: GCS
      keysToKeep: {}
      subplaybook:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2585
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: c26ae322-9c0f-40af-8a1b-f5f59865f5dc
    type: regular
    task:
      id: c26ae322-9c0f-40af-8a1b-f5f59865f5dc
      version: -1
      name: List buckets
      description: Retrieves the list of buckets in the project
      script: Google Cloud Storage|||gcs-list-buckets
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "22"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "22":
    id: "22"
    taskid: 13c4349c-0c96-4376-8eba-6d870fe583bf
    type: condition
    task:
      id: 13c4349c-0c96-4376-8eba-6d870fe583bf
      version: -1
      name: Bucket demisto-test-2 exists?
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "24"
      "yes":
      - "23"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: GCS.Bucket.Name
            iscontext: true
          right:
            value:
              simple: demisto-test-2
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "23":
    id: "23"
    taskid: 11a12c52-1e6f-4dc9-88ac-85175995494a
    type: regular
    task:
      id: 11a12c52-1e6f-4dc9-88ac-85175995494a
      version: -1
      name: Delete bucket
      description: Permanently deletes a bucket
      script: Google Cloud Storage|||gcs-delete-bucket
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "24"
    scriptarguments:
      bucket_name:
        simple: demisto-test-2
      force:
        simple: "True"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "24":
    id: "24"
    taskid: 3bf20a6d-dfea-41a9-856e-bd78b17c9abc
    type: title
    task:
      id: 3bf20a6d-dfea-41a9-856e-bd78b17c9abc
      version: -1
      name: 'Test: List Objects + Upload File'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "13"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "25":
    id: "25"
    taskid: a4df8703-1422-4abf-8bb3-cf2e3e9d2cd5
    type: regular
    task:
      id: a4df8703-1422-4abf-8bb3-cf2e3e9d2cd5
      version: -1
      name: Clear context
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key:
        simple: GCS
      keysToKeep: {}
      subplaybook:
        simple: "yes"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "26":
    id: "26"
    taskid: d52fb8d1-35e0-460a-8d48-17bfcc20ab9e
    type: regular
    task:
      id: d52fb8d1-35e0-460a-8d48-17bfcc20ab9e
      version: -1
      name: Download the object
      description: Retrieves object data into a file
      script: Google Cloud Storage|||gcs-download-file
      type: regular
      iscommand: true
      brand: Google Cloud Storage
    nexttasks:
      '#none#':
      - "16"
    scriptarguments:
      bucket_name:
        simple: demisto-test-2
      object_name:
        simple: foo/bar/baz.txt
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2760
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "27":
    id: "27"
    taskid: c6cf7d0d-e273-4138-84f9-f4ed0c97674f
    type: title
    task:
      id: c6cf7d0d-e273-4138-84f9-f4ed0c97674f
      version: -1
      name: 'Test: Download File'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "20"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 2440
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "28":
    id: "28"
    taskid: c285141e-45b1-4891-8d24-94494bfcd6f8
    type: title
    task:
      id: c285141e-45b1-4891-8d24-94494bfcd6f8
      version: -1
      name: 'Test: Force-delete Bucket'
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 162.5,
          "y": 3110
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3970,
        "width": 492.5,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
