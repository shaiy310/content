id: AutoFocus V2 test
version: 30
name: AutoFocus V2 test
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 0b9d4bca-ce9a-467b-862d-10d863db328a
    type: start
    task:
      id: 0b9d4bca-ce9a-467b-862d-10d863db328a
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "9"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 50
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "1":
    id: "1"
    taskid: 8a97f717-d03d-49d8-84dd-bbf23bdc7bf4
    type: regular
    task:
      id: 8a97f717-d03d-49d8-84dd-bbf23bdc7bf4
      version: -1
      name: autofocus-search-samples
      description: 'Search for samples. To view results run autofocus-samples-search-results
        with the returned Af Cookie. Note: The AF Cookie expires 120 seconds after
        the search completes.'
      script: AutoFocus V2|||autofocus-search-samples
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      advanced_query:
        simple: '`{"operator":"all","children":[{"field":"sample.malware","operator":"is","value":1}]}`'
      max_results: {}
      order: {}
      query:
        simple: '{"operator": "all","children": [{"field": "sample.malware","operator":
          "is","value": "1"}]}'
      scope:
        simple: Global
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "2":
    id: "2"
    taskid: c2d56b29-abbf-4954-84d2-575b1c34ecc1
    type: regular
    task:
      id: c2d56b29-abbf-4954-84d2-575b1c34ecc1
      version: -1
      name: autofocus-search-sessions
      description: 'Search for sessions. To view results run autofocus-sessions-search-results
        with the returned Af Cookie. Note: The AF Cookie expires 120 seconds after
        the search completes.'
      script: AutoFocus V2|||autofocus-search-sessions
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "4"
    scriptarguments:
      advanced_query:
        simple: '{"operator":"all","children":[{"field":"sample.malware","operator":"is","value":1}]},"scope":"public","size":50,"from":0,"sort":{"create_date":{"order":"desc"}}'
      max_results: {}
      order: {}
      query:
        simple: '{"operator": "all","children": [{"field": "sample.malware","operator":
          "is","value": "1"}]}'
      sort: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "3":
    id: "3"
    taskid: c9add397-5cbf-4577-817a-c5948f72c696
    type: condition
    task:
      id: c9add397-5cbf-4577-817a-c5948f72c696
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "5"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "4":
    id: "4"
    taskid: 1b0c48d5-f838-4d35-85bb-8c44319ce7dc
    type: condition
    task:
      id: 1b0c48d5-f838-4d35-85bb-8c44319ce7dc
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "6"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 545
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "5":
    id: "5"
    taskid: 5de77838-d03e-456f-8ba7-597cff11dd5c
    type: regular
    task:
      id: 5de77838-d03e-456f-8ba7-597cff11dd5c
      version: -1
      name: autofocus-samples-search-results
      description: Get results of a previous samples search
      script: '|||autofocus-samples-search-results'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "7"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SamplesSearch.AFCookie}
      intermediate_results: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "6":
    id: "6"
    taskid: a5ecdf50-d5ce-48fe-85ca-96f14fd9fb77
    type: regular
    task:
      id: a5ecdf50-d5ce-48fe-85ca-96f14fd9fb77
      version: -1
      name: autofocus-sessions-search-results
      description: Get results of a previous sessions search
      script: '|||autofocus-sessions-search-results'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "8"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.SessionsSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "7":
    id: "7"
    taskid: a2b9b792-1a65-4687-8343-2d5083ce49f3
    type: condition
    task:
      id: a2b9b792-1a65-4687-8343-2d5083ce49f3
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "10"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Size
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA1
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Created
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Finished
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SamplesResults.Region
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "8":
    id: "8"
    taskid: 0eedba61-d0f1-4c59-8905-e2d12a42166b
    type: condition
    task:
      id: 0eedba61-d0f1-4c59-8905-e2d12a42166b
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "11"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SessionsResults.Seen
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 895
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "9":
    id: "9"
    taskid: 5e12b2d4-edb3-4a8f-8a7b-e5294ccf9648
    type: regular
    task:
      id: 5e12b2d4-edb3-4a8f-8a7b-e5294ccf9648
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "1"
      - "2"
    scriptarguments:
      all:
        simple: "yes"
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "10":
    id: "10"
    taskid: 80757f4b-66e0-4a37-891a-f2d9644e28a8
    type: regular
    task:
      id: 80757f4b-66e0-4a37-891a-f2d9644e28a8
      version: -1
      name: autofocus-sample-analysis
      description: |-
        Get properties, behaviors, and activities observed for a sample.
        Run the command once to get the fields and os's under HTTP,Coverage,Behavior,Registry,Files,Processes,Connections,DNS.
      script: AutoFocus V2|||autofocus-sample-analysis
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "12"
    scriptarguments:
      filter_data: {}
      os: {}
      sample_id:
        complex:
          root: AutoFocus
          accessor: SamplesResults.SHA256
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "11":
    id: "11"
    taskid: 5454453c-c003-4ec3-8483-05758595b720
    type: regular
    task:
      id: 5454453c-c003-4ec3-8483-05758595b720
      version: -1
      name: autofocus-get-session-details
      description: Get session details by session ID
      script: AutoFocus V2|||autofocus-get-session-details
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "14"
    scriptarguments:
      session_id:
        complex:
          root: AutoFocus
          accessor: SessionsResults.ID
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1070
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "12":
    id: "12"
    taskid: cac99a12-e34b-4a5f-8e49-6753560d42e1
    type: condition
    task:
      id: cac99a12-e34b-4a5f-8e49-6753560d42e1
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Coverage
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Behavior
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Registry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Files
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Processes
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.SampleAnalysis.Analysis.Mutex
            iscontext: true
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "14":
    id: "14"
    taskid: e7b140e2-9984-419a-8381-dc7a35f0da01
    type: condition
    task:
      id: e7b140e2-9984-419a-8381-dc7a35f0da01
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "15"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.FileName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.ID
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Industry
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Region
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.SHA256
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.Seen
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Sessions.UploadSource
            iscontext: true
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1245
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "15":
    id: "15"
    taskid: 1cd91e6d-6310-402d-8843-52ea348edcc2
    type: regular
    task:
      id: 1cd91e6d-6310-402d-8843-52ea348edcc2
      version: -1
      name: autofocus-top-tags-search
      description: Perform a search to Identify the most popular tags
      script: AutoFocus V2|||autofocus-top-tags-search
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "18"
    scriptarguments:
      class:
        simple: Malicious Behavior
      commodity: {}
      private:
        simple: "True"
      public:
        simple: "True"
      scope:
        simple: all
      unit42: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "16":
    id: "16"
    taskid: 137a147b-ac78-4572-8724-df661d64acf2
    type: regular
    task:
      id: 137a147b-ac78-4572-8724-df661d64acf2
      version: -1
      name: autofocus-top-tags-results
      description: Get the results of a previous top tags search
      script: AutoFocus V2|||autofocus-top-tags-results
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "19"
    scriptarguments:
      af_cookie:
        simple: ${AutoFocus.TopTagsSearch.AFCookie}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1770
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "17":
    id: "17"
    taskid: 2c548195-3ca9-4ba7-8be1-4ac41fd48e17
    type: regular
    task:
      id: 2c548195-3ca9-4ba7-8be1-4ac41fd48e17
      version: -1
      name: autofocus-tag-details
      description: Get details on a given tag
      script: AutoFocus V2|||autofocus-tag-details
      type: regular
      iscommand: true
      brand: AutoFocus V2
    nexttasks:
      '#none#':
      - "20"
    scriptarguments:
      tag_name:
        complex:
          root: AutoFocus
          accessor: TopTagsResults.PublicTagName
          transformers:
          - operator: atIndex
            args:
              index:
                value:
                  simple: "0"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2120
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "18":
    id: "18"
    taskid: 328eae9a-488d-42ef-8545-92784d13e434
    type: condition
    task:
      id: 328eae9a-488d-42ef-8545-92784d13e434
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "16"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsSearch.AFCookie
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsSearch.Status
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1595
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "19":
    id: "19"
    taskid: 670b23d8-87b0-4dc5-80c8-c6b7b4cc2f66
    type: condition
    task:
      id: 670b23d8-87b0-4dc5-80c8-c6b7b4cc2f66
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "17"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.Count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.PublicTagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.TagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.TopTagsResults.Lasthit
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1945
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "20":
    id: "20"
    taskid: 0d02e939-be52-422c-8864-e08041c9ad86
    type: condition
    task:
      id: 0d02e939-be52-422c-8864-e08041c9ad86
      version: -1
      name: Verify context
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      "yes":
      - "21"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.PublicTagName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Count
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Lasthit
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagDefinitionScope
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.CustomerName
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.Source
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagClass
            iscontext: true
      - - operator: isExists
          left:
            value:
              simple: AutoFocus.Tag.TagDefinitionStatus
            iscontext: true
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2295
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
  "21":
    id: "21"
    taskid: 6919da7d-d0c7-4c85-8fcc-1940f78e4a50
    type: title
    task:
      id: 6919da7d-d0c7-4c85-8fcc-1940f78e4a50
      version: -1
      name: DONE
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 2470
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 2485,
        "width": 810,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
