id: SymantecEndpointProtection_Test
version: -1
name: SymantecEndpointProtection_Test
description: This playbook tests the SEPM integration commands.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: 40653ad5-4123-41ba-85b7-86c77f519d9f
    type: start
    task:
      id: 40653ad5-4123-41ba-85b7-86c77f519d9f
      version: -1
      name: ""
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 50
        }
      }
    note: false
    timertriggers: []
  "3":
    id: "3"
    taskid: 9ede71a3-756d-4edf-8711-e2aecd9621ca
    type: regular
    task:
      id: 9ede71a3-756d-4edf-8711-e2aecd9621ca
      version: -1
      name: sep-system-info
      description: Get the system information (version, AV definition).
      script: '|||sep-system-info'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "22"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 515
        }
      }
    note: false
    timertriggers: []
  "8":
    id: "8"
    taskid: 363bffbb-5be8-45d7-8aeb-ee21422341b8
    type: regular
    task:
      id: 363bffbb-5be8-45d7-8aeb-ee21422341b8
      version: -1
      name: sep-client-content
      description: Retrieves the client content.
      script: '|||sep-client-content'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "23"
      - "24"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 695,
          "y": 515
        }
      }
    note: false
    timertriggers: []
  "10":
    id: "10"
    taskid: 3e1f6d4c-387d-4e64-894a-d40a00e16f7f
    type: regular
    task:
      id: 3e1f6d4c-387d-4e64-894a-d40a00e16f7f
      version: -1
      name: sep-groups-info
      description: Get information about groups.
      script: '|||sep-groups-info'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "25"
      - "26"
    scriptarguments:
      columns: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 265,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
  "21":
    id: "21"
    taskid: a8bed0c8-8cb6-438a-8a39-3381d459cf54
    type: regular
    task:
      id: a8bed0c8-8cb6-438a-8a39-3381d459cf54
      version: -1
      name: DeleteContext
      description: Delete field from context
      scriptName: DeleteContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "32"
    scriptarguments:
      all:
        simple: "yes"
      key: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 195
        }
      }
    note: false
    timertriggers: []
  "22":
    id: "22"
    taskid: cc90e0ad-76be-4a4f-8095-e190f70cd738
    type: regular
    task:
      id: cc90e0ad-76be-4a4f-8095-e190f70cd738
      version: -1
      name: VerifyContext (SEPM.ServerAVDefVersion)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: SEPM.ServerAVDefVersion
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 690
        }
      }
    note: false
    timertriggers: []
  "23":
    id: "23"
    taskid: 0d187434-b261-48b5-88ef-2319f853ea07
    type: regular
    task:
      id: 0d187434-b261-48b5-88ef-2319f853ea07
      version: -1
      name: VerifyContext (SEPM.LastUpdated)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: SEPM.LastUpdated
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 690
        }
      }
    note: false
    timertriggers: []
  "24":
    id: "24"
    taskid: 55f1d781-fe0f-44ac-8857-e349d426c6a1
    type: regular
    task:
      id: 55f1d781-fe0f-44ac-8857-e349d426c6a1
      version: -1
      name: VerifyContext (SEPM.ClientContentVersions)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "31"
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: SEPM.ClientContentVersions
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 690
        }
      }
    note: false
    timertriggers: []
  "25":
    id: "25"
    taskid: 29bb557f-6fdf-405b-8ebb-b4e1e167ee2e
    type: regular
    task:
      id: 29bb557f-6fdf-405b-8ebb-b4e1e167ee2e
      version: -1
      name: VerifyContext (SEPM.Groups.fullPathName)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      expectedValue:
        simple: My Company\Default Group
      fields: {}
      path:
        simple: SEPM.Groups.[0].fullPathName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 1185
        }
      }
    note: false
    timertriggers: []
  "26":
    id: "26"
    taskid: 96e8c3f8-c9d0-413d-8ded-a3dd4bfd9857
    type: regular
    task:
      id: 96e8c3f8-c9d0-413d-8ded-a3dd4bfd9857
      version: -1
      name: VerifyContext (SEPM.Groups.fullPathName)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      expectedValue:
        simple: My Company
      fields: {}
      path:
        simple: SEPM.Groups.[1].fullPathName
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1185
        }
      }
    note: false
    timertriggers: []
  "27":
    id: "27"
    taskid: 2838a020-2276-43a8-8224-cbed7499477f
    type: regular
    task:
      id: 2838a020-2276-43a8-8224-cbed7499477f
      version: -1
      name: sep-endpoints-info
      description: Get information about groups.
      script: '|||sep-endpoints-info'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "30"
    scriptarguments:
      columns: {}
      computerName: {}
      computerNamed: {}
      lastUpdate: {}
      os: {}
      pageSize: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1010
        }
      }
    note: false
    timertriggers: []
  "30":
    id: "30"
    taskid: df7d6550-af3e-4030-83a8-b6c199f1432d
    type: regular
    task:
      id: df7d6550-af3e-4030-83a8-b6c199f1432d
      version: -1
      name: VerifyContext (SEPM.Endpoint.IPAddresses)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "33"
    scriptarguments:
      expectedValue:
        simple: 192.168.1.125
      fields: {}
      path:
        simple: SEPM.Endpoint.IPAddresses.[0]
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 1185
        }
      }
    note: false
    timertriggers: []
  "31":
    id: "31"
    taskid: 56f88dbb-8655-4c9e-8fbd-5eaee9f8d96b
    type: title
    task:
      id: 56f88dbb-8655-4c9e-8fbd-5eaee9f8d96b
      version: -1
      name: Endpoint and Group Info
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "27"
      - "10"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 865
        }
      }
    note: false
    timertriggers: []
  "32":
    id: "32"
    taskid: 097cdb83-32b7-4493-86be-2dea74dd55eb
    type: title
    task:
      id: 097cdb83-32b7-4493-86be-2dea74dd55eb
      version: -1
      name: General Information
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "8"
      - "3"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 370
        }
      }
    note: false
    timertriggers: []
  "33":
    id: "33"
    taskid: c508bdbf-967f-469f-8130-7503afe888e7
    type: title
    task:
      id: c508bdbf-967f-469f-8130-7503afe888e7
      version: -1
      name: Update Content & Quarantine
      type: title
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "34"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1360
        }
      }
    note: false
    timertriggers: []
  "34":
    id: "34"
    taskid: a6c1a83c-c848-488f-899a-b229a97b3191
    type: regular
    task:
      id: a6c1a83c-c848-488f-899a-b229a97b3191
      version: -1
      name: sep-update-endpoint-content (by IP)
      description: Updates the content of the given client.
      script: '|||sep-update-endpoint-content'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "36"
      - "42"
    scriptarguments:
      endpoint:
        simple: ${SEPM.Endpoint.IPAddresses.[0]}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1505
        }
      }
    note: false
    timertriggers: []
  "36":
    id: "36"
    taskid: b4b95b89-3503-421a-80f3-8b7df5f48e07
    type: regular
    task:
      id: b4b95b89-3503-421a-80f3-8b7df5f48e07
      version: -1
      name: VerifyContext (SEPM.Update.Endpoint)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      expectedValue:
        simple: ${SEPM.Endpoint.IPAddresses.[0]}
      fields: {}
      path:
        simple: SEPM.Update.Endpoint
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 190,
          "y": 1680
        }
      }
    note: false
    timertriggers: []
  "37":
    id: "37"
    taskid: 387d5ca4-3843-4364-8542-7ac005a00cfb
    type: regular
    task:
      id: 387d5ca4-3843-4364-8542-7ac005a00cfb
      version: -1
      name: sep-endpoint-quarantine (by hostname)
      description: Updates the content of the given client.
      script: '|||sep-endpoint-quarantine'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "38"
      - "43"
      - "44"
    scriptarguments:
      actionType:
        simple: Add
      endpoint:
        simple: ${SEPM.Endpoint.Hostname}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 1855
        }
      }
    note: false
    timertriggers: []
  "38":
    id: "38"
    taskid: 5ba4ff0c-a393-42fc-82f9-5ce0ff1e2a4d
    type: regular
    task:
      id: 5ba4ff0c-a393-42fc-82f9-5ce0ff1e2a4d
      version: -1
      name: VerifyContext (SEPM.Quarantine.Endpoint)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      expectedValue:
        simple: ${SEPM.Endpoint.Hostname}
      fields: {}
      path:
        simple: SEPM.Quarantine.Endpoint
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 50,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
  "42":
    id: "42"
    taskid: 8658ec79-137e-43f4-8610-3de25c9d279b
    type: regular
    task:
      id: 8658ec79-137e-43f4-8610-3de25c9d279b
      version: -1
      name: VerifyContext (SEPM.Update.Endpoint)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "37"
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: SEPM.Update.CommandID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": 1680
        }
      }
    note: false
    timertriggers: []
  "43":
    id: "43"
    taskid: f4dd1f6a-56f6-47af-8d3a-bafde43d4108
    type: regular
    task:
      id: f4dd1f6a-56f6-47af-8d3a-bafde43d4108
      version: -1
      name: VerifyContext (SEPM.Quarantine.CommandID)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: SEPM.Quarantine.CommandID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
  "44":
    id: "44"
    taskid: 5b827f29-81e9-42f3-8cf1-037c2fd53340
    type: regular
    task:
      id: 5b827f29-81e9-42f3-8cf1-037c2fd53340
      version: -1
      name: VerifyContext (SEPM.Quarantine.Action)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "45"
    scriptarguments:
      expectedValue:
        simple: Add
      fields: {}
      path:
        simple: SEPM.Quarantine.Action
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 910,
          "y": 2040
        }
      }
    note: false
    timertriggers: []
  "45":
    id: "45"
    taskid: b63af982-aa66-4fd2-8e94-4da7f03c254b
    type: regular
    task:
      id: b63af982-aa66-4fd2-8e94-4da7f03c254b
      version: -1
      name: sep-endpoint-quarantine (remove by ip)
      description: Updates the content of the given client.
      script: '|||sep-endpoint-quarantine'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "47"
      - "46"
      - "48"
    scriptarguments:
      actionType:
        simple: Remove
      endpoint:
        simple: ${SEPM.Endpoint.IPAddresses.[0]}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2225
        }
      }
    note: false
    timertriggers: []
  "46":
    id: "46"
    taskid: 05272c4f-62bb-418f-8426-76c8c2782d90
    type: regular
    task:
      id: 05272c4f-62bb-418f-8426-76c8c2782d90
      version: -1
      name: VerifyContext (SEPM.Quarantine.Endpoint)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      expectedValue:
        simple: ${SEPM.Endpoint.IPAddresses.[0]}
      fields: {}
      path:
        simple: SEPM.Quarantine.[1].Endpoint
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
  "47":
    id: "47"
    taskid: 6489044e-2452-421c-816e-39e2f2b2cebc
    type: regular
    task:
      id: 6489044e-2452-421c-816e-39e2f2b2cebc
      version: -1
      name: VerifyContext (SEPM.Quarantine.CommandID)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: SEPM.Quarantine.[1].CommandID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
  "48":
    id: "48"
    taskid: 644eef20-8495-4381-8369-d89904108a28
    type: regular
    task:
      id: 644eef20-8495-4381-8369-d89904108a28
      version: -1
      name: VerifyContext (SEPM.Quarantine.Action)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "49"
    scriptarguments:
      expectedValue:
        simple: Remove
      fields: {}
      path:
        simple: SEPM.Quarantine.[1].Action
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2450
        }
      }
    note: false
    timertriggers: []
  "49":
    id: "49"
    taskid: 80358bac-ea11-480b-8494-1561a09d5c76
    type: regular
    task:
      id: 80358bac-ea11-480b-8494-1561a09d5c76
      version: -1
      name: sep-scan-endpoint (by hostname)
      script: '|||sep-scan-endpoint'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "50"
      - "52"
      - "51"
    scriptarguments:
      endpoint:
        simple: ${SEPM.Endpoint.Hostname}
      scanType:
        simple: ScanNow_Quick
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2630
        }
      }
    note: false
    timertriggers: []
  "50":
    id: "50"
    taskid: 3a8f09f3-f03a-4237-8b4f-6908d14ce25e
    type: regular
    task:
      id: 3a8f09f3-f03a-4237-8b4f-6908d14ce25e
      version: -1
      name: VerifyContext (SEPM.Scan.CommandID)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "53"
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: SEPM.Scan.CommandID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2810
        }
      }
    note: false
    timertriggers: []
  "51":
    id: "51"
    taskid: f4b72c83-e23d-4195-872d-dcfab64d9900
    type: regular
    task:
      id: f4b72c83-e23d-4195-872d-dcfab64d9900
      version: -1
      name: VerifyContext (SEPM.Scan.Endpoint)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      expectedValue:
        simple: ${SEPM.Endpoint.Hostname}
      fields: {}
      path:
        simple: SEPM.Scan.Endpoint
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 60,
          "y": 2810
        }
      }
    note: false
    timertriggers: []
  "52":
    id: "52"
    taskid: 28b1a20c-f647-4000-8bf3-c0a9dd74dc12
    type: regular
    task:
      id: 28b1a20c-f647-4000-8bf3-c0a9dd74dc12
      version: -1
      name: VerifyContext (SEPM.Quarantine.Action)
      description: |-
        Verifies path in context:
        - Verifies path existence
        - If matching object is an array: verify fields exists in each of the objects in the array
        - If matching object is not an array: verify fields exists in matching object
        - if 'expectedValue' is given: ensure that the given value is equal to the context path
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      expectedValue:
        simple: ScanNow_Quick
      fields: {}
      path:
        simple: SEPM.Scan.Type
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 2810
        }
      }
    note: false
    timertriggers: []
  "53":
    id: "53"
    taskid: 5f405328-944b-4ff4-8584-36b51564e2de
    type: regular
    task:
      id: 5f405328-944b-4ff4-8584-36b51564e2de
      version: -1
      name: sep-list-locations
      script: '|||sep-list-locations'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "54"
    scriptarguments:
      groupID:
        simple: ${SEPM.Groups.[0].id}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 2980
        }
      }
    note: false
    timertriggers: []
  "54":
    id: "54"
    taskid: 23382797-8538-41a1-834a-de0f3bdbb852
    type: regular
    task:
      id: 23382797-8538-41a1-834a-de0f3bdbb852
      version: -1
      name: VerifyContext (SEPM.Locations.[0].ID)
      scriptName: VerifyContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "55"
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: SEPM.Locations.[0].ID
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3140
        }
      }
    note: false
    timertriggers: []
  "55":
    id: "55"
    taskid: 340456ed-5ee7-4b16-8e6d-200347270031
    type: regular
    task:
      id: 340456ed-5ee7-4b16-8e6d-200347270031
      version: -1
      name: sep-list-policies
      script: '|||sep-list-policies'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "56"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3310
        }
      }
    note: false
    timertriggers: []
  "56":
    id: "56"
    taskid: b389e449-2161-45bb-8741-ddbff6382825
    type: condition
    task:
      id: b389e449-2161-45bb-8741-ddbff6382825
      version: -1
      name: Check policies
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "58"
      "yes":
      - "59"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: hasLength
          left:
            value:
              complex:
                root: SEPM
                accessor: PoliciesList
            iscontext: true
          right:
            value:
              simple: "20"
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3460
        }
      }
    note: false
    timertriggers: []
  "58":
    id: "58"
    taskid: 91a6ee7a-8070-46ab-8c57-e263e5256e51
    type: regular
    task:
      id: 91a6ee7a-8070-46ab-8c57-e263e5256e51
      version: -1
      name: Policies Fail
      scriptName: PrintErrorEntry
      type: regular
      iscommand: false
      brand: ""
    scriptarguments:
      message:
        simple: Expected `SEPM.PoliciesList.AssignedLocations` to have length of 20
          but got ${SEPM.PoliciesList.AssignedLocations}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 705,
          "y": 3650
        }
      }
    note: false
    timertriggers: []
  "59":
    id: "59"
    taskid: 42398ad6-8bdc-4528-89d0-8496709468db
    type: title
    task:
      id: 42398ad6-8bdc-4528-89d0-8496709468db
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 480,
          "y": 3860
        }
      }
    note: false
    timertriggers: []
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3875,
        "width": 1250,
        "x": 50,
        "y": 50
      }
    }
  }
inputs: []
outputs: []
tests:
  - No test - test playbook