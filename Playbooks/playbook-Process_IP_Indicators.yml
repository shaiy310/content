elasticcommonfields: {}
id: Process IP Indicators
version: -1
fromversion: 5.5.0
name: Process IP Indicators
description: This playbook processes indicators by running enrichment, manually reviewing the indicator,
  and tagging indicators accordingly based on user preferences or enrichment results.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: "1"
    type: start
    task:
      elasticcommonfields: {}
      id: "1"
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 510,
          "y": -1530
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: 7701955f-2902-40e4-81db-0249b7febfcd
    type: title
    task:
      elasticcommonfields: {}
      id: 7701955f-2902-40e4-81db-0249b7febfcd
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 510,
          "y": 1930
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: 06e6a9ea-ae4a-4918-8fde-912a9e83e83d
    type: condition
    task:
      elasticcommonfields: {}
      id: 06e6a9ea-ae4a-4918-8fde-912a9e83e83d
      version: -1
      name: Are there results?
      description: Checks whether the specified item is in a list. The default list
        is the Demisto Indicators Whitelist.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "73"
      - "76"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: playbookQuery.value
            iscontext: true
    view: |-
      {
        "position": {
          "x": 510,
          "y": -1320
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "21":
    id: "21"
    taskid: 9a396da8-ea0c-453f-83bd-aad485f2d6eb
    type: regular
    task:
      elasticcommonfields: {}
      id: 9a396da8-ea0c-453f-83bd-aad485f2d6eb
      version: -1
      name: Gather more data on results
      description: Check IP reputation
      script: '|||ip'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "77"
      - "78"
      - "79"
      - "80"
    scriptarguments:
      fullResponse: {}
      ip:
        simple: ${playbookQuery.value}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "44":
    id: "44"
    taskid: 2264f5d4-2273-429d-8d06-bc0bd9dc1f07
    type: regular
    task:
      elasticcommonfields: {}
      id: 2264f5d4-2273-429d-8d06-bc0bd9dc1f07
      version: -1
      name: Add bad tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          - - operator: in
              left:
                value:
                  simple: DBotScore.Indicator
                iscontext: true
              right:
                value:
                  simple: playbookQuery.value
                iscontext: true
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2590,
          "y": 1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "45":
    id: "45"
    taskid: 7e5f286d-acf9-4e3a-8acd-1aefc3c2c5a2
    type: condition
    task:
      elasticcommonfields: {}
      id: 7e5f286d-acf9-4e3a-8acd-1aefc3c2c5a2
      version: -1
      name: Are there indicators  with high risk score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 2370,
          "y": 550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "46":
    id: "46"
    taskid: 749367a5-6ea2-4423-8442-72d0d68fb723
    type: condition
    task:
      elasticcommonfields: {}
      id: 749367a5-6ea2-4423-8442-72d0d68fb723
      version: -1
      name: Are there indicators with good Dbot score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": -1310,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "47":
    id: "47"
    taskid: f676313f-45c0-495f-82b4-55872f5a7a4e
    type: regular
    task:
      elasticcommonfields: {}
      id: f676313f-45c0-495f-82b4-55872f5a7a4e
      version: -1
      name: Add good tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_good
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "48":
    id: "48"
    taskid: f20b62b7-f690-4122-824b-06d456c4efb3
    type: condition
    task:
      elasticcommonfields: {}
      id: f20b62b7-f690-4122-824b-06d456c4efb3
      version: -1
      name: Are there indicators with unknown risk score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 880,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "49":
    id: "49"
    taskid: fef6b4f9-89f2-4596-8576-137e84f9585b
    type: regular
    task:
      elasticcommonfields: {}
      id: fef6b4f9-89f2-4596-8576-137e84f9585b
      version: -1
      name: Add unknown tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          - - operator: in
              left:
                value:
                  simple: DBotScore.Indicator
                iscontext: true
              right:
                value:
                  simple: playbookQuery.value
                iscontext: true
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "50":
    id: "50"
    taskid: 3a67ff9b-fc8f-4f13-8a26-8eff11f96c69
    type: condition
    task:
      elasticcommonfields: {}
      id: 3a67ff9b-fc8f-4f13-8a26-8eff11f96c69
      version: -1
      name: Are there indicators with suspicious Dbot score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "66"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "2"
    view: |-
      {
        "position": {
          "x": 160,
          "y": 570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "51":
    id: "51"
    taskid: 00e445cf-fcbb-4566-84f5-a16ee7750bee
    type: regular
    task:
      elasticcommonfields: {}
      id: 00e445cf-fcbb-4566-84f5-a16ee7750bee
      version: -1
      name: Add suspicious tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -130,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "52":
    id: "52"
    taskid: 2913db3a-a5a0-4372-8ca0-a0410548868a
    type: condition
    task:
      elasticcommonfields: {}
      id: 2913db3a-a5a0-4372-8ca0-a0410548868a
      version: -1
      name: Do values appear in business partners IP list?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: List.In
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: List.ListName
            iscontext: true
          right:
            value:
              simple: inputs.BusinessPartnersIPListName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 750,
          "y": -340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "53":
    id: "53"
    taskid: ccd7d7a5-83a0-433e-88c0-b1bf3b6b4e6c
    type: regular
    task:
      elasticcommonfields: {}
      id: ccd7d7a5-83a0-433e-88c0-b1bf3b6b4e6c
      version: -1
      name: Add business partner tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: business_partner
      indicatorsValues:
        complex:
          root: List
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: List.ListName
                iscontext: true
              right:
                value:
                  simple: inputs.BusinessPartnersDomainsListName
                iscontext: true
          accessor: In
          transformers:
          - operator: uniq
      value:
        simple: ${List.In}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": 0
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "54":
    id: "54"
    taskid: 1fa26ec5-92a8-4dab-87f2-e1bdb6e5cc56
    type: condition
    task:
      elasticcommonfields: {}
      id: 1fa26ec5-92a8-4dab-87f2-e1bdb6e5cc56
      version: -1
      name: Is there a business partners IP list?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.BusinessPartnersIPListName
            iscontext: true
    view: |-
      {
        "position": {
          "x": 750,
          "y": -840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "55":
    id: "55"
    taskid: 1f7f4022-1fb0-4ce6-890f-c7f00f16d730
    type: regular
    task:
      elasticcommonfields: {}
      id: 1f7f4022-1fb0-4ce6-890f-c7f00f16d730
      version: -1
      name: Run filter by list check on indicators
      description: Checks whether the specified item is in a list. The default list
        is the Demisto Indicators Whitelist.
      scriptName: FilterByList
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      ignorecase:
        simple: "yes"
      listname:
        simple: ${inputs.BusinessPartnersIPListName}
      matchexact:
        simple: "yes"
      values:
        simple: ${playbookQuery.value}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "60":
    id: "60"
    taskid: 5e84c219-b6be-4cd9-8ec7-b8c120fb241e
    type: condition
    task:
      elasticcommonfields: {}
      id: 5e84c219-b6be-4cd9-8ec7-b8c120fb241e
      version: -1
      name: Manual approve indicators to be good
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "81"
      "yes":
      - "47"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1250,
          "y": 1005
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: 7d21f44d-4272-4aa6-8cb4-dcddf49441a5
    type: condition
    task:
      elasticcommonfields: {}
      id: 7d21f44d-4272-4aa6-8cb4-dcddf49441a5
      version: -1
      name: Manual approve indicators to be suspicious
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "84"
      "yes":
      - "51"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 180,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: 5d4962b7-90cc-4841-8179-68f03da6f0b6
    type: condition
    task:
      elasticcommonfields: {}
      id: 5d4962b7-90cc-4841-8179-68f03da6f0b6
      version: -1
      name: Manual approve indicators to be unknown
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "87"
      "yes":
      - "49"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 860,
          "y": 990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "63":
    id: "63"
    taskid: 1a422ee1-05eb-4d19-8f77-abcd5a731e8a
    type: condition
    task:
      elasticcommonfields: {}
      id: 1a422ee1-05eb-4d19-8f77-abcd5a731e8a
      version: -1
      name: Manual approve indicators to be bad
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "92"
      "yes":
      - "44"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2340,
          "y": 970
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: b057b983-9607-4dd0-885b-812cd813d020
    type: condition
    task:
      elasticcommonfields: {}
      id: b057b983-9607-4dd0-885b-812cd813d020
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "63"
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": 2590,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "65":
    id: "65"
    taskid: 0b069d93-18a9-40e3-8120-15c1de414063
    type: condition
    task:
      elasticcommonfields: {}
      id: 0b069d93-18a9-40e3-8120-15c1de414063
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": 1160,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: 594dd4bf-be92-4c45-80cb-cfe9728d0619
    type: condition
    task:
      elasticcommonfields: {}
      id: 594dd4bf-be92-4c45-80cb-cfe9728d0619
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": -130,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "67":
    id: "67"
    taskid: 899630a0-decc-4622-8555-85c87a915437
    type: condition
    task:
      elasticcommonfields: {}
      id: 899630a0-decc-4622-8555-85c87a915437
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "60"
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "69":
    id: "69"
    taskid: 5bd47d1c-15f6-4e88-8831-77d2fab4c5da
    type: regular
    task:
      elasticcommonfields: {}
      id: 5bd47d1c-15f6-4e88-8831-77d2fab4c5da
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_suspicious,processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1180,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "70":
    id: "70"
    taskid: ef2c3d1b-431f-4ff2-87f7-eb198e1e4f4c
    type: regular
    task:
      elasticcommonfields: {}
      id: ef2c3d1b-431f-4ff2-87f7-eb198e1e4f4c
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_good,processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 150,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "71":
    id: "71"
    taskid: 6d53127e-e521-4923-8044-7c28fafbb2d5
    type: regular
    task:
      elasticcommonfields: {}
      id: 6d53127e-e521-4923-8044-7c28fafbb2d5
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_good,processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 880,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "72":
    id: "72"
    taskid: 80576b73-2621-43b6-8e42-5ae7afe499e8
    type: regular
    task:
      elasticcommonfields: {}
      id: 80576b73-2621-43b6-8e42-5ae7afe499e8
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_unknown,processed_good,processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2410,
          "y": 1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "73":
    id: "73"
    taskid: fb277ca9-96f8-4564-842f-00c698824bc0
    type: title
    task:
      elasticcommonfields: {}
      id: fb277ca9-96f8-4564-842f-00c698824bc0
      version: -1
      name: Business partner IP list
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "54"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "76":
    id: "76"
    taskid: 4212c414-7581-406f-8753-54094b2de6fa
    type: title
    task:
      elasticcommonfields: {}
      id: 4212c414-7581-406f-8753-54094b2de6fa
      version: -1
      name: Enrichment
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 65
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "77":
    id: "77"
    taskid: 7c360418-a52a-4738-8c03-709a8f89f997
    type: title
    task:
      elasticcommonfields: {}
      id: 7c360418-a52a-4738-8c03-709a8f89f997
      version: -1
      name: Good indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1310,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "78":
    id: "78"
    taskid: 1c5221d1-79ba-4627-8e6e-4d610f8e7260
    type: title
    task:
      elasticcommonfields: {}
      id: 1c5221d1-79ba-4627-8e6e-4d610f8e7260
      version: -1
      name: Suspicious indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -100,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "79":
    id: "79"
    taskid: 94b98c2e-e78b-46b2-8315-1d2ee37c165b
    type: title
    task:
      elasticcommonfields: {}
      id: 94b98c2e-e78b-46b2-8315-1d2ee37c165b
      version: -1
      name: Unknown indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "48"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "80":
    id: "80"
    taskid: 17d6dff3-a0e5-4b6a-8397-e9042e6e8b4f
    type: title
    task:
      elasticcommonfields: {}
      id: 17d6dff3-a0e5-4b6a-8397-e9042e6e8b4f
      version: -1
      name: Bad indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2370,
          "y": 385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "81":
    id: "81"
    taskid: f43c860b-afb7-421b-8f23-f214fbba3c76
    type: regular
    task:
      elasticcommonfields: {}
      id: f43c860b-afb7-421b-8f23-f214fbba3c76
      version: -1
      name: Manually provide tag for listed indicators
      description: Input in the comments the tag name to be applied for these indicators.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "83"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1020,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "82":
    id: "82"
    taskid: 0551f0e4-a12b-4da9-8430-12a641f8c28e
    type: regular
    task:
      elasticcommonfields: {}
      id: 0551f0e4-a12b-4da9-8430-12a641f8c28e
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${UserDefinedTag1}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1020,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "83":
    id: "83"
    taskid: 15a6cb77-c07c-4fdc-80be-6d6cfba39193
    type: regular
    task:
      elasticcommonfields: {}
      id: 15a6cb77-c07c-4fdc-80be-6d6cfba39193
      version: -1
      name: Set tags to context
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "82"
    scriptarguments:
      contextKey:
        simple: UserDefinedTag1
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1020,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "84":
    id: "84"
    taskid: acf340c3-9410-411b-8129-8ba71ea2e069
    type: regular
    task:
      elasticcommonfields: {}
      id: acf340c3-9410-411b-8129-8ba71ea2e069
      version: -1
      name: Manually provide tag for listed indicators
      description: Input in the comments the tag name to be applied for these indicators.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "85"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "85":
    id: "85"
    taskid: 9229956d-ab86-4a26-8df3-744bb4059da7
    type: regular
    task:
      elasticcommonfields: {}
      id: 9229956d-ab86-4a26-8df3-744bb4059da7
      version: -1
      name: Set tags to context
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "86"
    scriptarguments:
      contextKey:
        simple: UserDefinedTag2
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "86":
    id: "86"
    taskid: 94a26cb8-5b07-495e-83de-935194edfb55
    type: regular
    task:
      elasticcommonfields: {}
      id: 94a26cb8-5b07-495e-83de-935194edfb55
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${UserDefinedTag2}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 300,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "87":
    id: "87"
    taskid: 2c85c1bd-05af-4005-84a4-b6bd5d5700b8
    type: regular
    task:
      elasticcommonfields: {}
      id: 2c85c1bd-05af-4005-84a4-b6bd5d5700b8
      version: -1
      name: Manually provide tag for listed indicators
      description: Input in the comments the tag name to be applied for these indicators.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "88"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1195
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "88":
    id: "88"
    taskid: e4619116-5448-44a0-8cfa-5582ebbbbb70
    type: regular
    task:
      elasticcommonfields: {}
      id: e4619116-5448-44a0-8cfa-5582ebbbbb70
      version: -1
      name: Set tags to context
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      contextKey:
        simple: UserDefinedTag3
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "89":
    id: "89"
    taskid: 039f3c78-4a85-4270-83ce-f855a5ba636e
    type: regular
    task:
      elasticcommonfields: {}
      id: 039f3c78-4a85-4270-83ce-f855a5ba636e
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${UserDefinedTag3}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 730,
          "y": 1570
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "90":
    id: "90"
    taskid: 434a5a08-add1-4211-8b97-4f45ff49f3b7
    type: regular
    task:
      elasticcommonfields: {}
      id: 434a5a08-add1-4211-8b97-4f45ff49f3b7
      version: -1
      name: Set tags to context
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      contextKey:
        simple: UserDefinedTag4
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1385
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "91":
    id: "91"
    taskid: 75fbdcf0-1822-46c9-8c1d-10338b8202c8
    type: regular
    task:
      elasticcommonfields: {}
      id: 75fbdcf0-1822-46c9-8c1d-10338b8202c8
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${UserDefinedTag4}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1580
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "92":
    id: "92"
    taskid: ebc04610-f4a5-436a-884a-92cfa6e8f4cd
    type: regular
    task:
      elasticcommonfields: {}
      id: ebc04610-f4a5-436a-884a-92cfa6e8f4cd
      version: -1
      name: Manually provide tag for listed indicators
      description: Input in the comments the tag name to be applied for these indicators.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2160,
          "y": 1215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3525,
        "width": 4480,
        "x": -1510,
        "y": -1530
      }
    }
  }
inputs:
- key: ""
  value: {}
  required: false
  description: ""
  playbookInputQuery:
    query: ""
    queryEntity: indicators
    results: null
    daterange:
      fromdate: 0001-01-01T00:00:00Z
      todate: 0001-01-01T00:00:00Z
      period:
        by: ""
        byto: ""
        byfrom: ""
        tovalue: null
        fromvalue: null
        field: ""
      fromdatelicenseval: 0001-01-01T00:00:00Z
    runFromLastJobTime: false
- key: BusinessPartnersIPListName
  value: {}
  required: false
  description: A Demisto list containing business partners IP values. IP Indicators
    that appear in the list will be tagged as business partners.
  playbookInputQuery: null
- key: AllowAutomaticApproval
  value:
    simple: "yes"
  required: true
  description: Values will be yes or no, default is yes.
  playbookInputQuery: null
outputs: []
quiet: false
tests:
- No test
