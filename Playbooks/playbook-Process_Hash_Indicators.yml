elasticcommonfields: {}
id: Process Hash Indicators Test
version: -1
name: Process Hash Indicators Test
fromversion: 5.5.0
description: The playbook handles the processing of indicators by running enrichment
  and tagging the indicators accordingly. Indicators found as good will be added to
  the Demisto white list. Indicators that are found to be bad will be checked against
  the white list and removed accordingly.
starttaskid: "0"
tasks:
  "0":
    id: "0"
    taskid: bfb83830-fb0a-4c2b-869b-0f7c155e5158
    type: start
    task:
      elasticcommonfields: {}
      id: bfb83830-fb0a-4c2b-869b-0f7c155e5158
      version: -1
      name: ""
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "19"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 520,
          "y": -1750
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "3":
    id: "3"
    taskid: b9fb5f85-6e62-45dc-8793-86a0347860fc
    type: title
    task:
      elasticcommonfields: {}
      id: b9fb5f85-6e62-45dc-8793-86a0347860fc
      version: -1
      name: Done
      type: title
      iscommand: false
      brand: ""
      description: ''
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 520,
          "y": 1780
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "19":
    id: "19"
    taskid: dd6fd7a8-b09d-4d92-890c-a995cdc0ca76
    type: condition
    task:
      elasticcommonfields: {}
      id: dd6fd7a8-b09d-4d92-890c-a995cdc0ca76
      version: -1
      name: Are there results?
      description: Checks whether the specified item is in a list. The default list
        is the Demisto Indicators Whitelist.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "73"
      - "81"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: playbookQuery.value
            iscontext: true
    view: |-
      {
        "position": {
          "x": 520,
          "y": -1600
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "21":
    id: "21"
    taskid: 4b840f61-6a8f-4cc6-844b-91e57e3066b0
    type: regular
    task:
      elasticcommonfields: {}
      id: 4b840f61-6a8f-4cc6-844b-91e57e3066b0
      version: -1
      name: Gather more data on results
      description: Check file reputation
      script: '|||file'
      type: regular
      iscommand: true
      brand: ""
    nexttasks:
      '#none#':
      - "77"
      - "78"
      - "79"
      - "80"
    scriptarguments:
      file:
        simple: ${playbookQuery.value}
      long: {}
      retries: {}
      threshold: {}
      wait: {}
    continueonerror: true
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 215
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 1
  "44":
    id: "44"
    taskid: 3fa3d31b-4089-4e93-8e6a-0863e36f6124
    type: regular
    task:
      elasticcommonfields: {}
      id: 3fa3d31b-4089-4e93-8e6a-0863e36f6124
      version: -1
      name: Add bad tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          - - operator: in
              left:
                value:
                  simple: DBotScore.Indicator
                iscontext: true
              right:
                value:
                  simple: playbookQuery.value
                iscontext: true
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2610,
          "y": 1430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "45":
    id: "45"
    taskid: d548f08f-5ba5-4a9f-83db-0995d3cb48e7
    type: condition
    task:
      elasticcommonfields: {}
      id: d548f08f-5ba5-4a9f-83db-0995d3cb48e7
      version: -1
      name: Are there indicators  with high risk score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "64"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "3"
    view: |-
      {
        "position": {
          "x": 2250,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "46":
    id: "46"
    taskid: 24a99d27-5f11-4ecf-85a0-e6d57d942552
    type: condition
    task:
      elasticcommonfields: {}
      id: 24a99d27-5f11-4ecf-85a0-e6d57d942552
      version: -1
      name: Are there indicators with good Dbot score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "67"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "1"
    view: |-
      {
        "position": {
          "x": -1250,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "47":
    id: "47"
    taskid: dfbbc65b-21f3-450e-8074-e855de013002
    type: regular
    task:
      elasticcommonfields: {}
      id: dfbbc65b-21f3-450e-8074-e855de013002
      version: -1
      name: Add good tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_good
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1500,
          "y": 1430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "48":
    id: "48"
    taskid: a0b78ea9-a3df-492a-8731-4319dcc8322a
    type: condition
    task:
      elasticcommonfields: {}
      id: a0b78ea9-a3df-492a-8731-4319dcc8322a
      version: -1
      name: Are there indicators with unknown risk score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "65"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "0"
    view: |-
      {
        "position": {
          "x": 870,
          "y": 550
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "49":
    id: "49"
    taskid: c447ef2c-a1f4-42f7-8426-7f4829e3fffd
    type: regular
    task:
      elasticcommonfields: {}
      id: c447ef2c-a1f4-42f7-8426-7f4829e3fffd
      version: -1
      name: Add unknown tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          - - operator: in
              left:
                value:
                  simple: DBotScore.Indicator
                iscontext: true
              right:
                value:
                  simple: playbookQuery.value
                iscontext: true
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1170,
          "y": 1430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "50":
    id: "50"
    taskid: d9430e3f-581b-4740-833b-3a6464c73e17
    type: condition
    task:
      elasticcommonfields: {}
      id: d9430e3f-581b-4740-833b-3a6464c73e17
      version: -1
      name: Are there indicators with suspicious Dbot score?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "66"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: DBotScore.Score
            iscontext: true
          right:
            value:
              simple: "2"
    view: |-
      {
        "position": {
          "x": 170,
          "y": 540
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "51":
    id: "51"
    taskid: 4f513ac3-8487-4d63-8a3f-08c896b3c018
    type: regular
    task:
      elasticcommonfields: {}
      id: 4f513ac3-8487-4d63-8a3f-08c896b3c018
      version: -1
      name: Add suspicious tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -140,
          "y": 1430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "52":
    id: "52"
    taskid: d568628e-fd95-4355-8428-2cd6314c4610
    type: condition
    task:
      elasticcommonfields: {}
      id: d568628e-fd95-4355-8428-2cd6314c4610
      version: -1
      name: Do values appear in approved hash list?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "53"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: List.In
            iscontext: true
      - - operator: isEqualString
          left:
            value:
              simple: List.ListName
            iscontext: true
          right:
            value:
              simple: inputs.ApprovedHashList
            iscontext: true
    view: |-
      {
        "position": {
          "x": 750,
          "y": -340
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "53":
    id: "53"
    taskid: 28a843b8-78a4-44a1-8800-4a9f899ba66c
    type: regular
    task:
      elasticcommonfields: {}
      id: 28a843b8-78a4-44a1-8800-4a9f899ba66c
      version: -1
      name: Add approved hash tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: approved_hash
      indicatorsValues:
        simple: ${List.In}
      value:
        simple: ${List.In}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": 0
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "54":
    id: "54"
    taskid: afcb4e63-ae90-45e8-8ce9-3f4f4772d14e
    type: condition
    task:
      elasticcommonfields: {}
      id: afcb4e63-ae90-45e8-8ce9-3f4f4772d14e
      version: -1
      name: Is there an approved hash list?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "3"
      "yes":
      - "55"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isNotEmpty
          left:
            value:
              simple: inputs.ApprovedHashList
            iscontext: true
    view: |-
      {
        "position": {
          "x": 750,
          "y": -840
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "55":
    id: "55"
    taskid: 27df85f8-98b2-4819-8397-18ef83769c5c
    type: regular
    task:
      elasticcommonfields: {}
      id: 27df85f8-98b2-4819-8397-18ef83769c5c
      version: -1
      name: Run filter by list check on indicators
      description: Checks whether the specified item is in a list. The default list
        is the Demisto Indicators Whitelist.
      scriptName: FilterByList
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "52"
    scriptarguments:
      ignorecase:
        simple: "yes"
      listname:
        simple: ${inputs.ApprovedHashList}
      matchexact:
        simple: "yes"
      values:
        simple: ${playbookQuery.value}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -500
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "60":
    id: "60"
    taskid: 4f4e2d04-aa4a-4626-813f-c52a4ebbcd4a
    type: condition
    task:
      elasticcommonfields: {}
      id: 4f4e2d04-aa4a-4626-813f-c52a4ebbcd4a
      version: -1
      name: Manual approve indicators to be good
      description: Input in the comments the tag name to be applied for these indicators.
      type: condition
      iscommand: false
      brand: ""
    nexttasks:
      '#default#':
      - "88"
      "yes":
      - "47"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1290,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "61":
    id: "61"
    taskid: 870fb572-0b67-444a-83fa-f9dadb8be56f
    type: condition
    task:
      elasticcommonfields: {}
      id: 870fb572-0b67-444a-83fa-f9dadb8be56f
      version: -1
      name: Manual approve indicators to be suspicious
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "93"
      "yes":
      - "51"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 110,
          "y": 900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "62":
    id: "62"
    taskid: af76d4fc-d7cf-4855-8472-3a615cbb9b34
    type: condition
    task:
      elasticcommonfields: {}
      id: af76d4fc-d7cf-4855-8472-3a615cbb9b34
      version: -1
      name: Manual approve indicators to be unknown
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "96"
      "yes":
      - "49"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 930,
          "y": 900
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "63":
    id: "63"
    taskid: 1b74d083-8b69-4840-8f0f-33cc08f4cd82
    type: condition
    task:
      elasticcommonfields: {}
      id: 1b74d083-8b69-4840-8f0f-33cc08f4cd82
      version: -1
      name: Manual approve indicators to be bad
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "97"
      "yes":
      - "44"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2280,
          "y": 920
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "64":
    id: "64"
    taskid: 7c65160d-3824-433e-8be4-3f4a06d338ef
    type: condition
    task:
      elasticcommonfields: {}
      id: 7c65160d-3824-433e-8be4-3f4a06d338ef
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "63"
      "yes":
      - "44"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": 2610,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "65":
    id: "65"
    taskid: 63ab1d3f-64cd-453a-885a-491cc889983a
    type: condition
    task:
      elasticcommonfields: {}
      id: 63ab1d3f-64cd-453a-885a-491cc889983a
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "62"
      "yes":
      - "49"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": 1110,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "66":
    id: "66"
    taskid: 718e8761-3ca6-443e-8399-ebff5d3844c2
    type: condition
    task:
      elasticcommonfields: {}
      id: 718e8761-3ca6-443e-8399-ebff5d3844c2
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "61"
      "yes":
      - "51"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": -140,
          "y": 720
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "67":
    id: "67"
    taskid: 8897f479-6cc9-47fe-802d-4ecaf3c0c32d
    type: condition
    task:
      elasticcommonfields: {}
      id: 8897f479-6cc9-47fe-802d-4ecaf3c0c32d
      version: -1
      name: Is auto approved is allowed?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "60"
      "yes":
      - "47"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: isEqualString
          left:
            value:
              simple: inputs.AllowAutomaticApproval
            iscontext: true
          right:
            value:
              simple: "yes"
    view: |-
      {
        "position": {
          "x": -1500,
          "y": 730
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "69":
    id: "69"
    taskid: e8ae825c-4f3d-422a-8623-09e39eef6803
    type: regular
    task:
      elasticcommonfields: {}
      id: e8ae825c-4f3d-422a-8623-09e39eef6803
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_suspicious,processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1500,
          "y": 1605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "70":
    id: "70"
    taskid: 07128f18-023e-4de3-8f6a-f305ce81ae9b
    type: regular
    task:
      elasticcommonfields: {}
      id: 07128f18-023e-4de3-8f6a-f305ce81ae9b
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_good,processed_unknown
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 110,
          "y": 1605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "71":
    id: "71"
    taskid: 4b6051fb-d483-4684-898a-acccdf473f57
    type: regular
    task:
      elasticcommonfields: {}
      id: 4b6051fb-d483-4684-898a-acccdf473f57
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_bad,processed_good,processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 920,
          "y": 1605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "72":
    id: "72"
    taskid: 90a80b0c-67ca-4ff6-8809-b90e9e21195e
    type: regular
    task:
      elasticcommonfields: {}
      id: 90a80b0c-67ca-4ff6-8809-b90e9e21195e
      version: -1
      name: Remove other tags from indicators
      description: commands.local.cmd.remove.values.to.indicator.multi.select.field
      script: Builtin|||removeIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "3"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: processed_unknown,processed_good,processed_suspicious
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2350,
          "y": 1605
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "73":
    id: "73"
    taskid: cffd4d86-66a6-41ab-8396-12a3aa11aee7
    type: title
    task:
      elasticcommonfields: {}
      id: cffd4d86-66a6-41ab-8396-12a3aa11aee7
      version: -1
      name: Approved hash list
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "54"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 750,
          "y": -990
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "76":
    id: "76"
    taskid: 9728c90d-9190-4fd6-83ec-85aaa4a7a9d6
    type: title
    task:
      elasticcommonfields: {}
      id: 9728c90d-9190-4fd6-83ec-85aaa4a7a9d6
      version: -1
      name: Enrichment
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "21"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 290,
          "y": 65
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "77":
    id: "77"
    taskid: 9c4faae0-bfd9-4fd7-8724-3bde1f8bbee2
    type: title
    task:
      elasticcommonfields: {}
      id: 9c4faae0-bfd9-4fd7-8724-3bde1f8bbee2
      version: -1
      name: Good indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "46"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1330,
          "y": 395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "78":
    id: "78"
    taskid: b8e24184-2dcb-4746-8d80-488d5e428e15
    type: title
    task:
      elasticcommonfields: {}
      id: b8e24184-2dcb-4746-8d80-488d5e428e15
      version: -1
      name: Suspicious indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "50"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -50,
          "y": 395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "79":
    id: "79"
    taskid: c466ff3a-fc18-4f93-83f4-eff515cccc6b
    type: title
    task:
      elasticcommonfields: {}
      id: c466ff3a-fc18-4f93-83f4-eff515cccc6b
      version: -1
      name: Unknown indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "48"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 1090,
          "y": 395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "80":
    id: "80"
    taskid: 482bb1d9-f50b-404e-8c2d-79fd57c3ec43
    type: title
    task:
      elasticcommonfields: {}
      id: 482bb1d9-f50b-404e-8c2d-79fd57c3ec43
      version: -1
      name: Bad indicators
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "45"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2250,
          "y": 395
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "81":
    id: "81"
    taskid: ab77ff61-974c-4fdb-8d98-1c0c72ea92f7
    type: title
    task:
      elasticcommonfields: {}
      id: ab77ff61-974c-4fdb-8d98-1c0c72ea92f7
      version: -1
      name: Tag hash types
      type: title
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#none#':
      - "82"
      - "83"
      - "84"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -800,
          "y": -1230
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "82":
    id: "82"
    taskid: 2b6a371e-59c5-41c2-859c-ec49da800e10
    type: condition
    task:
      elasticcommonfields: {}
      id: 2b6a371e-59c5-41c2-859c-ec49da800e10
      version: -1
      name: Are there Md5 results?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "85"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: stringHasLength
          left:
            value:
              simple: playbookQuery.value
            iscontext: true
          right:
            value:
              simple: "32"
    view: |-
      {
        "position": {
          "x": -1490,
          "y": -1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "83":
    id: "83"
    taskid: 38d899ad-507e-44d0-8ad9-25c5cd46c538
    type: condition
    task:
      elasticcommonfields: {}
      id: 38d899ad-507e-44d0-8ad9-25c5cd46c538
      version: -1
      name: Are there Sha1 results?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "86"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: stringHasLength
          left:
            value:
              simple: playbookQuery.value
            iscontext: true
          right:
            value:
              simple: "40"
    view: |-
      {
        "position": {
          "x": -1010,
          "y": -1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "84":
    id: "84"
    taskid: e43a3a1e-20fe-47cd-8cd4-2098b829bbbb
    type: condition
    task:
      elasticcommonfields: {}
      id: e43a3a1e-20fe-47cd-8cd4-2098b829bbbb
      version: -1
      name: Are there Sha256 results?
      type: condition
      iscommand: false
      brand: ""
      description: ''
    nexttasks:
      '#default#':
      - "76"
      "yes":
      - "87"
    separatecontext: false
    conditions:
    - label: "yes"
      condition:
      - - operator: stringHasLength
          left:
            value:
              simple: playbookQuery.value
            iscontext: true
          right:
            value:
              simple: "64"
    view: |-
      {
        "position": {
          "x": -530,
          "y": -1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "85":
    id: "85"
    taskid: 9bcb82b4-a811-4027-8351-77b8974ca93f
    type: regular
    task:
      elasticcommonfields: {}
      id: 9bcb82b4-a811-4027-8351-77b8974ca93f
      version: -1
      name: Add approved Md5 tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: Md5
      indicatorsValues:
        complex:
          root: playbookQuery
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: playbookQuery.value
                iscontext: true
              right:
                value:
                  simple: "32"
          accessor: value
          transformers:
          - operator: uniq
      value:
        complex:
          root: playbookQuery
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: playbookQuery.value
                iscontext: true
              right:
                value:
                  simple: "32"
          accessor: value
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1710,
          "y": -640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "86":
    id: "86"
    taskid: c497959a-999c-47d1-8c18-d11d35d1e6ea
    type: regular
    task:
      elasticcommonfields: {}
      id: c497959a-999c-47d1-8c18-d11d35d1e6ea
      version: -1
      name: Add approved Sha1 tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: Sha1
      indicatorsValues:
        complex:
          root: playbookQuery
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: playbookQuery.value
                iscontext: true
              right:
                value:
                  simple: "40"
          accessor: value
          transformers:
          - operator: uniq
      value:
        complex:
          root: playbookQuery
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: playbookQuery.value
                iscontext: true
              right:
                value:
                  simple: "40"
          accessor: value
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1230,
          "y": -640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "87":
    id: "87"
    taskid: 4b0fc855-7cd7-470b-824d-20c0d63a102a
    type: regular
    task:
      elasticcommonfields: {}
      id: 4b0fc855-7cd7-470b-824d-20c0d63a102a
      version: -1
      name: Add approved Sha256 tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "76"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: Sha256
      indicatorsValues:
        complex:
          root: playbookQuery
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: playbookQuery.value
                iscontext: true
              right:
                value:
                  simple: "64"
          accessor: value
          transformers:
          - operator: uniq
      value:
        complex:
          root: playbookQuery
          filters:
          - - operator: stringHasLength
              left:
                value:
                  simple: playbookQuery.value
                iscontext: true
              right:
                value:
                  simple: "64"
          accessor: value
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -750,
          "y": -640
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "88":
    id: "88"
    taskid: 9363b7c6-a1ab-48cb-801e-71588f792cc8
    type: regular
    task:
      elasticcommonfields: {}
      id: 9363b7c6-a1ab-48cb-801e-71588f792cc8
      version: -1
      name: Manually provide tag for listed indicators
      description: |
        Input in the comments the tag name to be applied for these indicators.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "90"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1080,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "89":
    id: "89"
    taskid: 62b6053d-0fc5-4fea-84f6-459df9aeca5e
    type: regular
    task:
      elasticcommonfields: {}
      id: 62b6053d-0fc5-4fea-84f6-459df9aeca5e
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "69"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${lastCompletedTaskEntries.[0]}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1080,
          "y": 1430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "90":
    id: "90"
    taskid: fb8d6503-cd3b-4943-8ceb-cc03e8bf2913
    type: regular
    task:
      elasticcommonfields: {}
      id: fb8d6503-cd3b-4943-8ceb-cc03e8bf2913
      version: -1
      name: Set tags to context
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "89"
    scriptarguments:
      contextKey:
        simple: UserDefinedTag1
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": -1080,
          "y": 1275
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "91":
    id: "91"
    taskid: 06db0988-0aa7-43e6-840b-4ed17eb204ad
    type: regular
    task:
      elasticcommonfields: {}
      id: 06db0988-0aa7-43e6-840b-4ed17eb204ad
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "70"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${lastCompletedTaskEntries.[0]}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "2"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 280,
          "y": 1430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "92":
    id: "92"
    taskid: 1ca69f71-1c37-40aa-896b-94866d45bd2a
    type: regular
    task:
      elasticcommonfields: {}
      id: 1ca69f71-1c37-40aa-896b-94866d45bd2a
      version: -1
      name: Set tags to context
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "91"
    scriptarguments:
      contextKey:
        simple: UserDefinedTag2
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 280,
          "y": 1255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "93":
    id: "93"
    taskid: 0b3126c2-5127-4baa-8037-06a1a035a107
    type: regular
    task:
      elasticcommonfields: {}
      id: 0b3126c2-5127-4baa-8037-06a1a035a107
      version: -1
      name: Manually provide tag for listed indicators
      description: |
        Input in the comments the tag name to be applied for these indicators.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "92"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 280,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "94":
    id: "94"
    taskid: db3b5f6f-0e6c-4ad6-8899-ffe632db68cb
    type: regular
    task:
      elasticcommonfields: {}
      id: db3b5f6f-0e6c-4ad6-8899-ffe632db68cb
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "71"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${lastCompletedTaskEntries.[0]}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "0"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 760,
          "y": 1430
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
  "95":
    id: "95"
    taskid: ca5d6416-2616-4f17-817c-2e619e9fcfae
    type: regular
    task:
      elasticcommonfields: {}
      id: ca5d6416-2616-4f17-817c-2e619e9fcfae
      version: -1
      name: Set tags to context
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "94"
    scriptarguments:
      contextKey:
        simple: UserDefinedTag3
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 760,
          "y": 1255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "96":
    id: "96"
    taskid: 89df7de7-d547-452a-8821-05e1673006cf
    type: regular
    task:
      elasticcommonfields: {}
      id: 89df7de7-d547-452a-8821-05e1673006cf
      version: -1
      name: Manually provide tag for listed indicators
      description: |
        Input in the comments the tag name to be applied for these indicators.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "95"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 760,
          "y": 1090
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "97":
    id: "97"
    taskid: 237c2b7a-8ee3-4115-8864-ea274298662d
    type: regular
    task:
      elasticcommonfields: {}
      id: 237c2b7a-8ee3-4115-8864-ea274298662d
      version: -1
      name: Manually provide tag for listed indicators
      description: |
        Input in the comments the tag name to be applied for these indicators.
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "98"
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2080,
          "y": 1100
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "98":
    id: "98"
    taskid: f97b1a49-162b-40be-8001-99a98935a4fc
    type: regular
    task:
      elasticcommonfields: {}
      id: f97b1a49-162b-40be-8001-99a98935a4fc
      version: -1
      name: Set tags to context
      description: "Takes the comments of a given entry ID and stores them in the
        incident context, under a provided context key. \nFor accessing the last executed
        task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for
        the entryId input parameter."
      scriptName: commentsToContext
      type: regular
      iscommand: false
      brand: ""
    nexttasks:
      '#none#':
      - "99"
    scriptarguments:
      contextKey:
        simple: UserDefinedTag4
      entryId:
        simple: ${lastCompletedTaskEntries.[0]}
      listSeperator: {}
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2080,
          "y": 1255
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 0
  "99":
    id: "99"
    taskid: 83448fe1-e831-4589-883a-2ccc38442440
    type: regular
    task:
      elasticcommonfields: {}
      id: 83448fe1-e831-4589-883a-2ccc38442440
      version: -1
      name: Add manual user tag to indicators
      description: commands.local.cmd.add.values.to.indicator.multi.select.field
      script: Builtin|||appendIndicatorField
      type: regular
      iscommand: true
      brand: Builtin
    nexttasks:
      '#none#':
      - "72"
    scriptarguments:
      field:
        simple: tags
      fieldValue:
        simple: ${lastCompletedTaskEntries.[0]}
      indicatorsValues:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "3"
          accessor: Indicator
          transformers:
          - operator: uniq
      value:
        complex:
          root: DBotScore
          filters:
          - - operator: isEqualString
              left:
                value:
                  simple: DBotScore.Score
                iscontext: true
              right:
                value:
                  simple: "1"
          accessor: Indicator
          transformers:
          - operator: uniq
    separatecontext: false
    view: |-
      {
        "position": {
          "x": 2080,
          "y": 1420
        }
      }
    note: false
    timertriggers: []
    ignoreworker: false
    skipunavailable: false
    quietmode: 2
view: |-
  {
    "linkLabelsPosition": {},
    "paper": {
      "dimensions": {
        "height": 3595,
        "width": 4700,
        "x": -1710,
        "y": -1750
      }
    }
  }
inputs:
- key: ""
  value: {}
  required: false
  description: ""
  playbookInputQuery: null
- key: ApprovedHashList
  value: {}
  required: false
  description: A Demisto list containing approved hash values. Hash indicators that
    appear in the list will be tagged as approved.
  playbookInputQuery: null
- key: ""
  value: {}
  required: false
  description: ""
  playbookInputQuery:
    query: ""
    queryEntity: indicators
    results: null
    daterange:
      fromdate: 0001-01-01T00:00:00Z
      todate: 0001-01-01T00:00:00Z
      period:
        by: ""
        byto: ""
        byfrom: ""
        tovalue: null
        fromvalue: null
        field: ""
      fromdatelicenseval: 0001-01-01T00:00:00Z
    runFromLastJobTime: false
outputs: []
tests:
- No test