category: Data Enrichment & Threat Intelligence
commonfields:
  id: URLhaus
  version: -1
configuration:
- defaultvalue: https://urlhaus-api.abuse.ch/v1/ # disable-secrets-detection
  display: Server URL (e.g. https://192.168.0.1)
  name: url
  required: false
  type: 0
- display: Trust any certificate (unsecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- name: threshold
  required: false
  type: 0
description: URLhaus has the goal of sharing malicious URLs that are being used for
  malware distribution.
display: URLhaus
name: URLhaus
script:
  commands:
  - arguments:
    - default: false
      description: URL to query
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: false
    description: Retrieve URL information from URLhaus
    execution: false
    name: url
    outputs:
    - contextPath: URL.Data
      description: The URL
      type: string
    - contextPath: URL.Malicious.Vendor
      description: Vendor reporting the malicious status
      type: string
    - contextPath: URL.Malicious.Description
      description: Description of the malicious url
      type: string
    - contextPath: URLhaus.URL.ID
      description: Unique idendifier of the URLhaus database entry
      type: string
    - contextPath: URLhaus.URL.Status
      description: The current status of the URL.
      type: string
    - contextPath: URLhaus.URL.Host
      description: The extracted host of the malware URL (IP address or domain name/FQDN)
      type: string
    - contextPath: URLhaus.URL.DateAdded
      description: Date the URL was added to URLHaus
      type: date
    - contextPath: URLhaus.URL.Threat
      description: The threat corresponding to this malware URL.
      type: string
    - contextPath: URLhaus.URL.Blacklist
      description: Blacklist status of the queried URL.
      type: Unknown
    - contextPath: URLhaus.URL.Tags
      description: A list of tags associated with the queried malware URL.
      type: string
    - contextPath: URLhaus.URL.PayloadName
      description: Payload file name
      type: string
    - contextPath: URLhaus.URL.PayloadType
      description: Payload file type
      type: string
    - contextPath: URLhaus.URL.PayloadMD5
      description: MD5 hash of the HTTP response body (payload)
      type: string
    - contextPath: URLhaus.URL.PayloadVT
      description: Results from Virustotal about the payload
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested
      type: string
  - arguments:
    - default: false
      description: IP address to query
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Retrieve host information from URLhaus
    execution: false
    name: ip
    outputs:
    - contextPath: IP.Address
      description: IP address
      type: string
  - arguments:
    - default: false
      description: domain to query
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Retrieve domain information from URLhaus
    execution: false
    name: domain
    outputs:
    - contextPath: Domain.Name
      description: The domain name e.g. google.com
      type: string
  - arguments:
    - default: false
      description: MD5 or SHA256 of the file to query
      isArray: false
      name: file
      required: true
      secret: false
    deprecated: false
    description: Retrieve file information from URLhaus
    execution: false
    name: file
    outputs:
    - contextPath: File.Name
      description: Full Filename e.g. data.xls
      type: string
  - arguments:
    - default: false
      description: The sha256 of the file to download
      isArray: false
      name: file
      required: true
      secret: false
    deprecated: false
    description: Download a malware sample from URLhaus
    execution: false
    name: urlhaus-download-sample
    outputs:
    - contextPath: File.Size
      description: File size
      type: number
    - contextPath: File.SHA1
      description: File sha1
      type: string
    - contextPath: File.SHA256
      description: File sha256
      type: string
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.SSDeep
      description: File SSDeep
      type: string
    - contextPath: File.EntryID
      description: 'File entry ID '
      type: string
    - contextPath: File.Info
      description: File information
      type: string
    - contextPath: File.Type
      description: File type
      type: string
    - contextPath: File.MD5
      description: File md5
      type: string
    - contextPath: ' File.Extension'
      description: File extension
      type: string
  dockerimage: demisto/python3:3.7.3.286
  isfetch: false
  runonce: false
  script: '-'
  type: python
