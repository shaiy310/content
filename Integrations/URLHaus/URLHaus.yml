category: Data Enrichment & Threat Intelligence
commonfields:
  id: URLhaus
  version: -1
configuration:
- defaultvalue: https://urlhaus-api.abuse.ch/v1/ # disable-secrets-detection
  display: Server URL (e.g. https://192.168.0.1)
  name: url
  required: false
  type: 0
- display: Trust any certificate (unsecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- defaultvalue: '1'
  display: Blacklists appearances threshold
  name: threshold
  required: false
  type: 0
- display: Compromised is malicious
  name: compromised_is_malicious
  required: false
  type: 8
description: URLhaus has the goal of sharing malicious URLs that are being used for
  malware distribution.
display: URLhaus
name: URLhaus
script:
  commands:
  - arguments:
    - default: false
      description: URL to query
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: false
    description: Retrieve URL information from URLhaus
    execution: false
    name: url
    outputs:
    - contextPath: URL.Data
      description: The URL
      type: string
    - contextPath: URL.Malicious.Vendor
      description: Vendor reporting the malicious status
      type: string
    - contextPath: URL.Malicious.Description
      description: Description of the malicious url
      type: string
    - contextPath: URLhaus.URL.ID
      description: Unique idendifier of the URLhaus database entry
      type: string
    - contextPath: URLhaus.URL.Status
      description: The current status of the URL.
      type: string
    - contextPath: URLhaus.URL.Host
      description: The extracted host of the malware URL (IP address or domain name/FQDN)
      type: string
    - contextPath: URLhaus.URL.DateAdded
      description: Date the URL was added to URLHaus
      type: date
    - contextPath: URLhaus.URL.Threat
      description: The threat corresponding to this malware URL.
      type: string
    - contextPath: URLhaus.URL.Blacklist.Name
      description: Name of the blacklist
      type: String
    - contextPath: URLhaus.URL.Tags
      description: A list of tags associated with the queried malware URL.
      type: string
    - contextPath: URLhaus.URL.Payload.Name
      description: Payload file name
      type: String
    - contextPath: URLhaus.URL.Payload.Type
      description: Payload file type
      type: String
    - contextPath: URLhaus.URL.Payload.MD5
      description: MD5 hash of the HTTP response body (payload)
      type: String
    - contextPath: URLhaus.URL.Payload.VT.Result
      description: Results from Virustotal about the payload
      type: Number
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested
      type: string
    - contextPath: URLhaus.URL.Blacklist.Status
      description: Status of the URL in the blacklist
      type: String
    - contextPath: URLhaus.URL.Payload.VT.Link
      description: Link to the VT report
      type: String
  - arguments:
    - default: false
      description: domain to query
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Retrieve domain information from URLhaus
    execution: false
    name: domain
    outputs:
    - contextPath: Domain.Name
      description: The domain name e.g. google.com
      type: String
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested
      type: string
    - contextPath: URLhaus.Domain.FirstSeen
      description: When the IP was seen for the first time (UTC)
      type: Date
    - contextPath: URLhaus.Domain.Blacklist.Name
      description: The status of the domain in different blacklists
      type: String
    - contextPath: URLhaus.Domain.URL
      description: URLs observed on this domain
      type: String
    - contextPath: Domain.Malicious.Vendor
      description: Vendor reporting the malicious status
      type: String
    - contextPath: Domain.Malicious.Description
      description: Description of the malicious domain
      type: String
    - contextPath: URLhaus.Domain.Blacklist.Status
      description: Status of the URL in the blacklist
      type: String
  - arguments:
    - default: false
      description: MD5 or SHA256 of the file to query
      isArray: false
      name: hash
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: MD5
      description: MD5 or SHA256
      isArray: false
      name: hash_type
      predefined:
      - MD5
      - ' SHA256'
      required: true
      secret: false
    deprecated: false
    description: Retrieve file information from URLhaus
    execution: false
    name: file
    outputs:
    - contextPath: "File.Size\t"
      description: Size of the file in bytes
      type: Number
    - contextPath: File.MD5
      description: MD5 Hash of the file
      type: String
    - contextPath: File.SHA256
      description: SHA256 hash of the file
      type: String
    - contextPath: URLhaus.File.MD5
      description: MD5 Hash of the file
      type: String
    - contextPath: URLhaus.File.SHA256
      description: SHA256 hash of the file
      type: String
    - contextPath: URLhaus.File.Type
      description: File type guessed by URLhaus (e.g. exe, doc, etc)
      type: String
    - contextPath: URLhaus.File.Size
      description: File size in bytes
      type: Number
    - contextPath: URLhaus.File.Signature
      description: Malware familiy
      type: String
    - contextPath: URLhaus.File.FirstSeen
      description: UTC time when URLhaus has first seen this file (payload)
      type: Date
    - contextPath: URLhaus.File.LastSeen
      description: UTC time when URLhaus has last seen this file (payload)
      type: Date
    - contextPath: URLhaus.File.DownloadLink
      description: Location (URL) where you can download a copy of this file
      type: String
    - contextPath: URLhaus.File.VirusTotal.Percent
      description: AV detection in percent (e.g. 24.14)
      type: Number
    - contextPath: URLhaus.File.VirusTotal.Link
      description: Link to the Virustotal report
      type: String
    - contextPath: URLhaus.File.URL
      description: A list of malware URLs associated with this payload (max 100)
      type: Unknown
  - arguments:
    - default: false
      description: The sha256 of the file to download
      isArray: false
      name: file
      required: true
      secret: false
    deprecated: false
    description: Download a malware sample from URLhaus
    execution: true
    name: urlhaus-download-sample
    outputs:
    - contextPath: File.Size
      description: File size
      type: number
    - contextPath: File.SHA1
      description: File sha1
      type: string
    - contextPath: File.SHA256
      description: File sha256
      type: string
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.SSDeep
      description: File SSDeep
      type: string
    - contextPath: File.EntryID
      description: 'File entry ID '
      type: string
    - contextPath: File.Info
      description: File information
      type: string
    - contextPath: File.Type
      description: File type
      type: string
    - contextPath: File.MD5
      description: File md5
      type: string
    - contextPath: ' File.Extension'
      description: File extension
      type: string
  dockerimage: demisto/python3:3.7.3.286
  isfetch: false
  runonce: false
  script: '-'
  type: python
