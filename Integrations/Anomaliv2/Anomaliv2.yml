category: Data Enrichment & Threat Intelligence
commonfields:
  id: Anomaliv2
  version: -1
configuration:
- defaultvalue: https://api.threatstream.com
  display: Server URL (e.g. https://www.test.com)
  name: url
  required: true
  type: 0
- display: Username
  name: username
  required: true
  type: 0
- display: API Key
  name: apikey
  required: true
  type: 4
- defaultvalue: 'false'
  display: Trust any certificate (insecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
description: Use Anomali ThreatStream to query and submit threats
display: Anomali ThreatStream v2
name: Anomaliv2
script:
  commands:
  - arguments:
    - default: false
      description: The IP to check.
      isArray: false
      name: ip
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: high
      description: If Severity is greater or equal than the threshold, then the ip
        will be considered malicious. By default is set to high.
      isArray: false
      name: threshold
      predefined:
      - low
      - medium
      - high
      - very-high
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: Include results with Inactive status. By default is set to True.
      isArray: false
      name: include_inactive
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Checks the reputation of the given IP.
    execution: false
    name: ip
    outputs:
    - contextPath: DBotScore.Indicator
      description: The tested indicator.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score.
      type: String
    - contextPath: IP.ASN
      description: Autonomous System (AS) number associated with the indicator.
      type: String
    - contextPath: IP.Address
      description: IP Address of the indicator.
      type: String
    - contextPath: IP.Geo.Country
      description: Country associated with the indicator.
      type: String
    - contextPath: IP.Geo.Location
      description: Longitude and Latitude of the IP address.
      type: String
    - contextPath: ThreatStream.IP.ASN
      description: Autonomous System (AS) number associated with the indicator.
      type: String
    - contextPath: ThreatStream.IP.Address
      description: IP Address of the indicator.
      type: String
    - contextPath: ThreatStream.IP.Country
      description: Country associated with the indicator.
      type: String
    - contextPath: ThreatStream.IP.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.IP.Modified
      description: |-
        Time when the indicator was last updated. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: String
    - contextPath: ThreatStream.IP.Severity
      description: 'The indicator severity. Possible values: very-high, high, medium,
        low.'
      type: String
    - contextPath: ThreatStream.IP.Confidence
      description: |-
        Level of certainty that an observable is of the reported indicator type. Confidence score can range from 0-100, in increasing order of
        confidence.
      type: String
    - contextPath: ThreatStream.IP.Status
      description: Status assigned to the indicator.
      type: String
    - contextPath: ThreatStream.IP.Organization
      description: Name of the business that owns the IP address associated with the
        indicator.
      type: String
    - contextPath: ThreatStream.IP.Source
      description: The source of the indicator.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: IP.Malicious.Vendor
      description: Vendor reporting malicious.
      type: String
  - arguments:
    - default: false
      description: The domain name to check.
      isArray: false
      name: domain
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: high
      description: If Severity is greater or equal than the threshold, then the ip
        will be considered malicious. By default is set to high.
      isArray: false
      name: threshold
      predefined:
      - low
      - medium
      - high
      - very-high
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: Include results with Inactive status. By default is set to True.
      isArray: false
      name: include_inactive
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Checks the reputation of the domain name.
    execution: false
    name: domain
    outputs:
    - contextPath: Domain.Name
      description: The domain name.
      type: String
    - contextPath: Domain.DNS
      description: 'IPs resolved by DNS. '
      type: String
    - contextPath: Domain.WHOIS.CreationDate
      description: |-
        Date the domain was created. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: Date
    - contextPath: Domain.WHOIS.UpdatedDate
      description: |-
        Date the domain was last updated. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: Date
    - contextPath: Domain.WHOIS.Registrant.Name
      description: Name of the registrant.
      type: String
    - contextPath: Domain.WHOIS.Registrant.Email
      description: Email of the registrant.
      type: String
    - contextPath: Domain.WHOIS.Registrant.Phone
      description: Phone Number of the registrant.
      type: String
    - contextPath: ThreatStream.Domain.ASN
      description: Autonomous System (AS) number associated with the indicator.
      type: String
    - contextPath: ThreatStream.Domain.Address
      description: The domain of the indicator.
      type: String
    - contextPath: ThreatStream.Domain.Country
      description: Country associated with the indicator.
      type: String
    - contextPath: ThreatStream.Domain.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.Domain.Modified
      description: |-
        Time when the indicator was last updated. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: String
    - contextPath: ThreatStream.Domain.Severity
      description: 'The indicator severity. Possible values: very-high, high, medium,
        low.'
      type: String
    - contextPath: ThreatStream.Domain.Confidence
      description: |-
        Level of certainty that an observable is of the reported indicator type. Confidence score can range from 0-100, in increasing order of
        confidence.
      type: String
    - contextPath: ThreatStream.Domain.Status
      description: Status assigned to the indicator.
      type: String
    - contextPath: ThreatStream.Domain.Organization
      description: Name of the business that owns the IP address associated with the
        indicator.
      type: String
    - contextPath: ThreatStream.Domain.Source
      description: The source of the indicator.
      type: String
    - contextPath: Domain.Malicious.Vendor
      description: Vendor reporting malicious.
      type: String
    - contextPath: DBotScore.Indicator
      description: The tested indicator.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
  - arguments:
    - default: false
      description: The md5 of file to check.
      isArray: false
      name: md5
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: high
      description: If Severity is greater or equal than the threshold, then the ip
        will be considered malicious. By default is set to high.
      isArray: false
      name: threshold
      predefined:
      - low
      - medium
      - high
      - very-high
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: Include results with Inactive status. By default is set to True.
      isArray: false
      name: include_inactive
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Checks the reputation of the given md5 of the file.
    execution: false
    name: file
    outputs:
    - contextPath: File.MD5
      description: MD5 Hash of the file.
      type: String
    - contextPath: File.Malicious.Vendor
      description: Vendor reporting malicious.
      type: String
    - contextPath: DBotScore.Indicator
      description: The tested indicator.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: ThreatStream.File.Severity
      description: 'The indicator severity. Possible values: very-high, high, medium,
        low.'
      type: String
    - contextPath: ThreatStream.File.Confidence
      description: |-
        Level of certainty that an observable is of the reported indicator type. Confidence score can range from 0-100, in increasing order of
        confidence.
      type: String
    - contextPath: ThreatStream.File.Status
      description: Status assigned to the indicator.
      type: String
    - contextPath: ThreatStream.File.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.File.MD5
      description: The MD5 of the indicator.
      type: String
    - contextPath: ThreatStream.File.Modified
      description: |-
        Time when the indicator was last updated. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: String
    - contextPath: ThreatStream.File.Source
      description: The source of the indicator.
      type: String
  - arguments:
    - default: false
      description: The email address to check.
      isArray: false
      name: email
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: high
      description: If Severity is greater or equal than the threshold, then the ip
        will be considered malicious. By default is set to high
      isArray: false
      name: threshold
      predefined:
      - low
      - medium
      - high
      - very-high
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: Include results with Inactive status. By default is set to True.
      isArray: false
      name: include_inactive
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Checks the reputation of the given email address.
    execution: false
    name: threatstream-email-reputation
    outputs:
    - contextPath: DBotScore.Indicator
      description: The tested indicator.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: ThreatStream.EmailReputation.Severity
      description: 'The indicator severity. Possible values: very-high, high, medium,
        low.'
      type: String
    - contextPath: ThreatStream.EmailReputation.Confidence
      description: |-
        Level of certainty that an observable is of the reported indicator type. Confidence score can range from 0-100, in increasing order of
        confidence.
      type: String
    - contextPath: ThreatStream.EmailReputation.Status
      description: Status assigned to the indicator.
      type: String
    - contextPath: ThreatStream.EmailReputation.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.EmailReputation.Email
      description: The email address of the indicator.
      type: String
    - contextPath: ThreatStream.EmailReputation.Source
      description: The source of the indicator.
      type: String
    - contextPath: ThreatStream.EmailReputation.Modified
      description: |-
        Time when the indicator was last updated. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      defaultValue: ip
      description: 'The type of passive DNS search. Possible values are: ip, domain.'
      isArray: false
      name: type
      predefined:
      - ip
      - domain
      required: true
      secret: false
    - default: false
      description: The value of IP or Domain.
      isArray: false
      name: value
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: Limits the number of results to be displayed. By default is set
        to 50.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Returns enrichment data for Domain or IP for availabe observables.
    execution: false
    name: threatstream-get-passive-dns
    outputs:
    - contextPath: ThreatStream.PassiveDNS.Domain
      description: The domain value.
      type: String
    - contextPath: ThreatStream.PassiveDNS.Ip
      description: The IP value.
      type: String
    - contextPath: ThreatStream.PassiveDNS.Rrtype
      description: The Rrtype value.
      type: String
    - contextPath: ThreatStream.PassiveDNS.Source
      description: The source value.
      type: String
    - contextPath: ThreatStream.PassiveDNS.FirstSeen
      description: |-
        The first seen date. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: String
    - contextPath: ThreatStream.PassiveDNS.LastSeen
      description: |-
        The last seen date. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: String
  - arguments:
    - default: false
      defaultValue: '50'
      description: The level of certainty that an observable is of the reported indicator
        type. By default is set to 50.
      isArray: false
      name: confidence
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: private
      description: Denotes whether the indicator data is public or private to organization.
        By default is set to private.
      isArray: false
      name: classification
      predefined:
      - private
      - public
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: exploit
      description: Type of threat associated with the imported observables. By default
        is set to exploit.
      isArray: false
      name: threat_type
      predefined:
      - adware
      - anomalous
      - anonymization
      - apt
      - bot
      - brute
      - c2
      - compromised
      - crypto
      - data_leakage
      - ddos
      - dyn_dns
      - exfil
      - exploit
      - hack_tool
      - i2p
      - informational
      - malware
      - p2p
      - parked
      - phish
      - scan
      - sinkhole
      - spam
      - suppress
      - suspicious
      - tor
      - vps
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: low
      description: Gauges the potential impact of the indicator type the observable
        is thought to be associated with. By default is set to low.
      isArray: false
      name: severity
      predefined:
      - low
      - medium
      - high
      - very-high
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: 'The import type of the indicator. '
      isArray: false
      name: import_type
      predefined:
      - datatext
      - file-id
      - url
      required: true
      secret: false
    - default: false
      description: 'The source of imported data. Can be one of the following: url,
        datatext of file-id of uploaded file to the war room. Supported formats in
        case of file-id are: CSV, HTML, IOC, JSON, PDF, TXT.'
      isArray: false
      name: import_value
      required: true
      secret: false
    deprecated: false
    description: 'Imports indicators (observables) into ThreatStream and require approval
      of the imported data through the ThreatStream UI. The data can be imported using
      one of three methods: plain-text, file or URL. Only one argument can be used.'
    execution: false
    name: threatstream-import-indicator-with-approval
    outputs:
    - contextPath: ThreatStream.Import.ImportID
      description: The ID of imported data.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: The type of indicator to be imported.
      isArray: false
      name: indicator_type
      predefined:
      - srcip
      - domain
      - url
      - email
      - md5
      required: true
      secret: false
    - default: false
      description: The indicator value to be imported.
      isArray: false
      name: indicator_data
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Classification of the indicator.
      isArray: false
      name: classification
      predefined:
      - public
      - ' private'
      required: false
      secret: false
    - default: false
      description: Level of certainty that an observable is of the reported indicator
        type.
      isArray: false
      name: confidence
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Severity you want to assign to the indicator when it is imported.
      isArray: false
      name: severity
      predefined:
      - low
      - medium
      - high
      - very-high
      required: false
      secret: false
    - default: false
      description: Tags applied to the imported observables.
      isArray: false
      name: tags
      required: false
      secret: false
    deprecated: true
    description: Imports indicators (observables) into ThreatStream and doesn't require
      approval of the imported data through the ThreatStream UI. You must have the
      Approve Intel user permission to import without approval via the API.
    execution: false
    name: threatstream-import-indicator-without-approval
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Threat model of returned list
      isArray: false
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - ttp
      - vulnerability
      - tipreport
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: Limits the list of models size. Specifying limit=0 will return
        up to a maximum of 1000 models. In case of limit=0 the output won't be set
        to the context.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Returns a list of Threat Model.
    execution: false
    name: threatstream-get-model-list
    outputs:
    - contextPath: ThreatStream.List.Type
      description: The type of Threat Model.
      type: String
    - contextPath: ThreatStream.List.Name
      description: The name of Threat Model.
      type: String
    - contextPath: ThreatStream.List.ID
      description: The ID of Threat Model.
      type: String
    - contextPath: ThreatStream.List.CreatedTime
      description: |-
        The time of Threat Model creation. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value for time, in UTC time.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Threat model.
      isArray: false
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - ttp
      - vulnerability
      - tipreport
      required: true
      secret: false
    - default: false
      description: The id of Threat model.
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Returns html file with description of Threat Model.
    execution: false
    name: threatstream-get-model-description
    outputs:
    - contextPath: File.Name
      description: The File name of model desctiption.
      type: String
    - contextPath: File.EntryID
      description: The enry ID of model desctipton.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Threat model.
      isArray: false
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - signature
      - ttp
      - vulnerability
      - tipreport
      required: true
      secret: false
    - default: false
      description: The ID of the model.
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      defaultValue: '20'
      description: Limits the number of returned results. The defaullt is set to 20.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Returns a list of indecators associated with the specified model
      and model's id.
    execution: false
    name: threatstream-get-indicators-by-model
    outputs:
    - contextPath: ThreatStream.Model.ModelType
      description: The type of Threat model.
      type: String
    - contextPath: ThreatStream.Model.ModelID
      description: The ID of Threat Model
      type: String
    - contextPath: ThreatStream.Model.Indicators.Value
      description: The value of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.ID
      description: The ID of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.IType
      description: The iType of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Severity
      description: The severity of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Confidence
      description: The confidence of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Country
      description: The courty of indicator associated with the specified model
      type: String
    - contextPath: ThreatStream.Model.Indicators.Organization
      description: The organization of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.ASN
      description: The ASN of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Status
      description: The status of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Tags
      description: The tags of indicator associated with the specified model.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Modified
      description: The modified time of the indicator.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Source
      description: The source of the inidicator.
      type: String
    - contextPath: ThreatStream.Model.Indicators.Type
      description: The type of the inidicator.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      defaultValue: private
      description: Classification of the Sandbox submission.
      isArray: false
      name: submission_classification
      predefined:
      - private
      - public
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: WINDOWS7
      description: Platform on which the submitted URL or file will be run. In order
        to obtain a list supported platforms run threatstream-get-sandbox-platforms
        command.
      isArray: false
      name: report_platform
      predefined:
      - WINDOWS7
      - WINDOWSXP
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: file
      description: The detonation type, possible values for detonation are file or
        url.
      isArray: false
      name: submission_type
      predefined:
      - file
      - url
      required: true
      secret: false
    - default: false
      description: The submission value. Valid URL or file id that was uploaded to
        war room to detonate.
      isArray: false
      name: submission_value
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'false'
      description: Specify whether the premium sandbox should be used for detonation.
        By default is set to false.
      isArray: false
      name: premium_sandbox
      predefined:
      - 'false'
      - 'true'
      required: false
      secret: false
    - default: false
      description: A comma-separated list that provides additional details for the
        indicator. This information is displayed in the Tag column of the ThreatStream
        UI.
      isArray: false
      name: detail
      required: false
      secret: false
    deprecated: false
    description: Detonates file or URL to the ThreatStream-hosted Sandbox.
    execution: false
    name: threatstream-submit-to-sandbox
    outputs:
    - contextPath: ThreatStream.Sandbox.ID
      description: The report ID that was submitted to sandbox.
      type: String
    - contextPath: ThreatStream.Sandbox.Status
      description: The analysis status.
      type: String
    - contextPath: ThreatStream.Sandbox.Platform
      description: The platform of submission to sanbox.
      type: String
  - arguments:
    - default: false
      description: Report ID to check status.
      isArray: false
      name: report_id
      required: true
      secret: false
    deprecated: false
    description: Returns the current status of report that was submitted to sandbox.
    execution: false
    name: threatstream-get-analysis-status
    outputs:
    - contextPath: ThreatStream.Sandbox.ID
      description: The report ID of the file or URL that was detonated to sandbox.
      type: String
    - contextPath: ThreatStream.Sandbox.Status
      description: The report status of the file or URL that was detonated to sandbox.
      type: String
    - contextPath: ThreatStream.Sandbox.Platform
      description: The platfrom that was used for detonation.
      type: String
    - contextPath: ThreatStream.Sandbox.Verdict
      description: The report verdict of the file or URL that was detonated to sandbox.
        The verdict will remain Benign until the end of detonation.
      type: String
  - arguments:
    - default: false
      description: Report ID to return.
      isArray: false
      name: report_id
      required: true
      secret: false
    deprecated: false
    description: Returns report of file or URL that was submitted to sandbox.
    execution: false
    name: threatstream-analysis-report
    outputs:
    - contextPath: ThreatStream.SandboxReport.ID
      description: The ID of the report submitted to sandbox.
      type: String
    - contextPath: ThreatStream.SandboxReport.Category
      description: The category of report.
      type: String
    - contextPath: ThreatStream.SandboxReport.Started
      description: The start time of detonation.
      type: String
    - contextPath: ThreatStream.SandboxReport.Completed
      description: The complete time of detonation.
      type: String
    - contextPath: ThreatStream.SandboxReport.Duration
      description: Duration of detonation in seconds.
      type: Number
    - contextPath: ThreatStream.SandboxReport.VmName
      description: The name of VM.
      type: String
    - contextPath: ThreatStream.SandboxReport.VmID
      description: The ID of VM.
      type: String
    - contextPath: ThreatStream.Network.UdpSource
      description: The source of UDP.
      type: String
    - contextPath: ThreatStream.Network.UdpDestination
      description: The destination of UDP.
      type: String
    - contextPath: ThreatStream.Network.UdpPort
      description: The port of the UDP.
      type: String
    - contextPath: ThreatStream.Network.IcmpSource
      description: The ICMP source.
      type: String
    - contextPath: ThreatStream.Network.IcmpDestination
      description: The destinaton of ICMP.
      type: String
    - contextPath: ThreatStream.Network.IcmpPort
      description: The port of the ICMP.
      type: String
    - contextPath: ThreatStream.Network.TcpSource
      description: The source of TCP.
      type: String
    - contextPath: ThreatStream.Network.TcpDestination
      description: The destination of TCP.
      type: String
    - contextPath: ThreatStream.Network.TcpPort
      description: The port of TCP.
      type: String
    - contextPath: ThreatStream.Network.HttpSource
      description: The source of HTTP.
      type: String
    - contextPath: ThreatStream.Network.HttpDestinaton
      description: The destination of HTTP.
      type: String
    - contextPath: ThreatStream.Network.HttpPort
      description: The port of HTTP.
      type: String
    - contextPath: ThreatStream.Network.HttpsSource
      description: The source of HTTPS.
      type: String
    - contextPath: ThreatStream.Network.HttpsDestinaton
      description: The destination of HTTPS.
      type: String
    - contextPath: ThreatStream.Network.HttpsPort
      description: The port of HTTPS.
      type: String
    - contextPath: ThreatStream.Network.Hosts
      description: The hosts of network analysis.
      type: String
    - contextPath: ThreatStream.SandboxReport.Verdict
      description: The verdict of the detonation to sandbox.
      type: String
  - arguments:
    - default: false
      description: Anomali's Observable Search Filter Language query to filter indicatorts
        results. If query is passed as argument, it overides all other arguments.
      isArray: false
      name: query
      required: false
      secret: false
    - default: false
      description: Autonomous System (AS) number associated with the indicator.
      isArray: false
      name: asn
      required: false
      secret: false
    - default: false
      description: |-
        Level of certainty that an observable
        is of the reported indicator type. Confidence scores range from 0-100, in increasing order of confidence, and is assigned by ThreatStream based on several factors.
      isArray: false
      name: confidence
      required: false
      secret: false
    - default: false
      description: Country associated with the indicator.
      isArray: false
      name: country
      required: false
      secret: false
    - default: false
      description: |-
        When the indicator was first seen on
        the ThreatStream cloud platform. Date must be specified in this format:
        YYYYMMDDThhmmss where T denotes the start of the value for time, in UTC time.
        For example, 2014-10-02T20:44:35
      isArray: false
      name: created_ts
      required: false
      secret: false
    - default: false
      description: Unique ID for the indicator.
      isArray: false
      name: id
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Classification of the indicator.
      isArray: false
      name: is_public
      predefined:
      - 'false'
      - 'true'
      required: false
      secret: false
    - default: false
      description: Severity assigned to the indicator through ThreatStream.
      isArray: false
      name: indicator_severity
      required: false
      secret: false
    - default: false
      description: Registered owner (organization) of the IP address associated with
        the indicator.
      isArray: false
      name: org
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Status assigned to the indicator.
      isArray: false
      name: status
      predefined:
      - active
      - inactive
      - falsepos
      required: false
      secret: false
    - default: false
      description: Tag assigned to the indicator.
      isArray: false
      name: tags_name
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Type of indicator.
      isArray: false
      name: type
      predefined:
      - domain
      - email
      - ip
      - md5
      - string
      - url
      required: false
      secret: false
    - default: false
      description: 'Value of the indicator. '
      isArray: false
      name: indicator_value
      required: false
      secret: false
    - default: false
      defaultValue: '20'
      description: The limitation of returned results from ThreatStrem. By default
        is set to 20.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Return filtered indicators from ThreatStream. If query is defined,
      it overides all othe arguments that were passed to the command.
    execution: false
    name: threatstream-get-indicators
    outputs:
    - contextPath: ThreatStream.Indicators.IType
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.Indicators.Modified
      description: |-
        The time when the indicator was last updated on the ThreatStream. Format: YYYYMMDDThhmmss
        where T denotes the start of the value
        for time, in UTC time.
      type: String
    - contextPath: ThreatStream.Indicators.Confidence
      description: Level of certainty that an observable is of the reported indicator
        type.
      type: String
    - contextPath: ThreatStream.Indicators.Value
      description: The indicator value.
      type: String
    - contextPath: ThreatStream.Indicators.Status
      description: The indicator status.
      type: String
    - contextPath: ThreatStream.Indicators.Organization
      description: Registered owner (organization) of the IP address associated with
        the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.Country
      description: Country associated with the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.Tags
      description: Tag assigned to the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.Source
      description: The source of the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.ID
      description: The ID of the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.ASN
      description: Autonomous System (AS) number associated with the indicator.
      type: String
    - contextPath: ThreatStream.Indicators.Severity
      description: The Severity assigned to the indicator.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      defaultValue: intelligence
      description: The type of Threat Model entity on which to add the tag. By default
        is set to intelligence (indicator).
      isArray: false
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - intelligence
      - signature
      - tipreport
      - ttp
      - vulnerability
      required: false
      secret: false
    - default: false
      description: 'Comma separated tags applied to the specified threat model entities
        or observable. '
      isArray: true
      name: tags
      required: true
      secret: false
    - default: false
      description: The ID of the model to add the tag.
      isArray: false
      name: model_id
      required: true
      secret: false
    deprecated: false
    description: Add tags to intelligence for purposes of filtering for related entities.
    execution: false
    name: threatstream-add-tag-to-model
  - arguments:
    - auto: PREDEFINED
      default: false
      description: The type of threat model that will be created
      isArray: false
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - ttp
      - vulnerability
      - tipreport
      required: true
      secret: false
    - default: false
      description: The name of the Threat Model to be created
      isArray: false
      name: name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'false'
      description: The scope of Threat Model visibility
      isArray: false
      name: is_public
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: red
      description: Traffic Light Protocol designation for the Threat Model
      isArray: false
      name: tlp
      predefined:
      - red
      - amber
      - green
      - white
      required: false
      secret: false
    - default: false
      description: Comma separated values of tags
      isArray: false
      name: tags
      required: false
      secret: false
    - default: false
      description: Comma separated indicators IDs associated with the Threat Model
        on the ThreatStream platform
      isArray: false
      name: intelligence
      required: false
      secret: false
    - default: false
      description: The description of the Threat Model
      isArray: false
      name: description
      required: false
      secret: false
    deprecated: false
    description: Creates a Threat Model with specific parameters.
    execution: false
    name: threatstream-create-model
    outputs:
    - contextPath: ThreatStream.CreatedModel.ID
      description: The ID of created Threat Model.
      type: String
    - contextPath: ThreatStream.CreatedModel.Model
      description: The Threat Model type of created model.
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: The type of threat model that should be updated.
      isArray: false
      name: model
      predefined:
      - actor
      - campaign
      - incident
      - ttp
      - vulnerability
      - tipreport
      required: true
      secret: false
    - default: false
      description: The id of Threat Model that should be updated.
      isArray: false
      name: model_id
      required: true
      secret: false
    - default: false
      description: The name of the Threat Model to be updated.
      isArray: false
      name: name
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'false'
      description: The scope of Threat Model visibility.
      isArray: false
      name: is_public
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: red
      description: Traffic Light Protocol designation for the Threat Model.
      isArray: false
      name: tlp
      predefined:
      - red
      - amber
      - green
      - white
      required: false
      secret: false
    - default: false
      description: Comma separated values of tags.
      isArray: false
      name: tags
      required: false
      secret: false
    - default: false
      description: Comma separated indicators IDs associated with the Threat Model
        on the ThreatStream platform.
      isArray: false
      name: intelligence
      required: false
      secret: false
    - default: false
      description: The description of the Threat Model.
      isArray: false
      name: description
      required: false
      secret: false
    deprecated: false
    description: Updates a Threat Model with specific parameters. If one or more optional
      parameters are definde, the command overides previous data stored in ThreatStream.
    execution: false
    name: threatstream-update-model
  - arguments:
    - auto: PREDEFINED
      default: false
      defaultValue: default
      description: 'The type of sanbox. Possible values: default or premium.'
      isArray: false
      name: sandbox_type
      predefined:
      - default
      - premium
      required: false
      secret: false
    deprecated: false
    description: Returns list of supported platforms for default or premium sandbox.
    execution: false
    name: threatstream-supported-platforms
    outputs:
    - contextPath: ThreatStream.PremiumPlatforms.Name
      description: Name of supported platfrom for premium sadnbox.
      type: String
    - contextPath: ThreatStream.PremiumPlatforms.Types
      description: Type of supported submissions for premium sanbox.
      type: String
    - contextPath: ThreatStream.PremiumPlatforms.Label
      description: The display name of supported platform of premium sandbox.
      type: String
    - contextPath: ThreatStream.DefaultPlatforms.Name
      description: Name of supported platfrom for standard sadnbox.
      type: String
    - contextPath: ThreatStream.DefaultPlatforms.Types
      description: Type of supported submissions for standard sanbox.
      type: String
    - contextPath: ThreatStream.DefaultPlatforms.Label
      description: The display name of supported platform of standard sandbox.
      type: String
  - arguments:
    - default: false
      description: The URL to check.
      isArray: false
      name: url
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: high
      description: If Severity is greater or equal than the threshold, then the ip
        will be considered malicious. By default is set to high.
      isArray: false
      name: threshold
      predefined:
      - low
      - medium
      - high
      - very-high
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'True'
      description: Include results with Inactive status. By default is set to True.
      isArray: false
      name: include_inactive
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Checks the reputation of the given URL.
    execution: false
    name: url
    outputs:
    - contextPath: DBotScore.Indicator
      description: The tested indicator.
      type: String
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: String
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score.
      type: String
    - contextPath: DBotScore.Score
      description: The actual score.
      type: Number
    - contextPath: URL.Data
      description: The URL of the indicator.
      type: String
    - contextPath: URL.Malicious.Vendor
      description: Vendor reporting malicious.
      type: String
    - contextPath: ThreatStream.URL.Modified
      description: |-
        Time when the indicator was last updated. The date format is: YYYYMMDDThhmmss.
        Where T denotes the start of the value
        for time, in UTC time.
      type: String
    - contextPath: ThreatStream.URL.Confidence
      description: |-
        Level of certainty that an observable is of the reported indicator type. Confidence score can range from 0-100, in increasing order of
        confidence.
      type: String
    - contextPath: ThreatStream.URL.Status
      description: The status of the indicator.
      type: String
    - contextPath: ThreatStream.URL.Organization
      description: Name of the business that owns the IP address associated with the
        indicator.
      type: String
    - contextPath: ThreatStream.URL.Address
      description: URL of the indicator.
      type: String
    - contextPath: ThreatStream.URL.Country
      description: Country associated with the indicator.
      type: String
    - contextPath: ThreatStream.URL.Type
      description: The indicator type.
      type: String
    - contextPath: ThreatStream.URL.Source
      description: The source of the indicator.
      type: String
    - contextPath: ThreatStream.URL.Severity
      description: 'The indicator severity. Possible values: very-high, high, medium,
        low.'
      type: String
  dockerimage: demisto/python3:3.7.3.221
  isfetch: false
  runonce: false
  script: '-'
  type: python
tests:
  - 'ThreatStream-Test'