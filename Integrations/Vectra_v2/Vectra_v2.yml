commonfields:
  id: Vectra v2
  version: -1
name: Vectra v2
display: Vectra v2
category: Network Security
description: Automated attacker behavior analytics
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: API Token
  name: token
  defaultvalue: ""
  type: 4
  required: true
- defaultvalue: '0'
  display: Fetch only Detections with greater/equal Certainty score
  name: c_score_gte
  required: false
  type: 0
- defaultvalue: '0'
  display: Fetch only Detections with greater/equal Threat score
  name: t_score_gte
  required: false
  type: 0
- defaultvalue: '20'
  display: The number of results returned in each fetch
  name: fetch_size
  required: false
  type: 0
- display: Fetch incidents
  name: isFetch
  defaultvalue: ""
  type: 8
  required: false
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Incident type
  name: incidentType
  defaultvalue: ""
  type: 13
  required: false
- display: Use system proxy
  name: proxy
  defaultvalue: ""
  type: 8
  required: false
script:
  script: ''
  type: python
  subtype: python3
  commands:
  - name: vectra-get-detections
    arguments:
    - name: detection_id
      description: Filter by detection ID
    - name: fields
      description: Filters objects listed
    - name: page
      description: Page number. Possible values are a positive integer or last
    - name: page_size
      description: Page size. Possible values are a positive integer or all
    - name: ordering
      description: Orders records by last timestamp, threat score and certainty score.
        The default out sorts threat and certainty score in ascending order. Scores
        can sorted in descending order by prepending the query with “minus” symbol
    - name: min_id
      description: '>= the id provided'
    - name: max_id
      description: <= the id provided
    - name: state
      description: 'filter by state: active, inactive, ignored, ignored for all'
    - name: type_vname
      description: filter by the detection type (verbose name)
    - name: category
      description: filter by the detection category
    - name: src_ip
      description: filter by source (ip address)
    - name: t_score
      description: filter by threat score
    - name: t_score_gte
      description: filter by threat score >= the score provided
    - name: c_score
      description: filter by certainty score
    - name: c_score_gte
      description: filter by certainty score >= the score provided
    - name: last_timestamp
      description: filter by last timestamp
    - name: host_id
      description: filter by id of the host object a detection is attributed to
    - name: tags
      description: filter by a tag or a comma-separated list of tags
    - name: destination
      description: filter by destination in the detection detail set
    - name: proto
      description: filter by the protocol in the detection detail set
    - name: dst_port
      description: filter by the destination port in the detection detail set
    - name: inbound_ip
      description: filter by the inbound_ip in the relayed comm set
    - name: inbound_proto
      description: filter by the inbound_proto in the relayed comm set
    - name: inbound_port
      description: filter by the inbound_port in the relayed comm set
    - name: inbound_dns
      description: filter by the inbound_dns in the relayed comm set
    - name: outbound_ip
      description: filter by the outbound_ip in the relayed comm set
    - name: outbound_proto
      description: filter by the outbound_proto in the relayed comm set
    - name: outbound_port
      description: filter by the outbound_port in the relayed comm set
    - name: outbound_dns
      description: filter by the outbound_dns in the relayed_comm_set
    - name: dns_ip
      description: filter by the dns_ip in the dns_set
    - name: dns_request
      description: filter by the dns_request in the dns_set
    - name: resp_code
      description: filter by the resp_code in the dns_set
    - name: resp
      description: filter by the resp in the dns_set
    outputs:
    - contextPath: Vectra.Detection.Category
      description: 'The category of the vname attack detected'
      type: String
    - contextPath: Vectra.Detection.TargetsKeyAsset
      description: 'Flag indicating if the host has a detection targeting a key asset'
      type: Boolean
    - contextPath: Vectra.Detection.Certainty_Score
      description: 'The current certainty score correlated to this host'
      type: Number
    - contextPath: Vectra.Detection.ID
      description: 'Object ID'
      type: Number
    - contextPath: Vectra.Detection.FirstTimestamp
      description: 'The timestamp when the event was first detected'
      type: String
    - contextPath: Vectra.Detection.LastTimestamp
      description: 'The timestamp when the event was last detected'
      type: String
    - contextPath: Vectra.Detection.State
      description: 'The state of the detection'
      type: String
    - contextPath: Vectra.Detection.Threat_Score
      description: 'The threat score attributed to the detection'
      type: Number
    - contextPath: Vectra.Detection.SourceIP
      description: 'The source IP address of the host attributed to the security event'
      type: String
    - contextPath: Vectra.Detection.SourceAccount
      description: 'A dictionary with fields that describe the Account the detection is from'
    description: Detection objects contain all the information related to security
      events detected on the network
  - name: vectra-get-hosts
    arguments:
    - name: host_id
      description: Filter by host ID
    - name: fields
      description: Filters objects listed
    - name: page
      description: Page number. Possible values are a positive integer or last
    - name: page_size
      description: Page size. Possible values are a positive integer or all
    - name: ordering
      description: Orders records by last timestamp, threat score and certainty score.
        The default out sorts threat and certainty score in ascending order. Scores
        can sorted in descending order by prepending the query with “minus” symbol
    - name: name
      description: filter by name
    - name: state
      description: 'filter by state: active, inactive, suspended, ignored, ignored4all'
    - name: last_source
      description: filter by last_source (ip address)
    - name: t_score
      description: filter by threat score
    - name: t_score_gte
      description: filter by threat score >= the score provided
    - name: c_score
      description: filter by certainty score
    - name: c_score_gte
      description: filter by certainty score >= the score provided
    - name: last_detection_timestamp
      description: filter by last_detection_timestamp
    - name: tags
      description: filter by a tag or a comma-separated list of tags (returns hosts
        that contain any of the tags specified), e.g.tags=baz | tags=foo,bar"
    - name: key_assest
      description: 'filter by key asset: True, False'
    - name: mac_address
      description: filter by mac address
    outputs:
    - contextPath: Vectra.Host.Name
      description: 'The learned hostname'
      type: String
    - contextPath: Vectra.Host.TargetsKeyAsset
      description: 'Flag indicating if the host has a detection targeting a key asset'
      type: Boolean
    - contextPath: Vectra.Host.Certainty_Score
      description: 'The current certainty score correlated to this host'
      type: Number
    - contextPath: Vectra.Host.DetectionID
      description: 'List of Detections for Account'
      type: String
    - contextPath: Vectra.Host.KeyAsset
      description: 'Flag indicating if the host is a key asset'
      type: Boolean
    - contextPath: Vectra.Host.State
      description: 'The state of this host'
      type: String
    - contextPath: Vectra.Host.Threat_Score
      description: 'The current threat score correlated to this host'
      type: Number
    - contextPath: Vectra.Host.LastDetection
      description: 'Last detection activity from this host (Timestamp format: YYYY-MM-DD HH-MM-SS GMT)'
      type: String
    - contextPath: Vectra.Host.IP
      description: 'Last source IP associated with this host'
      type: String
    - contextPath: Vectra.Host.ID
      description: 'ID of the Host'
      type: Number
    description: Host information includes data that correlates the host data to detected
      security events
  - name: vectra-triage
    arguments: []
    outputs:
    - contextPath: Vectra.Rule.ID
      description: The record id
    - contextPath: Vectra.Rule.SmartCategory
      description: Custom Triage label used to recategorize specified detections
    - contextPath: Vectra.Rule.Description
      description: Name of Triage filter
    - contextPath: Vectra.Rule.Type
      description: Original detection type
    - contextPath: Vectra.Rule.Category
      description: Original detection category
    - contextPath: Vectra.Rule.Created
      description: The timestamp when this Triage filter was created
    - contextPath: Vectra.Rule.LastUpdate
      description: The timestamp when this Triage filter was triggered
    - contextPath: Vectra.Rule.Host.ID
      description: Host(s) that this Triage filter applies to
    - contextPath: Vectra.Rule.IP
      description: Host IP
    - contextPath: Vectra.Rule.Priority
      description: Used in ordering execution of Triage filters
    - contextPath: Vectra.Rule.Remote.IP
      description: Destination IP where this Triage filter will be applied to
    - contextPath: Vectra.Rule.Remote.Protocol
      description: Destination protocol where this Triage filter will be applied to
    - contextPath: Vectra.Rule.Remote.Port
      description: Destination port where this Triage filter will be applied to
    - contextPath: Vectra.Rule.Remote.DNS
      description: Destination FQDN where this Triage filter will apply to
    - contextPath: Vectra.Rule.Remote.Kerberos.Account
      description: Kerberos Account
    - contextPath: Vectra.Rule.Remote.Kerberos.Service
      description: Kerberos Service
    description: The rules branch can be used to retrieve a listing of configured
      Triage rules
  - name: vectra-get-host-by-id
    arguments:
    - name: host_id
      required: true
      default: true
      description: The id of the required host
    description: Get host by id
  - name: vectra-get-detetctions-by-id
    arguments:
    - name: detection_id
      description: The id of the required detection
    description: Get detections by host id
  - name: vectra-get-users
    arguments: []
  - name: vectra-get-proxies
    arguments: []
    outputs:
    - contextPath: Vectra.Proxy.Source
      description: 'Whether the proxy was auto detected by Cognito or was added by user'
      type: String
    - contextPath: Vectra.Proxy.ID
      description: 'The ID of the Proxy'
      type: String
    - contextPath: Vectra.Proxy.Source
      description: 'Whether the proxy was auto detected by Cognito or was added by user'
      type: String
    - contextPath: Vectra.Proxy.ConsidersProxy
      description: 'Whether to consider the object as a proxy or not'
      type: String
    - contextPath: Vectra.Proxy.Address
      description: 'The proxy IP address'
      type: String
    description: Retrieves the current list of proxy IP addresses
  - name: vectra-get-threatfeed
    arguments: []
    outputs:
    - contextPath: Vectra.ThreatFeed.Category
      description: 'The category in which the detection will fire if a match is observed with any indicator in the ThreatFeed'
      type: String
    - contextPath: Vectra.ThreatFeed.Name
      description: 'The name of the ThreatFeed'
      type: String
    - contextPath: Vectra.ThreatFeed.Certainty
      description: 'The default certainty to use for indicators in the STIX file'
      type: String
    - contextPath: Vectra.ThreatFeed.IndicatorType
      description: 'The default indicatorType to use for the observables in the STIX file'
      type: String
    - contextPath: Vectra.ThreatFeed.Duration
      description: 'The default duration for which indicators in the ThreatFeed are valid'
      type: Number
    - contextPath: Vectra.ThreatFeed.ID
      description: 'The ID of the ThreatFeed'
      type: String
  - name: vectra-search
    arguments:
    - name: query_string
      required: true
    - name: search_type
      required: true
      auto: PREDEFINED
      predefined:
      - hosts
      - detections
  isfetch: true
  dockerimage: demisto/python3:3.7.4.2245
tests:
  - No test