category: Endpoint
commonfields:
  id: BeyondTrust_Password_Safe
  version: -1
configuration:
- defaultvalue:
  display: Server URL
  name: url
  required: true
  type: 0
- defaultvalue: 'true'
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- display: Username
  name: credentials
  required: true
  type: 9
- name: api_key
  required: false
  type: 9
description: Unified Password and Session Management for Seamless Accountability and
  Control over Privileged Accounts
display: BeyondTrust_Password_Safe
name: BeyondTrust_Password_Safe
script:
  commands:
  - deprecated: false
    description: Returns a list of Managed Accounts requestable by the current user.
    execution: false
    name: beyondtrust-get-managed-accounts
    outputs:
    - contextPath: BeyondTrust.Account.PlatformId
      description: ID of the Managed System Platform.
      type: Number
    - contextPath: BeyondTrust.Account.SystemId
      description: ID of the Managed System.
      type: Number
    - contextPath: BeyondTrust.Account.SystemName
      description: Name of the Managed System.
      type: String
    - contextPath: BeyondTrust.Account.DomainName
      description: 'ID of the Managed Account. '
      type: Number
    - contextPath: BeyondTrust.Account.AccountName
      description: Name of the Managed Account.
      type: String
    - contextPath: BeyondTrust.Account.InstanceName
      description: 'Database instance name of a database-type Managed System. '
      type: String
    - contextPath: BeyondTrust.Account.DefualtReleaseDuration
      description: Default release duration.
      type: Number
    - contextPath: BeyondTrust.Account.MaximumReleaseDuration
      description: Maximum release duration.
      type: Number
    - contextPath: BeyondTrust.Account.LastChangeDate
      description: The date and time of the last password change.
      type: Date
    - contextPath: BeyondTrust.Account.NexeChangeDate
      description: The date and time of the next scheduled password change
      type: Date
    - contextPath: BeyondTrust.Account.IsChanging
      description: True if the account credentials are in the process of changing,
        otherwise false.
      type: Boolean
    - contextPath: BeyondTrust.Account.IsISAAccess
      description: 'True if the account is for Information Systems Administrator (ISA)
        access, otherwise false. '
      type: Boolean
    - contextPath: BeyondTrust.Account.AccountId
      description: 'ID of the Managed Account. '
      type: Number
  - arguments:
    - default: false
      isArray: false
      required: false
      secret: false
    deprecated: false
    description: Returns a list of Managed Systems.
    execution: false
    name: beyondtrust-get-managed-systems
    outputs:
    - contextPath: BeyondTrust.System.Port
      description: The port used to connect to the host. If null and the related Platform.PortFlag
        is true, Password Safe uses Platform.DefaultPort for communication.
      type: Number
    - contextPath: BeyondTrust.System.Timeout
      description: Connection timeout – Length of time in seconds before a slow or
        unresponsive connection to the system fails(seconds).
      type: String
    - contextPath: BeyondTrust.System.ResetPasswordOnMismatchFlag
      description: 'True to queue a password change when scheduled password test
        fails, otherwise false.'
      type: Boolean
    - contextPath: BeyondTrust.System.ChangeFrequencyDays
      description: When ChangeFrequencyType is “xdays”, password changes take place
        this configured number of days (days:1-90)
      type: Number
    - contextPath: BeyondTrust.System.ISAReleaseDuration
      description: Default Information Systems Administrator (ISA) release duration.
      type: Number
    - contextPath: BeyondTrust.System.FunctionalAccountID
      description: ID of the Functional Account used for local Managed Account password
        changes.
      type: Number
    - contextPath: BeyondTrust.System.ChangeFrequencyType
      description: 'The change frequency for scheduled password changes: first – Changes
        scheduled for the first day of the month last – Changes scheduled for the
        last day of the month xdays – Changes scheduled every x days (see ChangeFrequencyDays)'
      type: String
    - contextPath: BeyondTrust.System.DirectoryID
      description: Directory ID; set if the Managed System is a Directory.
      type: Number
    - contextPath: BeyondTrust.System.ManagedSystemID
      description: ID of the Managed System.
      type: Number
    - contextPath: BeyondTrust.System.AssetID
      description: Asset ID; set if the Managed System is an Asset or a Database.
      type: Number
    - contextPath: BeyondTrust.System.PlatformID
      description: 'ID of the Managed System Platform.'
      type: Number
    - contextPath: BeyondTrust.System.ElevationCommand
      description: Elevation Command to use (sudo, pbrun, pmrun).
      type: String
    - contextPath: BeyondTrust.System.CheckPasswordFlag
      description: 'True to enable password testing, otherwise false.'
      type: Boolean
    - contextPath: BeyondTrust.System.CloudID
      description: Cloud System ID; set if the Managed System is a Cloud System.
      type: Number
    - contextPath: BeyondTrust.System.DSSKeyRuleID
      description: 'ID of the default DSS Key Rule assigned to Managed Accounts created
        under this Managed System.'
      type: Number
    - contextPath: BeyondTrust.System.PasswordRuleID
      description: ID of the default Password Rule assigned to Managed Accounts created
        under this Managed System.
      type: Number
    - contextPath: BeyondTrust.System.NetBiosName
      description: Domain NetBIOS name. Setting this value will allow Password Safe
        to fall back to the NetBIOS name if needed.
      type: String
    - contextPath: BeyondTrust.System.DatabaseID
      description: 'Database ID; set if the Managed System is a Database.'
      type: Number
    - contextPath: BeyondTrust.System.MaxReleaseDuration
      description: 'Default maximum release duration.'
      type: Number
    - contextPath: BeyondTrust.System.ChangePasswordAfterAnyReleaseFlag
      description: 'True to change passwords on release of a request, otherwise false.'
      type: Boolean
    - contextPath: BeyondTrust.System.SystemName
      description: Name of the related entity (Asset, Directory, Database, or Cloud).
      type: String
    - contextPath: BeyondTrust.System.ReleaseDuration
      description: Default release duration.
      type: Number
    - contextPath: BeyondTrust.System.ContactEmail
      type: String
    - contextPath: BeyondTrust.System.Description
      description: The description of the system
      type: String
    - contextPath: BeyondTrust.System.ChangeTime
      description: 'UTC time of day scheduled password changes take place.'
      type: String
    - contextPath: BeyondTrust.System.AutoManagementFlag
      description: 'True if password auto-management is enabled, otherwise false.'
      type: Boolean
    - contextPath: BeyondTrust.System.LoginAccountID
      description: 'ID of the Functional Account used for SSH Session logins.'
      type: Number
  - arguments:
    - auto: PREDEFINED
      default: false
      description: The type of access requested (View, RDP, SSH). The defualt is View.
      isArray: false
      name: access_type
      predefined:
      - View
      - RDP
      - SSH
      required: false
      secret: false
    - default: false
      description: ID of the Managed System to request
      isArray: false
      name: system_id
      required: true
      secret: false
    - default: false
      description: ID of the Managed Account to request
      isArray: false
      name: account_id
      required: true
      secret: false
    - default: false
      description: The request duration (in minutes)
      isArray: false
      name: duration_minutes
      required: true
      secret: false
    - default: false
      description: The reason for the request
      isArray: false
      name: reason
      required: false
      secret: false
    - default: false
      description: The Schedule ID of an Access Policy to use for the request. If
        omitted, automatically selects the best schedule.
      isArray: false
      name: access_policy_schedule_id
      required: false
      secret: false
    - default: false
      description: The conflict resolution option to use if an existing request is
        found for the same user, system, and account (reuse, renew).
      isArray: false
      name: conflict_option
      required: false
      secret: false
    deprecated: false
    description: Creates a new credentials release request.
    execution: false
    name: beyondtrust-create-release-request
  - arguments:
    - default: false
      description: ID of the Request to approve
      isArray: false
      name: request_id
      required: true
      secret: false
    - default: false
      description: A reason or comment why the request is being approved
      isArray: false
      name: reason
      required: false
      secret: false
    deprecated: false
    description: Approve a pending release request
    execution: false
    name: beyondtrust-approve-release-request
  - arguments:
    - default: false
      description: ID of the Request to release
      isArray: false
      name: request_id
      required: true
      secret: false
    - default: false
      description: A reason or comment why the request is being released
      isArray: false
      name: reason
      required: false
      secret: false
    deprecated: false
    description: Checks-in/releases a request before it has expired.
    execution: false
    name: beyondtrust-check-in-credentials
  - arguments:
    - default: false
      description: ID of the account for which to set the credentials
      isArray: false
      name: account_id
      required: true
      secret: false
    - default: false
      description: The new password to set - if not given, generates a new random
        password.
      isArray: false
      name: password
      required: false
      secret: false
    - default: false
      description: The new public key to set on the host. (required if PrivateKey
        is given and updateSystem=true)
      isArray: false
      name: public_key
      required: false
      secret: false
    - default: false
      description: 'The private key to set (provide Passphrase if encrypted)'
      isArray: false
      name: private_key
      required: false
      secret: false
    - default: false
      description: The passphrase to use for an encrypted private key
      isArray: false
      name: pass_phrase
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'true'
      description: Whether to update the credentials on the referenced system
      isArray: false
      name: update_system
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    deprecated: false
    description: Updates the credentials for a Managed Account, optionally applying
      the change to the Managed System.
    execution: false
    name: beyondtrust-change-credentials
  isfetch: false
  runonce: false
  script: '-'
  type: python
releaseNotes: "New integration - BeyondTrust Password Safe"
tests:
  - no tests