category: Network Security
commonfields:
  id: Perch
  version: -1
configuration:
- defaultvalue: https://api.perch.rocks/
  display: Server URL (e.g. https://api.perch.rocks/)
  name: url
  required: true
  type: 0
- display: API Token
  name: api-key
  required: true
  type: 4
- defaultvalue: 'true'
  display: Trust any certificate (unsecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- defaultvalue: '7'
  display: Previous days to fetch
  name: fetch_time
  required: false
  type: 0
- display: Credentials
  name: credentials
  required: false
  type: 9
- defaultvalue: v1
  display: API Version
  name: version
  required: true
  type: 0
description: Perch is a co-managed threat detection and response platform.
display: Perch
name: Perch
script:
  commands:
  - arguments:
    - default: false
      description: Page of results to return
      isArray: false
      name: page
      required: false
      secret: false
    - default: false
      description: Results per page.
      isArray: false
      name: page_size
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Alert is closed.
      isArray: false
      name: closed
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      description: Time Alert was closed.
      isArray: false
      name: closed_at
      required: false
      secret: false
    - default: false
      description: Community ID that generated the Alert.
      isArray: false
      name: community_id
      required: false
      secret: false
    - default: false
      description: Time Alert was created.
      isArray: false
      name: created_at
      required: false
      secret: false
    - default: false
      description: IP Address of Destination.
      isArray: false
      name: dest_ip
      required: false
      secret: false
    - default: false
      description: Port of Destination.
      isArray: false
      name: dest_port
      required: false
      secret: false
    - default: false
      description: Full URL of Alert.
      isArray: false
      name: full_url
      required: false
      secret: false
    - default: false
      description: ID of Alert.
      isArray: false
      name: id
      required: false
      secret: false
    - default: false
      description: ID of Indicator.
      isArray: false
      name: indicator_id
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Is indicator loaded?
      isArray: false
      name: indicator_loaded
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      description: Observable ID.
      isArray: false
      name: observable_id
      required: false
      secret: false
    - default: false
      description: Protocol effected by Alert.
      isArray: false
      name: protocol
      required: false
      secret: false
    - default: false
      description: ID of sensor generating Alert.
      isArray: false
      name: sensor_id
      required: false
      secret: false
    - default: false
      description: Name of sensor generating Alert.
      isArray: false
      name: sensor_name
      required: false
      secret: false
    - default: false
      description: Status within the SOC.
      isArray: false
      name: soc_status
      required: false
      secret: false
    - default: false
      description: IP Address of source.
      isArray: false
      name: src_ip
      required: false
      secret: false
    - default: false
      description: Port of Source.
      isArray: false
      name: src_port
      required: false
      secret: false
    - default: false
      description: Status of Alert.
      isArray: false
      name: status
      required: false
      secret: false
    - default: false
      description: Time status was last updated.
      isArray: false
      name: status_updated_at
      required: false
      secret: false
    - default: false
      description: ID of team generating the Alert.
      isArray: false
      name: team_id
      required: false
      secret: false
    - default: false
      description: Title of Alert.
      isArray: false
      name: title
      required: false
      secret: false
    - default: false
      description: Timestamp of Alert.
      isArray: false
      name: ts
      required: false
      secret: false
    - default: false
      description: Ordering of Alerts returned.
      isArray: false
      name: ordering
      required: false
      secret: false
    deprecated: false
    description: Searches for Alerts in Perch.
    execution: false
    name: perch-search-alerts
    outputs:
    - contextPath: Perch.Alert.DestPort
      description: Destination port of alert.
      type: Number
    - contextPath: Perch.Alert.SrcPort
      description: Source port of alert.
      type: Number
    - contextPath: Perch.Alert.DestIP
      description: Destination IP of alert.
      type: Number
    - contextPath: Perch.Alert.IndicatorID
      description: Indicator ID of the alert.
      type: Number
    - contextPath: Perch.Alert.SrcIP
      description: IP Address of the source.
      type: String
    - contextPath: Perch.Alert.SrcGeo.Country
      description: Country of threat.
      type: String
    - contextPath: Perch.Alert.SrcGeo.Latitude
      description: Latitude of detected threat.
      type: Number
    - contextPath: Perch.Alert.SrcGeo.Longitude
      description: Longitude of detected threat.
      type: Number
    - contextPath: Perch.Alert.SensorID
      description: ID of sensor reporting the threat.
      type: Number
    - contextPath: Perch.Alert.Title
      description: Title of the alert.
      type: String
    - contextPath: Perch.Alert.Protocol
      description: Protocol the alert was detected on.
      type: String
    - contextPath: Perch.Alert.ID
      description: ID of the alert.
      type: Number
    - contextPath: Perch.Alert.ObservableID
      description: ID of observable event.
      type: Number
    - contextPath: Perch.Alert.TS
      description: Timestamp of alert.
      type: Date
  - arguments:
    - default: false
      description: ID of the Community.
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Gets community information by ID.
    execution: false
    name: perch-get-community
    outputs:
    - contextPath: Perch.Community.Allsectors
      description: Indicates if community covers all sectors.
      type: Boolean
    - contextPath: Perch.Community.Credentialreq
      description: Credentials required to interact with community.
      type: Number
    - contextPath: Perch.Community.Desc
      description: Description of community.
      type: String
    - contextPath: Perch.Community.Id
      description: ID of community.
      type: Number
    - contextPath: Perch.Community.Name
      description: Name of community.
      type: String
    - contextPath: Perch.Community.Poweredby
      description: Organization providing the feed.
      type: String
    - contextPath: Perch.Community.Selectablefeeds
      description: Are the Feeds selectable.
      type: Boolean
  - deprecated: false
    description: Lists all communities.
    execution: false
    name: perch-list-communities
    outputs:
    - contextPath: Perch.Community.Allsectors
      description: Indicates if community covers all sectors.
      type: Boolean
    - contextPath: Perch.Community.Credentialreq
      description: Credentials required to interact with community.
      type: Number
    - contextPath: Perch.Community.Desc
      description: Description of community.
      type: String
    - contextPath: Perch.Community.Id
      description: ID of community.
      type: Number
    - contextPath: Perch.Community.Name
      description: Name of community.
      type: String
    - contextPath: Perch.Community.Poweredby
      description: Organization providing the feed.
      type: String
    - contextPath: Perch.Community.Selectablefeeds
      description: Are the Feeds selectable.
      type: Boolean
  - arguments:
    - default: false
      description: Communities to report the indicator to.
      isArray: false
      name: communities
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Confidence of findings.
      isArray: false
      name: confidence
      predefined:
      - LOW
      - MEDIUM
      - HIGH
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Type of indicator.
      isArray: false
      name: type
      predefined:
      - IP
      - Domain
      - URL
      - REGEX
      - File Hash
      required: true
      secret: false
    - default: false
      description: Indicator's value.
      isArray: false
      name: value
      required: true
      secret: false
    - default: false
      description: Title for the indicator.
      isArray: false
      name: title
      required: true
      secret: false
    - default: false
      description: Description of the indicator.
      isArray: false
      name: description
      required: true
      secret: false
    - default: false
      description: TLP of the Indicator.
      isArray: false
      name: tlp
      required: true
      secret: false
    - default: false
      description: Operator of the indicator.
      isArray: false
      name: operator
      required: false
      secret: false
    - default: false
      description: When the indicator was first sighted.
      isArray: false
      name: first_sighting
      required: false
      secret: false
    - default: false
      description: Send a summary of the indicator via email.
      isArray: false
      name: email_summary
      required: false
      secret: false
    deprecated: false
    description: Creates an indicator in Perch.
    execution: false
    name: perch-create-indicator
    outputs:
    - contextPath: Perch.Indicator.Confidence
      description: Confidence of indicator.
      type: Unknown
    - contextPath: Perch.Indicator.UpdatedAt
      description: Time Indicator was last updated.
      type: Date
    - contextPath: Perch.Indicator.TLP
      description: TLP of the Indicator.
      type: String
    - contextPath: Perch.Indicator.Title
      description: Title of the indicator.
      type: String
    - contextPath: Perch.Indicator.ID
      description: ID of the indicator.
      type: Number
    - contextPath: Perch.Indicator.CreatedAt
      description: Date indicator was created.
      type: Date
    - contextPath: Perch.Indicator.Team
      description: ID of team.
      type: Number
    - contextPath: Perch.Indicator.PerchID
      description: ID given by perch of the incident.
      type: String
    - contextPath: Perch.Indicator.CreatedBy
      description: ID of incident's creator.
      type: Number
  dockerimage: demisto/python3:3.7.2.214
  isfetch: true
  runonce: false
  script: ''
  type: python
releaseNotes: Initial release of new Perch Integration
tests:
- Perch-Test
