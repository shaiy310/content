category: Forensics & Malware Analysis
commonfields:
  id: SNDBOX
  version: -1
configuration:
- display: Use Public API Key. (By approving SNDBOX public API you are accepting SNDBOX
    TOS @ https://app.sndbox.com/tos). Public submissions are shared with the community
  name: public_api_key
  required: false
  type: 8
- display: Private API Key
  name: api_key
  required: true
  type: 4
- defaultvalue: 'False'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Trust any certificate (unsecure)
  name: insecure
  required: false
  type: 8
- defaultvalue: '300'
  display: 'Max. Polling Time (in seconds):'
  name: maxpolls
  required: false
  type: 0
- display: Verbose (show log in case of error)
  name: verbose
  required: false
  type: 8
description: SNDBOX as a service
display: SNDBOX
name: SNDBOX
script:
  commands:
  - deprecated: false
    description: Check if SNDBOX is online or in maintenance mode.
    execution: false
    name: sndbox-is-online
  - arguments:
    - default: true
      description: Analysis IDs, supports comma-seperated arrays.
      isArray: true
      name: analysis_id
      required: true
      secret: false
    deprecated: false
    description: Show information about an analysis.
    execution: false
    name: sndbox-analysis-info
    outputs:
    - contextPath: SNDBOX.Analysis.ID
      description: Analysis ID
      type: string
    - contextPath: SNDBOX.Analysis.SampleName
      description: Sample Data
      type: string
    - contextPath: SNDBOX.Analysis.Status
      description: Analysis Status
      type: string
    - contextPath: SNDBOX.Analysis.Time
      description: Submitted Time
      type: date
    - contextPath: SNDBOX.Analysis.Score
      description: Analysis Score
      type: float
    - contextPath: SNDBOX.Analysis.Result
      description: Analysis Results
      type: string
    - contextPath: SNDBOX.Analysis.Errors
      description: Raised errors during sampling
      type: Unknown
    - contextPath: SNDBOX.Analysis.Link
      description: Analysis Link
      type: string
    - contextPath: SNDBOX.Analysis.MD5
      description: MD5 of analysis sample
      type: string
    - contextPath: SNDBOX.Analysis.SHA1
      description: SHA1 of analysis sample
      type: string
    - contextPath: SNDBOX.Analysis.SHA256
      description: SHA256 of analysis sample
      type: string
    - contextPath: DBotScore.Vendor
      description: 'The name of the vendor: SNDBOX'
      type: string
    - contextPath: DBotScore.Indicator
      description: The name of the sample file
      type: Unknown
    - contextPath: DBotScore.Type
      description: file
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
    - contextPath: DBotScore.Malicious.Vendor
      description: 'The name of the vendor: SNDBOX'
      type: string
    - contextPath: DBotScore.Malicious.Detections
      description: The sub analysis detection statuses
      type: string
    - contextPath: DBotScore.Malicious.SHA1
      description: The SHA1 of the file
      type: string
  - arguments:
    - default: true
      description: War Room entry of a file (for example, 3245@4)
      isArray: false
      name: file_id
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'False'
      description: Should the command poll for the result of the analysis
      isArray: false
      name: should_wait
      predefined:
      - 'True'
      - 'False'
      required: false
      secret: false
    deprecated: false
    description: Submit a sample for analysis.
    execution: false
    name: sndbox-analysis-submit-sample
    outputs:
    - contextPath: SNDBOX.Analysis.ID
      description: Analysis ID
      type: string
    - contextPath: SNDBOX.Analysis.SampleName
      description: Sample Data, could be a file name or URL
      type: string
    - contextPath: SNDBOX.Analysis.Status
      description: Analysis Status
      type: string
    - contextPath: SNDBOX.Analysis.Time
      description: Submitted Time
      type: date
    - contextPath: SNDBOX.Analysis.Result
      description: Analysis Results
      type: string
    - contextPath: SNDBOX.Analysis.Errors
      description: Raised errors during sampling
      type: Unknown
    - contextPath: SNDBOX.Analysis.Link
      description: Analysis Link
      type: string
    - contextPath: SNDBOX.Analysis.MD5
      description: MD5 of analysis sample
      type: string
    - contextPath: SNDBOX.Analysis.SHA1
      description: SHA1 of analysis sample
      type: string
    - contextPath: SNDBOX.Analysis.SHA256
      description: SHA256 of analysis sample
      type: string
    - contextPath: DBotScore.Vendor
      description: 'The name of the vendor: SNDBOX'
      type: string
    - contextPath: DBotScore.Indicator
      description: The name of the sample file or URL
      type: Unknown
    - contextPath: DBotScore.Type
      description: '''url'' for url samples, otherwise ''file'''
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
    - contextPath: DBotScore.Malicious.Vendor
      description: 'The name of the vendor: SNDBOX'
      type: string
    - contextPath: DBotScore.Malicious.SHA1
      description: The SHA1 of the file
      type: string
  - arguments:
    - default: true
      description: Analysis ID
      isArray: false
      name: analysis_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: json
      description: The resource type to download. Defaults to json.
      isArray: false
      name: type
      predefined:
      - json
      - pcap
      required: false
      secret: false
    deprecated: false
    description: Download a resource belonging to a report. This can be the full report,
      dropped binaries, etc.
    execution: false
    name: sndbox-download-report
    outputs:
    - contextPath: InfoFile.Name
      description: FileName
      type: string
    - contextPath: InfoFile.EntryID
      description: The EntryID of the report
      type: string
    - contextPath: InfoFile.Size
      description: File Size
      type: number
    - contextPath: InfoFile.Type
      description: File type e.g. "PE"
      type: string
    - contextPath: InfoFile.Info
      description: Basic information of the file
      type: string
    - contextPath: InfoFile.Extension
      description: File Extension
      type: string
  - arguments:
    - default: true
      description: Analysis ID
      isArray: false
      name: analysis_id
      required: true
      secret: false
    deprecated: false
    description: Download the sample file of an analysis. for security reasons, the
      extension will be "dontrun"
    execution: false
    name: sndbox-download-sample
    outputs:
    - contextPath: File.Size
      description: File Size
      type: number
    - contextPath: File.SHA1
      description: SHA1 hash of the file
      type: string
    - contextPath: File.SHA256
      description: SHA256 hash of the file
      type: string
    - contextPath: File.Name
      description: The sample name
      type: string
    - contextPath: File.SSDeep
      description: SSDeep hash of the file
      type: string
    - contextPath: File.EntryID
      description: War-Room Entry ID of the file
      type: string
    - contextPath: File.Info
      description: Basic information of the file
      type: string
    - contextPath: File.Type
      description: File type e.g. "PE"
      type: string
    - contextPath: File MD5
      description: MD5 hash of the file
      type: string
    - contextPath: File.Extension
      description: File Extension
      type: string
  isfetch: false
  runonce: false
  script: ''
  type: python
tests:
- SNDBOX_Test
