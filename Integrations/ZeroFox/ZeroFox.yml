category: Authentication
commonfields:
  id: ZeroFox
  version: -1
configuration:
- defaultvalue: 'true'
  display: Trust any certificate (insecure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- defaultvalue: 3 days
  display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  name: fetch_time
  required: false
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: https://api.zerofox.com/1.0 # disable-secrets-detection
  display: URL
  name: url
  required: true
  type: 0
description: Integration Template
display: ZeroFox
name: ZeroFox
script:
  commands:
  - arguments:
    - default: false
      description: ZeroFox alert ID
      isArray: false
      name: alert_id
      required: true
      secret: false
    deprecated: false
    description: Fetches an alert by ID
    execution: false
    name: zerofox-get-alert
    outputs:
    - contextPath: ZeroFox.Alert.AlertType
      type: String
    - contextPath: ZeroFox.Alert.OffendingContentURL
      type: String
    - contextPath: ZeroFox.Alert.AssetTerm.ID
      type: Number
    - contextPath: ZeroFox.Alert.AssetTerm.Name
      type: String
    - contextPath: ZeroFox.Alert.AssetTerm.Deleted
      type: Boolean
    - contextPath: ZeroFox.Alert.Assignee
      type: String
    - contextPath: ZeroFox.Alert.Entity.ID
      type: Number
    - contextPath: ZeroFox.Alert.Entity.Name
      type: String
    - contextPath: ZeroFox.Alert.Entity.Image
      type: String
    - contextPath: ZeroFox.Alert.EntityTerm.ID
      type: Number
    - contextPath: ZeroFox.Alert.EntityTerm.Name
      type: String
    - contextPath: ZeroFox.Alert.EntityTerm.Deleted
      type: Boolean
    - contextPath: ZeroFox.Alert.ContentCreatedAt
      type: String
    - contextPath: ZeroFox.Alert.ID
      type: Number
    - contextPath: ZeroFox.Alert.ProtectedAccount
      type: Unknown
    - contextPath: ZeroFox.Alert.Severity
      type: Number
    - contextPath: ZeroFox.Alert.Perpetrator.Name
      type: String
    - contextPath: ZeroFox.Alert.Perpetrator.URL
      type: String
    - contextPath: ZeroFox.Alert.Perpetrator.Timestamp
      type: String
    - contextPath: ZeroFox.Alert.Perpetrator.Type
      type: String
    - contextPath: ZeroFox.Alert.Perpetrator.ID
      type: Number
    - contextPath: ZeroFox.Alert.Perpetrator.Network
      type: String
    - contextPath: ZeroFox.Alert.RuleGroupID
      type: Unknown
    - contextPath: ZeroFox.Alert.Asset.ID
      type: Number
    - contextPath: ZeroFox.Alert.Asset.Name
      type: String
    - contextPath: ZeroFox.Alert.Asset.Image
      type: String
    - contextPath: ZeroFox.Alert.Status
      type: String
    - contextPath: ZeroFox.Alert.Timestamp
      type: String
    - contextPath: ZeroFox.Alert.RuleName
      type: String
    - contextPath: ZeroFox.Alert.LastModified
      type: String
    - contextPath: ZeroFox.Alert.ProtectedLocations
      type: Unknown
    - contextPath: ZeroFox.Alert.DarkwebTerm
      type: Unknown
    - contextPath: ZeroFox.Alert.Reviewed
      type: Boolean
    - contextPath: ZeroFox.Alert.Escalated
      type: Boolean
    - contextPath: ZeroFox.Alert.Network
      type: String
    - contextPath: ZeroFox.Alert.ProtectedSocialObject
      type: String
    - contextPath: ZeroFox.Alert.Notes
      type: String
    - contextPath: ZeroFox.Alert.RuleID
      type: Number
    - contextPath: ZeroFox.Alert.EntityAccount
      type: Unknown
    - contextPath: ZeroFox.Alert.Tags
      type: Unknown
  - arguments:
    - default: false
      description: The ID of the alert to be assigned.
      isArray: false
      name: alert_id
      required: true
      secret: false
    - default: false
      description: The email of the user to assign the alert to.
      isArray: false
      name: subject_email
      required: true
      secret: false
    - default: false
      description: The name of the user being assigned.
      isArray: false
      name: subject_name
      required: true
      secret: false
    deprecated: false
    description: Assigns an alert to a user
    execution: false
    name: zerofox-alert-user-assignment
  - arguments:
    - default: false
      description: ID of the alert being closed.
      isArray: false
      name: alert_id
      required: true
      secret: false
    deprecated: false
    description: Closes an alert
    execution: false
    name: zerofox-close-alert
  - arguments:
    - default: false
      isArray: false
      name: alert_id
      required: true
      secret: false
    deprecated: false
    description: Requests takedown of a specific alert
    execution: false
    name: zerofox-alert-request-takedown
  - arguments:
    - auto: PREDEFINED
      default: false
      defaultValue: 'true'
      description: true = add, false = remove.
      isArray: false
      name: action
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      description: Unique ID of the alert.
      isArray: false
      name: alert_id
      required: true
      secret: false
    - default: false
      description: |-
        A list of tags to be added/removed to/from the alert.
        Seperated by a comma, for example:
        tag1,tag2,tag3
      isArray: false
      name: tags
      required: true
      secret: false
    deprecated: false
    description: adds/removes tags to/from a specific alert
    execution: false
    name: zerofox-modify-alert-tags
  - arguments:
    - default: false
      description: Social network account number (unique ID)
      isArray: false
      name: account
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: CSV of alert types
      isArray: false
      name: alert_type
      predefined:
      - account_information
      - entity_discovery_content
      - entity_discovery_profile
      - impersonating_account
      - impersonating_comment
      - impersonating_post
      - incoming_comment
      - incoming_post
      - incoming_private_message
      - outgoing_private_message
      - self_comment
      - self_post
      - search_query
      - location
      - email
      required: false
      secret: false
    - default: false
      description: Name of user assigned to alert
      isArray: false
      name: assignee
      required: false
      secret: false
    - default: false
      description: ZeroFox entity ID
      isArray: false
      name: entity
      required: false
      secret: false
    - default: false
      description: ZeroFox entity term ID
      isArray: false
      name: entity_term
      required: false
      secret: false
    - default: false
      description: Number of seconds since an alert has changed
      isArray: false
      name: last_modified
      required: false
      secret: false
    - default: true
      defaultValue: '10'
      description: Maximum number of alerts to retrieve (0 - 100).
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: ISO-8601 date-time string to filter for alerts before
      isArray: false
      name: max_timestamp
      required: false
      secret: false
    - default: false
      description: ISO-8601 date-time string to filter for alerts after
      isArray: false
      name: min_timestamp
      required: false
      secret: false
    - default: false
      description: Network name csv
      isArray: false
      name: network
      required: false
      secret: false
    - default: false
      description: Used for pagination. Start response with n-th alert matching filters.
      isArray: false
      name: offset
      required: false
      secret: false
    - default: false
      description: ZeroFox page ID CSV
      isArray: false
      name: page_id
      required: false
      secret: false
    - default: false
      description: URL to Web/Social Web content
      isArray: false
      name: page_url
      required: false
      secret: false
    - default: false
      description: Encoded JSON array of strings to filter alerts by
      isArray: false
      name: pages
      required: false
      secret: false
    - default: false
      description: Social network post number (unique ID)
      isArray: false
      name: post
      required: false
      secret: false
    - default: false
      description: ZeroFox rule ID CSV
      isArray: false
      name: rule_id
      required: false
      secret: false
    - default: false
      description: ZeroFox rule name CSV
      isArray: false
      name: rule_name
      required: false
      secret: false
    - default: false
      description: Substring matching for the protected entity
      isArray: false
      name: entity_search
      required: false
      secret: false
    - default: false
      description: Substring to filter alerts by perpetrator username or display name
      isArray: false
      name: perpetrator_search
      required: false
      secret: false
    - default: false
      description: Substring to filter alerts by protected social object username,
        display name, or entity term name
      isArray: false
      name: pro_social_obj_search
      required: false
      secret: false
    - default: false
      description: CSV of alert IDs
      isArray: false
      name: alert_id
      required: false
      secret: false
    - default: false
      description: Severity level of alert. 1 - 5 (Critical).
      isArray: false
      name: severity
      required: false
      secret: false
    - default: false
      description: |-
        x ∈ { asc , desc }
        Sort results in ascending (asc) or descending (desc) order
      isArray: false
      name: sort_direction
      required: false
      secret: false
    - default: false
      description: |-
        x ∈ { alert_id , alert_status , alert_type , assigned_user , perpetrator , protected_entity , protected_social_object , rule , severity , social_network , timestamp , escalated }
        Field to sort filtered alerts by. Possible values are alert_id, alert_status, alert_type, assigned_user, perpetrator, protected_entity (name), protected_social_object (name), rule (name), severity, social_network and timestamp.
      isArray: false
      name: sort_field
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Alert status. Possible values are closed, open, takedown_accepted,
        takedown_denied, takedown_requested, and whitelisted.
      isArray: false
      name: status
      predefined:
      - closed
      - open
      - takedown_accepted
      - takedown_denied
      - takedown_requested
      - whitelisted
      required: false
      secret: false
    - default: false
      description: If true, returns only alerts that are escalated.
      isArray: false
      name: escalated
      required: false
      secret: false
    - default: false
      description: Alert tags. Returns any alerts containing one or more of the tags
        in provided comma separated list.
      isArray: false
      name: tags
      required: false
      secret: false
    deprecated: false
    description: Returns alerts matching given/default filters and parameters. By
      default, no filters are applied and results are sorted by timestamp.
    execution: false
    name: zerofox-list-alerts
    outputs:
    - contextPath: ZeroFox.Alert.AlertType
      type: String
    - contextPath: ZeroFox.Alert.OffendingContentURL
      type: String
    - contextPath: ZeroFox.Alert.AssetTerm.ID
      type: Number
    - contextPath: ZeroFox.Alert.AssetTerm.Name
      type: String
    - contextPath: ZeroFox.Alert.AssetTerm.Deleted
      type: Boolean
    - contextPath: ZeroFox.Alert.Assignee
      type: String
    - contextPath: ZeroFox.Alert.Entity.ID
      type: Number
    - contextPath: ZeroFox.Alert.Entity.Name
      type: String
    - contextPath: ZeroFox.Alert.Entity.Image
      type: String
    - contextPath: ZeroFox.Alert.EntityTerm.ID
      type: Number
    - contextPath: ZeroFox.Alert.EntityTerm.Name
      type: String
    - contextPath: ZeroFox.Alert.EntityTerm.Deleted
      type: Boolean
    - contextPath: ZeroFox.Alert.ContentCreatedAt
      type: String
    - contextPath: ZeroFox.Alert.ID
      type: Number
    - contextPath: ZeroFox.Alert.ProtectedAccount
      type: Unknown
    - contextPath: ZeroFox.Alert.Severity
      type: Number
    - contextPath: ZeroFox.Alert.Perpetrator.Name
      type: String
    - contextPath: ZeroFox.Alert.Perpetrator.URL
      type: String
    - contextPath: ZeroFox.Alert.Perpetrator.Timestamp
      type: String
    - contextPath: ZeroFox.Alert.Perpetrator.Type
      type: String
    - contextPath: ZeroFox.Alert.Perpetrator.ID
      type: Number
    - contextPath: ZeroFox.Alert.Perpetrator.Network
      type: String
    - contextPath: ZeroFox.Alert.RuleGroupID
      type: Unknown
    - contextPath: ZeroFox.Alert.Asset.ID
      type: Number
    - contextPath: ZeroFox.Alert.Asset.Name
      type: String
    - contextPath: ZeroFox.Alert.Asset.Image
      type: String
    - contextPath: ZeroFox.Alert.Status
      type: String
    - contextPath: ZeroFox.Alert.Timestamp
      type: String
    - contextPath: ZeroFox.Alert.RuleName
      type: String
    - contextPath: ZeroFox.Alert.LastModified
      type: String
    - contextPath: ZeroFox.Alert.ProtectedLocations
      type: Unknown
    - contextPath: ZeroFox.Alert.DarkwebTerm
      type: Unknown
    - contextPath: ZeroFox.Alert.Reviewed
      type: Boolean
    - contextPath: ZeroFox.Alert.Escalated
      type: Boolean
    - contextPath: ZeroFox.Alert.Network
      type: String
    - contextPath: ZeroFox.Alert.ProtectedSocialObject
      type: String
    - contextPath: ZeroFox.Alert.Notes
      type: String
    - contextPath: ZeroFox.Alert.RuleID
      type: Number
    - contextPath: ZeroFox.Alert.EntityAccount
      type: Unknown
  - arguments:
    - default: false
      description: Name of the entity (may be non-unique)
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: indicating type of string matching for comparing name to impersonators
      isArray: false
      name: strict_name_matching
      required: false
      secret: false
    - default: false
      description: profile image for entity
      isArray: false
      name: image
      required: false
      secret: false
    - default: false
      description: List of string labels for tagging the entity
      isArray: false
      name: labels
      required: false
      secret: false
    - default: false
      description: The ID of the policy to assign to the new entity
      isArray: false
      name: policy
      required: false
      secret: false
    - default: false
      description: organization name associated with entity
      isArray: false
      name: organization
      required: false
      secret: false
    deprecated: false
    description: Creates a new entity on the company of the authorized user.
    execution: false
    name: zerofox-create-entity
    outputs:
    - contextPath: ZeroFox.Entity
      description: Entity details
      type: Unknown
  - arguments:
    - default: false
      isArray: false
      name: alert_id
      required: true
      secret: false
    deprecated: false
    description: Cancels takedown of a specific alert
    execution: false
    name: zerofox-alert-cancel-takedown
  - arguments:
    - default: false
      isArray: false
      name: alert_id
      required: true
      secret: false
    deprecated: false
    description: Opens an alert'
    execution: false
    name: zerofox-open-alert
  dockerimage: demisto/python3:3.7.4.977
  isfetch: true
  runonce: false
  script: '-'
  type: python
tests:
- ZeroFox-Test
