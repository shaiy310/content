commonfields:
  id: ArcSight ESM
  version: -1
name: ArcSight ESM
display: ArcSight ESM
category: Analytics & SIEM
image: data:image/png;base64,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
description: ArcSight ESM SIEM by Micro Focus (Formerly HPE Software).
configuration:
- display: Server URL (e.g., https://192.168.0.1)
  name: server
  defaultvalue: ""
  type: 0
  required: true
- display: Port
  name: port
  defaultvalue: "8443"
  type: 0
  required: true
- display: Credentials
  name: credentials
  defaultvalue: ""
  type: 9
  required: true
- display: Fetch events as incidents via Query Viewer ID. Mandatory fields for query
    are "Start Time" and "Event ID".
  name: events_query_viewer_id
  defaultvalue: ""
  type: 0
  required: false
- display: Fetch cases as incidents via Query Viewer ID. Mandatory fields for query
    are "Create Time" and "ID".
  name: cases_query_viewer_id
  defaultvalue: ""
  type: 0
  required: false
- display: Fetch incidents
  name: isFetch
  defaultvalue: ""
  type: 8
  required: false
- display: Incident type
  name: incidentType
  defaultvalue: ""
  type: 13
  required: false
- display: Trust any certificate (unsecure)
  name: insecure
  defaultvalue: "true"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
- display: Trust any certificate (unsecure)
  name: insecure
  defaultvalue: "true"
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: "false"
  type: 8
  required: false
script:
  script: ''
  type: python
  commands:
  - name: as-get-all-cases
    arguments: []
    outputs:
    - contextPath: ArcSightESM.AllCaseIDs
      description: All case resource IDs
      type: Unknown
    description: (Deprecated) Retrieves all case resource IDs.
  - name: as-get-case
    arguments:
    - name: resourceId
      required: true
      default: true
      description: Resource ID of the case to get information for
    - name: withBaseEvents
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      description: If "true", then will return case and base events of that case
      defaultValue: "false"
    outputs:
    - contextPath: ArcSightESM.Cases.resourceid
      description: Case ID
      type: string
    - contextPath: ArcSightESM.Cases.name
      description: Case name
      type: string
    - contextPath: ArcSightESM.Cases.eventIDs
      description: Related base event IDs
      type: Unknown
    - contextPath: ArcSightESM.Cases.createdTimestamp
      description: Time the case was created (in milliseconds)
      type: number
    - contextPath: ArcSightESM.Cases.createdTime
      description: Created time (dd-mm-yyyyTHH:MM:SS.SSS timezone)
      type: string
    - contextPath: ArcSightESM.Cases.modifiedTimestamp
      description: Modified timestamp (in milliseconds)
      type: number
    - contextPath: ArcSightESM.Cases.modifiedTime
      description: Modified time (dd-mm-yyyyTHH:MM:SS.SSS timezone)
      type: date
    - contextPath: ArcSightESM.Cases.action
      description: Action (e.g., BLOCK_OR_SHUTDOWN)
      type: string
    - contextPath: ArcSightESM.Cases.associatedImpact
      description: Associated impact (e.g., AVAILABILITY)
      type: string
    - contextPath: ArcSightESM.Cases.attackAgent
      description: Attack agent (e.g., INSIDER)
      type: string
    - contextPath: ArcSightESM.Cases.attackMechanism
      description: Attack mechanism (e.g., PHYSICAL)
      type: string
    - contextPath: ArcSightESM.Cases.consequenceSeverity
      description: Consequence severity (e.g., NONE)
      type: string
    - contextPath: ArcSightESM.Cases.detectionTime
      description: Detection time (dd-mm-yyyyTHH:MM:SS.SSS timezone)
      type: date
    - contextPath: ArcSightESM.Cases.displayID
      description: Display ID
      type: number
    - contextPath: ArcSightESM.Cases.estimatedStartTime
      description: Estimated start time (dd-mm-yyyyTHH:MM:SS.SSS timezone)
      type: date
    - contextPath: ArcSightESM.Cases.eventIDs
      description: Base event IDs
      type: unknown
    - contextPath: ArcSightESM.Cases.frequency
      description: Frequency (e.g., NEVER_OR_ONCE)
      type: string
    - contextPath: ArcSightESM.Cases.history
      description: History (e.g., KNOWN_OCCURENCE)
      type: Unknown
    - contextPath: ArcSightESM.Cases.numberOfOccurences
      description: Number Of Occurences
      type: number
    - contextPath: ArcSightESM.Cases.resistance
      description: Resistance (e.g., HIGH)
      type: string
    - contextPath: ArcSightESM.Cases.securityClassification
      description: Security Classification (e.g., UNCLASSIFIED)
      type: string
    - contextPath: ArcSightESM.Cases.sensitivity
      description: Sensitivity (e.g., UNCLASSIFIED)
      type: string
    - contextPath: ArcSightESM.Cases.stage
      description: Stage (e.g., QUEUED,INITIAL,FOLLOW_UP,FINAL,CLOSED)
      type: string
    - contextPath: ArcSightESM.Cases.ticketType
      description: Ticket type (e.g., INTERNAL,CLIENT,INCIDENT)
      type: string
    - contextPath: ArcSightESM.Cases.vulnerability
      description: Vulnerability (e.g., DESIGN)
      type: string
    description: Gets information about a single case.
  - name: as-get-matrix-data
    arguments:
    - name: id
      required: true
      default: true
      description: Resource ID of a query viewer
    - name: onlyColumns
      description: If "true", will return only the columns of the query. If "false", will return the column headers and all query results.
      auto: PREDEFINED
      predefined:
      - "true"
      - "false"
      defaultValue: "true"
    description: Retrieves query viewer results (query viewer must be configured to
      be refreshed every minute, see documentation)
  - name: as-add-entries
    arguments:
    - name: resourceId
      required: true
      description: Resource ID of the Active List
    - name: entries
      required: true
      description: 'Entries are in JSON format. JSON must be an array of entries. Each entry
        must contain the same columns as they appear in the Active List, e.g., [{ "UserName":
        "john", "IP":"19.12.13.11"},{ "UserName": "bob", "IP":"22.22.22.22"}]'
      isArray: true
    description: Adds new entries to the Active List.
    execution: true
  - name: as-clear-entries
    arguments:
    - name: resourceId
      description: Resource ID of a specific Active List
      required: true
    description: Deletes all entries in the Active List.
    execution: true
  - name: as-get-entries
    arguments:
    - name: resourceId
      description: Resource ID of a specific Active List
      required: true
    - name: entryFilter
      description: 'Filters the entries, e.g., entryFilter="moo:moo1"'
    outputs:
    - contextPath: ArcSightESM.ActiveList
      description: Active List is a map of active list resource id => active list
        entries
      type: Unknown
    - contextPath: ArcSightESM.ActiveList.ListID
      description: The ActiveList ID
      type: list
    - contextPath: ArcSightESM.ActiveList.Entry
      description: Active List is a map of active list resource id => active list
      type: Unknown
    description: Returns all entries in the Active List
  - name: as-get-security-events
    arguments:
    - name: ids
      description: 'ID or multiple ids separated by comma of security events. Event ID is ArcSight is always a number. Example: 13906590'
      required: true
      isArray: true
    - name: lastDateRange
      description: 'Query last events. Format follows ''number date_range_unit'', e.g., 2 hours, 4 minutes, 6 month, 1 day'
    outputs:
    - contextPath: ArcSightESM.SecurityEvents
      description: List of security events
      type: Unknown
    - contextPath: ArcSightESM.SecurityEvents.name
      description: Event name
      type: string
    - contextPath: ArcSightESM.SecurityEvents.eventId
      description: Event ID
      type: number
    - contextPath: ArcSightESM.SecurityEvents.type
      description: Event type (e.g., CORRELATION)
      type: string
    - contextPath: ArcSightESM.SecurityEvents.baseEventIds
      description: Base event IDs
      type: Unknown
    - contextPath: ArcSightESM.SecurityEvents.source.address
      description: Event source address
      type: Unknown
    - contextPath: ArcSightESM.SecurityEvents.destination.address
      description: Event destination address
      type: Unknown
    - contextPath: ArcSightESM.SecurityEvents.startTime
      description: Start time in milliseconds
      type: date
    description: Returns the security event details
  - name: as-get-case-event-ids
    arguments:
    - name: caseId
      required: true
      description: 'Case ID, e.g., 7e6LEbF8BABCfA-dlp1rl1A=='
    outputs:
    - contextPath: ArcSightESM.CaseEvents
      description: Map of caseId => related event ids
      type: Unknown
    - contextPath: ArcSightESM.CaseEvents.LatestResult
      description: Event IDs of the last execution of this command
      type: Unknown
    description: Returns all case event IDs.
  - name: as-update-case
    arguments:
    - name: caseId
      required: true
      description: Case resource ID to update.
    - name: stage
      auto: PREDEFINED
      predefined:
      - CLOSED
      - QUEUED
      - FINAL
      - FOLLOW_UP
      - INITIAL
      description: Stage the case is in
    - name: severity
      auto: PREDEFINED
      predefined:
      - NONE
      - INSIGNIFICANT
      - MARGINAL
      - CRITICAL
      - CATASTROPHIC
      description: Ticket consequence Severity
    outputs:
    - contextPath: ArcSightESM.Cases
      description: List of cases
      type: unknown
    - contextPath: ArcSightESM.Cases.resourceid
      description: Case resource ID
      type: string
    - contextPath: ArcSightESM.Cases.stage
      description: 'Case stage '
      type: string
    - contextPath: ArcSightESM.Cases.consequenceSeverity
      description: Case severity
      type: string
    description: Updates a specific case.
    execution: true
  - name: as-get-all-query-viewers
    arguments: []
    outputs:
    - contextPath: ArcSightESM.AllQueryViewers
      description: List of all query viewer IDs
      type: Unknown
    description: Returns all the query viewer IDs.
  - name: as-case-delete
    arguments:
    - name: caseId
      required: true
      description: Resource ID of the case
    outputs:
    - contextPath: ArcSightESM.Cases.resourceid
      description: Resource ID of case
      type: string
    - contextPath: ArcSightESM.Cases.Deleted
      description: Boolean flag. "True" if deleted.
      type: boolean
    description: Deletes a case
    execution: true
  - name: as-get-query-viewer-results
    arguments:
    - name: id
      required: true
      description: Resource ID of the query viewer
    outputs:
    - contextPath: ArcSight.QueryViewerResults
      type: Unknown
      description: Query viewer results
    description: Retrieves query viewer results (query viewer must be configured to
      be refreshed every minute, see documentation)
  - name: as-fetch-incidents
    arguments:
    - name: last_run
      description: Last run to start fetching incidents from
    description: Fetches incidents
  isfetch: true
  runonce: false
tests:
  - ArcSight ESM Test
releaseNotes: "Rewrote the integration in Python and fixed sever issues."
