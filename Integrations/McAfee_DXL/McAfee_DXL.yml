category: Data Enrichment & Threat Intelligence
commonfields:
  id: McAfee DXL
  version: -1
configuration:
- display: Broker CA certificates content (see `brokercerts.crt` in instructions)
  name: broker_ca_bundle
  required: true
  type: 12
- display: Client certificates content (see `client.crt` in instructions)
  name: cert_file
  required: true
  type: 12
- display: Client private key content (e.g. `client.key`)
  name: private_key
  required: true
  type: 14
- display: Brokers urls (comma separated list in the form of - [ssl://]<hostname>[:port])
    - get hostname & port from `brokerlist.properties` file in instructions. Note
    that the broker should be reachable from demisto server
  name: broker_urls
  required: true
  type: 0
- defaultvalue: DXL_PUSH_IP
  display: The topic to publish the 'dxl-push-ip' to
  name: push_ip_topic
  required: false
  type: 0
- defaultvalue: DXL_PUSH_URL
  display: The topic to publish the 'dxl-push-url' to
  name: push_url_topic
  required: false
  type: 0
- defaultvalue: DXL_PUSH_DOMAIN
  display: The topic to publish the 'dxl-push-domain' to
  name: push_domain_topic
  required: false
  type: 0
- defaultvalue: DXL_PUSH_HASH
  display: The topic to publish the 'dxl-push-hash' to
  name: push_hash_topic
  required: false
  type: 0
description: McAfee DXL client
display: McAfee DXL
name: McAfee DXL
script:
  commands:
  - arguments:
    - default: false
      description: The topic to publish the message to
      isArray: false
      name: topic
      required: true
      secret: false
    - default: false
      description: Event payload
      isArray: false
      name: payload
      required: true
      secret: false
    deprecated: false
    description: Deliver the specified event to the DXL fabric
    execution: false
    name: dxl-send-event
  - arguments:
    - default: false
      description: IP to push to the DXL fabric
      isArray: false
      name: ip
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new trust level for the IP
      isArray: false
      name: trust_level
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      required: true
      secret: false
    - default: false
      description: The topic to publish the 'dxl-push-ip' to
      isArray: false
      name: topic
      required: false
      secret: false
    deprecated: false
    description: Push given IP  to the DXL fabric
    execution: false
    name: dxl-push-ip
  - arguments:
    - default: false
      description: URL to push to the DXL fabric
      isArray: false
      name: url
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new trust level for the URL
      isArray: false
      name: trust_level
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      required: true
      secret: false
    - default: false
      description: The topic to publish the 'dxl-push-url' to
      isArray: false
      name: topic
      required: false
      secret: false
    deprecated: false
    description: Push given url  to the DXL fabric
    execution: false
    name: dxl-push-url
  - arguments:
    - default: false
      description: Domain to push to the DXL fabric
      isArray: false
      name: domain
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new trust level for the domain
      isArray: false
      name: trust_level
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      required: true
      secret: false
    - default: false
      description: The topic to publish the 'dxl-push-domain' to
      isArray: false
      name: topic
      required: false
      secret: false
    deprecated: false
    description: Push given domain  to the DXL fabric
    execution: false
    name: dxl-push-domain
  - arguments:
    - default: false
      description: Hash to push to the DXL fabric
      isArray: false
      name: hash
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The new trust level for the domain
      isArray: false
      name: trust_level
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      required: true
      secret: false
    - default: false
      description: The topic to publish the 'dxl-push-hash' to
      isArray: false
      name: topic
      required: false
      secret: false
    deprecated: false
    description: Push given hash  to the DXL fabric
    execution: false
    name: dxl-push-hash
  dockerimage: demisto/dxl:1.0.0.4989
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- McAfee DXL - Test
