category: Data Enrichment & Threat Intelligence
commonfields:
  id: McAfee DXL
  version: -1
configuration:
- display: Broker CA certificates content (see `brokercerts.crt` in instructions)
  name: broker_ca_bundle
  defaultvalue: ""
  type: 12
  required: true
- display: Client certificates content (see `client.crt` in instructions)
  name: cert_file
  defaultvalue: ""
  type: 12
  required: true
- display: Client private key content (e.g. client.key)
  name: private_key
  defaultvalue: ""
  type: 12
  required: true
- display: Brokers urls (comma separated list in the form of - [ssl://]<hostname>[:port])
    - get hostname & port from `brokerlist.properties` file in instructions. Note
    that the broker should be reachable from demisto server
  name: broker_urls
  defaultvalue: ""
  type: 0
  required: true
- display: The topic to publish the 'dxl-push-ip' to
  name: push_ip_topic
  defaultvalue: DXL_PUSH_IP
  type: 0
  required: true
- display: The topic to publish the 'dxl-push-url' to
  name: push_url_topic
  defaultvalue: DXL_PUSH_URL
  type: 0
  required: true
- display: The topic to publish the 'dxl-push-domain' to
  name: push_domain_topic
  defaultvalue: DXL_PUSH_DOMAIN
  type: 0
  required: true
- display: The topic to publish the 'dxl-push-hash' to
  name: push_hash_topic
  defaultvalue: DXL_PUSH_HASH
  type: 0
  required: true
description: McAfee DXL client
display: McAfee DXL
name: McAfee DXL
script:
  commands:
  - name: dxl-send-event
    arguments:
    - name: topic
      required: true
      description: The topic to publish the message to
    - name: payload
      required: true
      description: Event payload
    description: Deliver the specified event to the DXL fabric
  - name: dxl-push-ip
    arguments:
    - name: ip
      required: true
      description: IP to push to the DXL fabric
    - name: trust_level
      required: true
      auto: PREDEFINED
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      description: The new trust level for the IP
    description: Push given IP  to the DXL fabric
  - name: dxl-push-url
    arguments:
    - name: url
      required: true
      description: URL to push to the DXL fabric
    - name: trust_level
      required: true
      auto: PREDEFINED
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      description: The new trust level for the URL
    description: Push given url  to the DXL fabric
  - name: dxl-push-domain
    arguments:
    - name: domain
      required: true
      description: Domain to push to the DXL fabric
    - name: trust_level
      required: true
      auto: PREDEFINED
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      description: The new trust level for the domain
    description: Push given domain  to the DXL fabric
  - name: dxl-push-hash
    arguments:
    - name: hash
      required: true
      description: Hash to push to the DXL fabric
    - name: trust_level
      required: true
      auto: PREDEFINED
      predefined:
      - NOT_SET
      - KNOWN_MALICIOUS
      - MOST_LIKELY_MALICIOUS
      - MIGHT_BE_MALICIOUS
      - UNKNOWN
      - MIGHT_BE_TRUSTED
      - MOST_LIKELY_TRUSTED
      - KNOWN_TRUSTED
      - KNOWN_TRUSTED_INSTALLER
      description: The new trust level for the domain
    description: Push given hash  to the DXL fabric
  isfetch: false
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
  dockerimage: demisto/dxl:1.0.0.4984
tests:
  - No tests