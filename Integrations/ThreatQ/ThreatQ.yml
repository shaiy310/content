category: Data Enrichment & Threat Intelligence
commonfields:
  id: ThreatQ_2
  version: -1
configuration:
- display: TQ SERVER URL E.g. https://192.168.1.136
  name: serverUrl
  required: true
  type: 0
- display: TQ Client ID
  name: client_id
  required: true
  type: 0
- display: Email
  name: credentials
  required: true
  type: 9
- defaultvalue: 'false'
  display: Insecure
  name: insecure
  required: false
  type: 8
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- defaultvalue: '8'
  display: Indicator threshold. Minimum TQ score to consider the indicator malicious.
  name: threshold
  required: false
  type: 0
description: ThreatQ Integration
display: ThreatQ_2
name: ThreatQ_2
script:
  commands:
  - arguments:
    - default: true
      description: keyword
      isArray: false
      name: keyword
      required: true
      secret: false
    - default: false
      defaultValue: '10'
      description: The maximum number of records to retrieve.
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Search ThreatQ repository by keywords. Search result default limit
      is 10 records.
    execution: false
    name: threatq-search-by-name
    outputs:
    - contextPath: ThreatQ.Indicator.ID
      description: Indicator's ID
      type: Number
    - contextPath: ThreatQ.Indicator.Value
      description: Indicator's value
      type: String
    - contextPath: ThreatQ.Event.ID
      description: Event's ID
      type: Number
    - contextPath: ThreatQ.Event.Value
      description: Event's value
      type: String
    - contextPath: ThreatQ.Adversary.ID
      description: Adversary's ID
      type: Number
    - contextPath: ThreatQ.Adversary.Value
      description: Adversary's value
      type: String
  - arguments:
    - default: false
      defaultValue: 8.8.8.8
      description: IP address
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Run ip check against ThreatQ
    execution: false
    name: ip
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: String
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: String
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: Number
    - contextPath: IP.Address
      description: IP Address
      type: String
    - contextPath: IP.Malicious.Vendor
      description: IP Vendor
      type: String
    - contextPath: IP.Malicious.Description
      description: IP Malicious description
      type: String
    - contextPath: ThreatQ.Indicator.ID
      description: Indicator's ID
      type: Number
    - contextPath: ThreatQ.Indicator.Value
      description: Indicator's value
      type: String
    - contextPath: ThreatQ.Indicator.Source.ID
      description: Indicator's source ID
      type: Number
    - contextPath: ThreatQ.Indicator.Source.Name
      description: Indicator's source name
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.ID
      description: Indicator's attribute ID
      type: Number
    - contextPath: ThreatQ.Indicator.Attribute.Value
      description: Indicator's attribute value
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.Name
      description: Indicator's attribute name
      type: String
    - contextPath: ThreatQ.Indicator.CreatedAt
      description: Indicator's creation date
      type: Date
    - contextPath: ThreatQ.Indicator.UpdatedAt
      description: Indicator's last update date
      type: Date
    - contextPath: ThreatQ.Indicator.Status
      description: Indicator's status
      type: String
    - contextPath: ThreatQ.Indicator.TQScore
      description: Indicator's ThreatQ score
      type: Number
    - contextPath: ThreatQ.Indicator.Description
      description: Indicator's description
      type: String
    - contextPath: ThreatQ.Indicator.Type
      description: Indicator's type
      type: String
  - arguments:
    - default: false
      defaultValue: www.google.com
      description: URL or FQDN
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: false
    description: Run url check against ThreatQ
    execution: false
    name: url
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: String
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: String
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: Number
    - contextPath: URL.Data
      description: URL
      type: String
    - contextPath: URL.Malicious.Vendor
      description: URL vendor
      type: String
    - contextPath: URL.Malicious.Description
      description: URL Malicious description
      type: String
    - contextPath: ThreatQ.Indicator.ID
      description: Indicator's ID
      type: Number
    - contextPath: ThreatQ.Indicator.Value
      description: Indicator's value
      type: String
    - contextPath: ThreatQ.Indicator.Source.ID
      description: Indicator's source ID
      type: Number
    - contextPath: ThreatQ.Indicator.Source.Name
      description: Indicator's source name
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.ID
      description: Indicator's attribute ID
      type: Number
    - contextPath: ThreatQ.Indicator.Attribute.Value
      description: Indicator's attribute value
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.Name
      description: Indicator's attribute name
      type: String
    - contextPath: ThreatQ.Indicator.CreatedAt
      description: Indicator's creation date
      type: Date
    - contextPath: ThreatQ.Indicator.UpdatedAt
      description: Indicator's last update date
      type: Date
    - contextPath: ThreatQ.Indicator.Status
      description: Indicator's status
      type: String
    - contextPath: ThreatQ.Indicator.TQScore
      description: Indicator's ThreatQ score
      type: Number
    - contextPath: ThreatQ.Indicator.Description
      description: Indicator's description
      type: String
    - contextPath: ThreatQ.Indicator.Type
      description: Indicator's type
      type: String
  - arguments:
    - default: false
      defaultValue: google.exe
      description: File name, MD5 or SHA
      isArray: false
      name: file
      required: false
      secret: false
    deprecated: false
    description: Run file check against ThreatQ
    execution: false
    name: file
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: String
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: String
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: Number
    - contextPath: File.Name
      description: File name
      type: String
    - contextPath: File.MD5
      description: File MD5
      type: String
    - contextPath: File.SHA1
      description: File SHA1
      type: String
    - contextPath: File.SHA256
      description: File SHA256
      type: String
    - contextPath: File.SHA512
      description: File SHA512
      type: String
    - contextPath: File.Path
      description: File path
      type: String
    - contextPath: File.Malicious.Vendor
      description: File vendor
      type: String
    - contextPath: File.Malicious.Malicious
      description: File Malicious description
      type: String
    - contextPath: ThreatQ.Indicator.ID
      description: Indicator's ID
      type: Number
    - contextPath: ThreatQ.Indicator.Value
      description: Indicator's value
      type: String
    - contextPath: ThreatQ.Indicator.Source.ID
      description: Indicator's source ID
      type: Number
    - contextPath: ThreatQ.Indicator.Source.Name
      description: Indicator's source name
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.ID
      description: Indicator's attribute ID
      type: Number
    - contextPath: ThreatQ.Indicator.Attribute.Value
      description: Indicator's attribute value
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.Name
      description: Indicator's attribute name
      type: String
    - contextPath: ThreatQ.Indicator.CreatedAt
      description: Indicator's creation date
      type: Date
    - contextPath: ThreatQ.Indicator.UpdatedAt
      description: Indicator's last update date
      type: Date
    - contextPath: ThreatQ.Indicator.Status
      description: Indicator's status
      type: String
    - contextPath: ThreatQ.Indicator.TQScore
      description: Indicator's ThreatQ score
      type: Number
    - contextPath: ThreatQ.Indicator.Description
      description: Indicator's description
      type: String
    - contextPath: ThreatQ.Indicator.Type
      description: Indicator's type
      type: String
  - arguments:
    - default: false
      defaultValue: example@gmail.com
      description: pre-commit
      isArray: false
      name: email
      required: true
      secret: false
    deprecated: false
    description: Run email check against ThreatQ
    execution: false
    name: email
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: String
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: String
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: Number
    - contextPath: Account.Email.Address
      description: Email Address
      type: String
    - contextPath: Account.Malicious.Vendor
      description: Account malicious vendor
      type: String
    - contextPath: Account.Malicious.Description
      description: Account Malicious description
      type: String
    - contextPath: ThreatQ.Indicator.ID
      description: Indicator's ID
      type: Number
    - contextPath: ThreatQ.Indicator.Value
      description: Indicator's value
      type: String
    - contextPath: ThreatQ.Indicator.Source.ID
      description: Indicator's source ID
      type: Number
    - contextPath: ThreatQ.Indicator.Source.Name
      description: Indicator's source name
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.ID
      description: Indicator's attribute ID
      type: Number
    - contextPath: ThreatQ.Indicator.Attribute.Value
      description: Indicator's attribute value
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.Name
      description: Indicator's attribute name
      type: String
    - contextPath: ThreatQ.Indicator.CreatedAt
      description: Indicator's creation date
      type: Date
    - contextPath: ThreatQ.Indicator.UpdatedAt
      description: Indicator's last update date
      type: Date
    - contextPath: ThreatQ.Indicator.Status
      description: Indicator's status
      type: String
    - contextPath: ThreatQ.Indicator.TQScore
      description: Indicator's ThreatQ score
      type: Number
    - contextPath: ThreatQ.Indicator.Description
      description: Indicator's description
      type: String
    - contextPath: ThreatQ.Indicator.Type
      description: Indicator's type
      type: String
  - arguments:
    - default: false
      description: pre-commit
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Run domain check against ThreatQ
    execution: false
    name: domain
    outputs:
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: String
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: String
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: Number
    - contextPath: Domain.Name
      description: Domain name
      type: String
    - contextPath: Domain.Malicious.Vendor
      description: Domain vendor
      type: String
    - contextPath: Domain.Malicious.Description
      description: Domain Malicious description
      type: String
    - contextPath: ThreatQ.Indicator.ID
      description: Indicator's ID
      type: Number
    - contextPath: ThreatQ.Indicator.Value
      description: Indicator's value
      type: String
    - contextPath: ThreatQ.Indicator.Source.ID
      description: Indicator's source ID
      type: Number
    - contextPath: ThreatQ.Indicator.Source.Name
      description: Indicator's source name
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.ID
      description: Indicator's attribute ID
      type: Number
    - contextPath: ThreatQ.Indicator.Attribute.Value
      description: Indicator's attribute value
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.Name
      description: Indicator's attribute name
      type: String
    - contextPath: ThreatQ.Indicator.CreatedAt
      description: Indicator's creation date
      type: Date
    - contextPath: ThreatQ.Indicator.UpdatedAt
      description: Indicator's last update date
      type: Date
    - contextPath: ThreatQ.Indicator.Status
      description: Indicator's status
      type: String
    - contextPath: ThreatQ.Indicator.TQScore
      description: Indicator's ThreatQ score
      type: Number
    - contextPath: ThreatQ.Indicator.Description
      description: Indicator's description
      type: String
    - contextPath: ThreatQ.Indicator.Type
      description: Indicator's type
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Indicator type
      isArray: false
      name: ioc_type
      predefined:
      - Binary String
      - CIDR Block
      - CVE
      - Email Address
      - Email Attachment
      - Email Subject
      - File Mapping
      - File Path
      - Filename
      - FQDN
      - Fuzzy Hash
      - GOST Hash
      - Hash ION
      - IP Address
      - IPv6 Address
      - MD5
      - Mutex
      - Password
      - Registry Key
      - Service Name
      - SHA-1
      - SHA-256
      - SHA-384
      - SHA-512
      - String
      - x509 Serial
      - x509 Subject
      - URL
      - URL Path
      - User-agent
      - Username
      - X-Mailer
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Indicator status
      isArray: false
      name: status
      predefined:
      - Active
      - Expired
      - Indirect
      - Review
      - Whitelisted
      required: true
      secret: false
    - default: false
      description: Indicator value
      isArray: false
      name: value
      required: true
      secret: false
    - default: false
      description: Source(s) name(s)
      isArray: true
      name: source_lst
      required: false
      secret: false
    - default: false
      description: Add Attribute
      isArray: true
      name: attr_names_lst
      required: false
      secret: false
    - default: false
      description: Attribute values
      isArray: true
      name: attr_values_lst
      required: false
      secret: false
    deprecated: false
    description: Create a new indicator in ThreatQ
    execution: false
    name: threatq-create-ioc
    outputs:
    - contextPath: ThreatQ.Indicator.ID
      description: Indicator's ID
      type: Number
    - contextPath: ThreatQ.Indicator.Value
      description: Indicator's value
      type: String
    - contextPath: ThreatQ.Indicator.Source.ID
      description: Indicator's source ID
      type: Number
    - contextPath: ThreatQ.Indicator.Source.Name
      description: Indicator's source name
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.ID
      description: Indicator's attribute ID
      type: Number
    - contextPath: ThreatQ.Indicator.Attribute.Value
      description: Indicator's attribute value
      type: String
    - contextPath: ThreatQ.Indicator.Attribute.Name
      description: Indicator's attribute name
      type: String
    - contextPath: ThreatQ.Indicator.CreatedAt
      description: Indicator's creation date
      type: Date
    - contextPath: ThreatQ.Indicator.UpdatedAt
      description: Indicator's last update date
      type: Date
    - contextPath: ThreatQ.Indicator.Status
      description: Indicator's status
      type: String
    - contextPath: ThreatQ.Indicator.TQScore
      description: Indicator's ThreatQ score
      type: Number
    - contextPath: ThreatQ.Indicator.Description
      description: Indicator's description
      type: String
    - contextPath: ThreatQ.Indicator.Type
      description: Indicator's type
      type: String
  - arguments:
    - default: false
      description: The attribute name
      isArray: false
      name: attr_name
      required: true
      secret: false
    - default: false
      description: The Attribute value
      isArray: false
      name: attr_value
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Object's type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - event
      - adversary
      - attachment
      required: true
      secret: false
    - default: false
      description: Object's ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    deprecated: false
    description: Add an attribute to an object in ThreatQ
    execution: false
    name: threatq-add-attribute
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Object's type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - adversary
      - event
      - attachment
      required: true
      secret: false
    - default: false
      description: Object's ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    - default: false
      description: Attribute id
      isArray: false
      name: attr_id
      required: true
      secret: false
    - default: false
      description: New attribute's value
      isArray: false
      name: attr_value
      required: true
      secret: false
    deprecated: false
    description: Modify an attribute on an object in ThreatQ
    execution: false
    name: threatq-modify-attribute
  - arguments:
    - default: false
      description: First object's ID
      isArray: false
      name: obj1_id
      required: true
      secret: false
    - default: false
      description: Second object's ID
      isArray: false
      name: obj2_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: First object's type
      isArray: false
      name: obj1_type
      predefined:
      - indicator
      - adversary
      - event
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Second object's type
      isArray: false
      name: obj2_type
      predefined:
      - indicator
      - adversary
      - event
      required: true
      secret: false
    deprecated: false
    description: Link between two objects in ThreatQ
    execution: false
    name: threatq-link-objects
  - arguments:
    - default: false
      description: Adversary name
      isArray: false
      name: name
      required: true
      secret: false
    - default: false
      description: Source(s) name(s)
      isArray: true
      name: source_lst
      required: false
      secret: false
    - default: false
      description: Add Attribute
      isArray: true
      name: attr_names_lst
      required: false
      secret: false
    - default: false
      description: Attribute values
      isArray: true
      name: attr_values_lst
      required: false
      secret: false
    deprecated: false
    description: Create a new adversary in ThreatQ
    execution: false
    name: threatq-create-adversary
    outputs:
    - contextPath: ThreatQ.Adversary.Name
      description: The adversary's name
      type: string
    - contextPath: ThreatQ.Adversary.ID
      description: The adversary's ID
      type: number
    - contextPath: ThreatQ.Adversary.Source.ID
      description: The adversary's source ID
      type: number
    - contextPath: ThreatQ.Adversary.Source.Name
      description: The adversary's source name
      type: string
    - contextPath: ThreatQ.Adversary.Attribute.ID
      description: The adversary's attribute ID
      type: number
    - contextPath: ThreatQ.Adversary.Attribute.Name
      description: The adversary's attribute name
      type: string
    - contextPath: ThreatQ.Adversary.Attribute.Value
      description: The adversary's attribute value
      type: string
    - contextPath: ThreatQ.Adversary.UpdatedAt
      description: The creation date of the adversary
      type: date
    - contextPath: ThreatQ.Adversary.CreatedAt
      description: The last update date of the adversary
      type: date
  - arguments:
    - default: false
      description: Event title
      isArray: false
      name: title
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Event type
      isArray: false
      name: event_type
      predefined:
      - Spearphish
      - Watering Hole
      - SQL Injection Attack
      - DoS Attack
      - Malware
      - Watchlist
      - Command and Control
      - Anonymization
      - Exfiltration
      - Host Characteristics
      - Compromised PKI Certificate
      - Login Compromise
      - Incident
      required: true
      secret: false
    - default: false
      description: 'Date of Occurrence. Valid formats: YYYY-mm-dd HH:MM:SS, YYYY-mm-dd'
      isArray: false
      name: date
      required: true
      secret: false
    - default: false
      description: Add Source
      isArray: true
      name: source_lst
      required: false
      secret: false
    - default: false
      description: List of attribute names, seperated by comma
      isArray: true
      name: attr_names_lst
      required: false
      secret: false
    - default: false
      description: Attribute values list, seperated by comma. The i-th element in
        this list is the value of the i-th attribute in attr_names_lst
      isArray: true
      name: attr_values_lst
      required: false
      secret: false
    deprecated: false
    description: Create a new event in ThreatQ
    execution: false
    name: threatq-create-event
    outputs:
    - contextPath: ThreatQ.Event.ID
      description: The event's ID
      type: number
    - contextPath: ThreatQ.Event.Source.ID
      description: The event's source ID
      type: number
    - contextPath: ThreatQ.Event.Source.Name
      description: The event's source name
      type: string
    - contextPath: ThreatQ.Event.Attribute.ID
      description: The event's attribute ID
      type: number
    - contextPath: ThreatQ.Event.Attribute.Name
      description: The event's attribute name
      type: string
    - contextPath: ThreatQ.Event.Attribute.Value
      description: The event's attribute value
      type: string
    - contextPath: ThreatQ.Event.UpdatedAt
      description: The last update date of the event
      type: date
    - contextPath: ThreatQ.Event.CreatedAt
      description: The creation date of the event
      type: date
    - contextPath: ThreatQ.Event.Type
      description: The object's type - event
      type: string
    - contextPath: ThreatQ.Event.Description
      description: Description about the event
      type: string
    - contextPath: ThreatQ.Event.Title
      description: The event's title
      type: string
    - contextPath: ThreatQ.Event.Occurred
      description: The date the event happened
      type: date
  - arguments:
    - default: false
      description: Object's ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Object's type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - event
      - adversary
      required: true
      secret: false
    deprecated: false
    description: Get related Indicators in ThreatQ
    execution: false
    name: threatq-get-related-ioc
    outputs:
    - contextPath: ThreatQ.Indicator.RelatedIndicator.ID
      description: Related indicator's ID
      type: number
    - contextPath: ThreatQ.RelatedIndicator.Source.ID
      description: Related indicator's source ID
      type: number
    - contextPath: ThreatQ.RelatedIndicator.Source.Name
      description: Related indicator's source name
      type: string
    - contextPath: ThreatQ.RelatedIndicator.Attribute.ID
      description: Related indicator's attribute ID
      type: number
    - contextPath: ThreatQ.RelatedIndicator.Attribute.Name
      description: Related indicator's attribute name
      type: string
    - contextPath: ThreatQ.RelatedIndicator.Attribute.Value
      description: Related indicator's attribute value
      type: string
    - contextPath: ThreatQ.RelatedIndicator.UpdatedAt
      description: Related indicator's last update date
      type: date
    - contextPath: ThreatQ.RelatedIndicator.CreatedAt
      description: Related indicator's creation date
      type: date
    - contextPath: ThreatQ.RelatedIndicator.Type
      description: Related object type - indicator
      type: string
    - contextPath: ThreatQ.RelatedIndicator.Description
      description: Description about the related indicator
      type: string
    - contextPath: ThreatQ.RelatedIndicator.Value
      description: Related indicator value
      type: string
    - contextPath: ThreatQ.RelatedIndicator.Status
      description: Related indicator status
      type: string
    - contextPath: ThreatQ.RelatedIndicator.IndicatorType
      description: Related indicator type
      type: string
    - contextPath: ThreatQ.RelatedIndicator.TQScore
      description: Related indicator ThreatQ score
      type: number
    - contextPath: ThreatQ.ID
      description: Object ID
      type: number
    - contextPath: ThreatQ.Type
      description: Object type
      type: string
  - arguments:
    - default: false
      description: Indicator's ID
      isArray: false
      name: ioc_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Indicator's new Status
      isArray: false
      name: status
      predefined:
      - Active
      - Expired
      - Indirect
      - Review
      - Whitelisted
      required: true
      secret: false
    deprecated: false
    description: Update an Indicator status in ThreatQ
    execution: false
    name: threatq-update-status
    outputs:
    - contextPath: ThreatQ.ID
      description: Indicator ID
      type: Number
    - contextPath: ThreatQ.Type
      description: Object type - indicator
      type: String
    - contextPath: ThreatQ.Status
      description: Indicator status
      type: String
  - arguments:
    - default: false
      description: Object's ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Object's type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - event
      - adversary
      required: true
      secret: false
    deprecated: false
    description: Get related Events in ThreatQ
    execution: false
    name: threatq-get-related-events
    outputs:
    - contextPath: ThreatQ.RelatedEvent.ID
      description: Related event ID
      type: number
    - contextPath: ThreatQ.RelatedEvent.Source.ID
      description: Related event source ID
      type: number
    - contextPath: ThreatQ.RelatedEvent.Source.Name
      description: Related event source name
      type: string
    - contextPath: ThreatQ.RelatedEvent.Attribute.ID
      description: Related event attribute ID
      type: number
    - contextPath: ThreatQ.RelatedEvent.Attribute.Name
      description: Related event attribute name
      type: string
    - contextPath: ThreatQ.RelatedEvent.Attribute.Value
      description: Related event attribute value
      type: string
    - contextPath: ThreatQ.RelatedEvent.UpdatedAt
      description: Related event last update date
      type: date
    - contextPath: ThreatQ.RelatedEvent.CreatedAt
      description: Related event creation date
      type: date
    - contextPath: ThreatQ.RelatedEvent.Description
      description: Description about the related event
      type: string
    - contextPath: ThreatQ.RelatedEvent.Title
      description: Related event title
      type: string
    - contextPath: ThreatQ.RelatedEvent.Occurred
      description: Related event date of occurrence
      type: date
    - contextPath: ThreatQ.RelatedEvent.EventType
      description: Related event type
      type: string
    - contextPath: ThreatQ.RelatedEvent.Type
      description: Related object type - event
      type: string
    - contextPath: ThreatQ.ID
      description: Object ID
      type: number
    - contextPath: ThreatQ.Type
      description: Object type
      type: Unknown
  - arguments:
    - default: false
      description: Object's ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Object type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - event
      - adversary
      required: true
      secret: false
    deprecated: false
    description: Get related Adversaries in ThreatQ
    execution: false
    name: threatq-get-related-adversaries
    outputs:
    - contextPath: ThreatQ.RelatedAdversary.ID
      description: Related adversary ID
      type: number
    - contextPath: ThreatQ.RelatedAdversary.Source.ID
      description: Related adversary source ID
      type: number
    - contextPath: ThreatQ.RelatedAdversary.Source.Name
      description: Related adversary source name
      type: string
    - contextPath: ThreatQ.RelatedAdversary.Attribute.ID
      description: Related adversary attribute ID
      type: number
    - contextPath: ThreatQ.RelatedAdversary.Attribute.Name
      description: Related adversary attribute name
      type: string
    - contextPath: ThreatQ.RelatedAdversary.Attribute.Value
      description: Related adversary attribute value
      type: string
    - contextPath: ThreatQ.RelatedAdversary.UpdatedAt
      description: Related adversary last update date
      type: date
    - contextPath: ThreatQ.RelatedAdversary.CreatedAt
      description: Related adversary creation date
      type: date
    - contextPath: ThreatQ.RelatedAdversary.Name
      description: Related adversary name
      type: string
    - contextPath: ThreatQ.RelatedAdversary.Type
      description: Related adversary type - adversary
      type: string
    - contextPath: ThreatQ.ID
      description: Object ID
      type: number
    - contextPath: ThreatQ.Type
      description: Object type
      type: string
  - arguments:
    - default: false
      description: The file entry ID in Demisto
      isArray: false
      name: entry_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: File category
      isArray: false
      name: file_type
      predefined:
      - Cuckoo
      - CrowdStrike Intelligence
      - Early Warning and Indicator Notice (EWIN)
      - FireEye Analysis
      - FBI FLASH
      - Generic Text
      - Intelligence Whitepaper
      - iSight Report
      - iSight ThreatScape Intelligence Report
      - JIB
      - MAEC
      - Malware Analysis Report
      - Malware Initial Findings Report (MFIR)
      - Malware Sample
      - Packet Capture
      - Palo Alto Networks WildFire XML
      - PCAP
      - PDF
      - Private Industry Notification (PIN)
      - Spearphish Attachment
      - STIX
      - ThreatAnalyzer Analysis
      - ThreatQ CSV File
      - Whitepaper
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'off'
      description: Enabling this will .zip malware files for safer downloading
      isArray: false
      name: malware_safety_lock
      predefined:
      - 'on'
      - 'off'
      required: false
      secret: false
    - default: false
      description: File title - by default, value would be the file name
      isArray: false
      name: title
      required: false
      secret: false
    deprecated: false
    description: Upload a file in ThreatQ
    execution: false
    name: threatq-upload-file
    outputs:
    - contextPath: ThreatQ.CreatedAt
      description: File upload date
      type: Date
    - contextPath: ThreatQ.Size
      description: File size (in bytes)
      type: Number
    - contextPath: ThreatQ.MD5
      description: File MD5
      type: String
    - contextPath: ThreatQ.Type
      description: Object type - File
      type: String
    - contextPath: ThreatQ.ID
      description: File ID in ThreatQ
      type: Number
    - contextPath: ThreatQ.Name
      description: File name
      type: String
    - contextPath: ThreatQ.Title
      description: File title
      type: String
    - contextPath: ThreatQ.UpdatedAt
      description: File last update
      type: Date
    - contextPath: ThreatQ.MalwareLocked
      description: If enabled, malware files will be zipped for safer downloading
      type: Number
    - contextPath: ThreatQ.ContentType
      description: File content type
      type: String
    - contextPath: ThreatQ.FileType
      description: File type
      type: String
    - contextPath: ThreatQ.Source.ID
      description: Source ID
      type: Number
    - contextPath: ThreatQ.Source.Name
      description: Source name
      type: String
    - contextPath: ThreatQ.Attribute.ID
      description: Attribute ID
      type: Number
    - contextPath: ThreatQ.Attribute.Name
      description: Attribute name
      type: String
    - contextPath: ThreatQ.Attribute.Value
      description: Attribute value
      type: String
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Object's type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - adversary
      - event
      - attachment
      required: true
      secret: false
    - default: false
      description: Object's ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    deprecated: false
    description: Search for an object by it's type and ID. When possible, generic
      and DBotScore contexts will be generated as well.
    execution: false
    name: threatq-search-by-id
    outputs:
    - contextPath: ThreatQ.ID
      description: Object's ID
      type: number
    - contextPath: ThreatQ.Source.ID
      description: Object's source ID
      type: number
    - contextPath: ThreatQ.Source.Name
      description: Object's source name
      type: string
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: string
    - contextPath: DBotScore.Score
      description: Indicator DBot Score
      type: date
    - contextPath: ThreatQ.Attribute.ID
      description: Object's attribute ID
      type: number
    - contextPath: ThreatQ.Attribute.Name
      description: Object's attribute name
      type: string
    - contextPath: ThreatQ.Attribute.Value
      description: Object's attribute value
      type: string
    - contextPath: ThreatQ.UpdatedAt
      description: Object's last update date
      type: date
    - contextPath: ThreatQ.CreatedAt
      description: Object's creation date
      type: date
    - contextPath: ThreatQ.Type
      description: Object's type
      type: string
    - contextPath: ThreatQ.Description
      description: Description about the object
      type: string
    - contextPath: ThreatQ.Value
      description: Indicator's value
      type: string
    - contextPath: ThreatQ.Status
      description: Indicator's status
      type: string
    - contextPath: ThreatQ.IndicatorType
      description: Indicator's type, e.g IP Address
      type: string
    - contextPath: ThreatQ.TQScore
      description: Indicator's ThreatQ Score
      type: number
    - contextPath: ThreatQ.Name
      description: Adversary's name
      type: string
    - contextPath: ThreatQ.Title
      description: Event's title
      type: string
    - contextPath: ThreatQ.Occurred
      description: Event's occurrence date
      type: date
    - contextPath: ThreatQ.EventType
      description: Event's type
      type: string
    - contextPath: ThreatQ.Size
      description: File size (in bytes)
      type: Number
    - contextPath: ThreatQ.MalwareLocked
      description: If enabled, malware files will be zipped for safer downloading
      type: String
    - contextPath: ThreatQ.ContentType
      description: File content type
      type: String
    - contextPath: ThreatQ.FileType
      description: File type
      type: String
    - contextPath: ThreatQ.MD5
      description: File MD5 value
      type: String
  - arguments:
    - default: false
      description: First object's ID
      isArray: false
      name: obj1_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: First object's type
      isArray: false
      name: obj1_type
      predefined:
      - adversary
      - indicator
      - event
      required: true
      secret: false
    - default: false
      description: Second object's ID
      isArray: false
      name: obj2_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Second object's type
      isArray: false
      name: obj2_type
      predefined:
      - adversary
      - indicator
      - event
      required: true
      secret: false
    deprecated: false
    description: Unlink two objects in ThreatQ
    execution: false
    name: threatq-unlink-objects
  - arguments:
    - default: false
      description: Object's ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Object's type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - event
      - adversary
      - attachment
      required: true
      secret: false
    deprecated: false
    description: Delete an object in ThreatQ
    execution: false
    name: threatq-delete-object
  - arguments:
    - default: false
      description: Object ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Object type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - adversary
      - event
      - attachment
      required: true
      secret: false
    - default: false
      description: Source name
      isArray: false
      name: source
      required: true
      secret: false
    deprecated: false
    description: Add a source to an object in ThreatQ
    execution: false
    name: threatq-add-source
  - arguments:
    - default: false
      description: Source ID
      isArray: false
      name: source_id
      required: true
      secret: false
    - default: false
      description: Object ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Object type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - adversary
      - event
      - attachment
      required: true
      secret: false
    deprecated: false
    description: Delete a source from an object in ThreatQ
    execution: false
    name: threatq-delete-source
  - arguments:
    - default: false
      description: Attribute ID
      isArray: false
      name: attr_id
      required: true
      secret: false
    - default: false
      description: Object ID
      isArray: false
      name: obj_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Object type
      isArray: false
      name: obj_type
      predefined:
      - indicator
      - adversary
      - event
      - attachment
      required: true
      secret: false
    deprecated: false
    description: Delete an attribute from an object in ThreatQ
    execution: false
    name: threatq-delete-attribute
  - arguments:
    - default: false
      description: Adversary ID
      isArray: false
      name: adversary_id
      required: true
      secret: false
    - default: false
      description: New adversary name
      isArray: false
      name: name
      required: true
      secret: false
    deprecated: false
    description: Update an adversary name in ThreatQ
    execution: false
    name: threatq-edit-adversary
    outputs:
    - contextPath: ThreatQ.ID
      description: Adversary ID
      type: Number
    - contextPath: ThreatQ.Type
      description: Object type (adversary)
      type: String
    - contextPath: ThreatQ.Name
      description: Adversary name
      type: String
    - contextPath: ThreatQ.UpdatedAt
      description: Adversary's last update date
      type: Date
  - arguments:
    - default: false
      description: Indicator ID
      isArray: false
      name: ioc_id
      required: true
      secret: false
    - default: false
      description: New indicator value
      isArray: false
      name: value
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: New indicator type
      isArray: false
      name: ioc_type
      predefined:
      - Binary String
      - CIDR Block
      - CVE
      - Email Address
      - Email Attachment
      - Email Subject
      - File Mapping
      - File Path
      - Filename
      - FQDN
      - Fuzzy Hash
      - GOST Hash
      - Hash ION
      - IP Address
      - IPv6 Address
      - MD5
      - Mutex
      - Password
      - Registry Key
      - Service Name
      - SHA-1
      - SHA-256
      - SHA-384
      - SHA-512
      - String
      - x509 Serial
      - x509 Subject
      - URL
      - URL Path
      - User-agent
      - Username
      - X-Mailer
      required: false
      secret: false
    - default: false
      description: Indicator description
      isArray: false
      name: description
      required: false
      secret: false
    deprecated: false
    description: Update an indicator in ThreatQ.
    execution: false
    name: threatq-edit-ioc
    outputs:
    - contextPath: ThreatQ.ID
      description: Indicator ID
      type: Number
    - contextPath: ThreatQ.Type
      description: Object type - indicator
      type: String
    - contextPath: ThreatQ.IndicatorType
      description: Indicator type
      type: String
    - contextPath: ThreatQ.Value
      description: Indicator value
      type: String
    - contextPath: ThreatQ.UpdatedAt
      description: Indicator's last update date
      type: Date
    - contextPath: ThreatQ.Description
      description: Indicator description
      type: String
  - arguments:
    - default: false
      description: Event ID
      isArray: false
      name: event_id
      required: true
      secret: false
    - default: false
      description: New event title
      isArray: false
      name: title
      required: false
      secret: false
    - default: false
      description: 'Date of Occurrence. Valid formats: YYYY-mm-dd HH:MM:SS, YYYY-mm-dd'
      isArray: false
      name: date
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Event type
      isArray: false
      name: event_type
      predefined:
      - Spearphish
      - Watering Hole
      - SQL Injection Attack
      - DoS Attack
      - Malware
      - Watchlist
      - Command and Control
      - Anonymization
      - Exfiltration
      - Host Characteristics
      - Compromised PKI Certificate
      - Login Compromise
      - Incident
      required: false
      secret: false
    - default: false
      description: Event description
      isArray: false
      name: description
      required: false
      secret: false
    deprecated: false
    description: Update an event in ThreatQ
    execution: false
    name: threatq-edit-event
    outputs:
    - contextPath: ThreatQ.ID
      description: Event ID
      type: Number
    - contextPath: ThreatQ.Type
      description: Object type - event
      type: String
    - contextPath: ThreatQ.Title
      description: Event title
      type: String
    - contextPath: ThreatQ.Occurred
      description: Event occurrence date
      type: Date
    - contextPath: ThreatQ.UpdatedAt
      description: Event last update date
      type: Date
    - contextPath: ThreatQ.EventType
      description: Event type
      type: String
    - contextPath: ThreatQ.Description
      description: Event description
      type: String
  - arguments:
    - default: false
      description: Indicator's ID
      isArray: false
      name: ioc_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Manual score
      isArray: false
      name: score
      predefined:
      - Generated Score
      - '0'
      - '1'
      - '2'
      - '3'
      - '4'
      - '5'
      - '6'
      - '7'
      - '8'
      - '9'
      - '10'
      required: true
      secret: false
    deprecated: false
    description: Modify an indicator's score in ThreatQ. Notice that final TQ Score
      would be the maximum between manual and generated scores.
    execution: false
    name: threatq-update-score
    outputs:
    - contextPath: ThreatQ.ID
      description: Indicator's ID
      type: Number
    - contextPath: ThreatQ.Type
      description: Object type - indicator
      type: String
    - contextPath: ThreatQ.TQScore
      description: Indicator TQ Score
      type: Number
    - contextPath: ThreatQ.UpdatedAt
      description: Indicator's last update date
      type: Date
    - contextPath: DBotScore.Indicator
      description: Indicator value
      type: String
    - contextPath: DBotScore.Vendor
      description: Indicator vendor
      type: String
    - contextPath: DBotScore.Score
      description: Indicator DBot score
      type: Number
    - contextPath: DBotScore.Type
      description: Indicator type
      type: String
  - arguments:
    - default: false
      description: File ID
      isArray: false
      name: file_id
      required: true
      secret: false
    deprecated: false
    description: Download a file from ThreatQ to Demisto
    execution: false
    name: threatq-download-file
  - deprecated: false
    description: Get all indicators in ThreatQ
    execution: false
    name: threatq-get-all-iocs
    outputs:
    - contextPath: ThreatQ.Indicator.ID
      description: Indicator's ID
      type: number
    - contextPath: ThreatQ.Indicator.Source.ID
      description: Indicator's source ID
      type: number
    - contextPath: ThreatQ.Indicator.Source.Name
      description: Indicator's source name
      type: string
    - contextPath: ThreatQ.Indicator.Attribute.ID
      description: Indicator's attribute ID
      type: number
    - contextPath: ThreatQ.Indicator.Attribute.Name
      description: Indicator's attribute name
      type: string
    - contextPath: ThreatQ.Indicator.Attribute.Value
      description: Indicator's attribute value
      type: string
    - contextPath: ThreatQ.Indicator.CreatedAt
      description: Indicator's creation date
      type: date
    - contextPath: ThreatQ.Indicator.UpdatedAt
      description: Indicator's last update date
      type: date
    - contextPath: ThreatQ.Indicator.Description
      description: Description about the indicator
      type: string
    - contextPath: ThreatQ.Indicator.Value
      description: The indicator's value
      type: string
    - contextPath: ThreatQ.Indicator.Status
      description: The indicator's status - Active/Expired/Indirect/Review/Whitelisted
      type: string
    - contextPath: ThreatQ.Indicator.Type
      description: The indicator's type, e.g IP Address
      type: string
    - contextPath: ThreatQ.Indicator.TQScore
      description: The indicator's ThreatQ Score
      type: number
  - deprecated: false
    description: Get all events in ThreatQ
    execution: false
    name: threatq-get-all-events
    outputs:
    - contextPath: ThreatQ.Event.ID
      description: The event's ID
      type: number
    - contextPath: ThreatQ.Event.Source.ID
      description: The event's source ID
      type: number
    - contextPath: ThreatQ.Event.Source.Name
      description: The event's source name
      type: string
    - contextPath: ThreatQ.Event.Attribute.ID
      description: The event's attribute ID
      type: number
    - contextPath: ThreatQ.Event.Attribute.Name
      description: The event's attribute name
      type: string
    - contextPath: ThreatQ.Event.Attribute.Value
      description: The event's attribute value
      type: string
    - contextPath: ThreatQ.Event.UpdatedAt
      description: The last update date of the event
      type: date
    - contextPath: ThreatQ.Event.CreatedAt
      description: The creation date of the event
      type: date
    - contextPath: ThreatQ.Event.Type
      description: The object's type - event
      type: string
    - contextPath: ThreatQ.Event.Description
      description: Description about the event
      type: string
    - contextPath: ThreatQ.Event.Title
      description: The event's title
      type: string
    - contextPath: ThreatQ.Event.Occurred
      description: The date the event happened
      type: date
  - deprecated: false
    description: Get all adversaries in ThreatQ
    execution: false
    name: threatq-get-all-adversaries
    outputs:
    - contextPath: ThreatQ.Adversary.Name
      description: The adversary's name
      type: string
    - contextPath: ThreatQ.Adversary.ID
      description: The adversary's ID
      type: number
    - contextPath: ThreatQ.Adversary.Source.ID
      description: The adversary's source ID
      type: number
    - contextPath: ThreatQ.Adversary.Source.Name
      description: The adversary's source name
      type: string
    - contextPath: ThreatQ.Adversary.Attribute.ID
      description: The adversary's attribute ID
      type: number
    - contextPath: ThreatQ.Adversary.Attribute.Name
      description: The adversary's attribute name
      type: string
    - contextPath: ThreatQ.Adversary.Attribute.Value
      description: The adversary's attribute value
      type: string
    - contextPath: ThreatQ.Adversary.UpdatedAt
      description: The creation date of the adversary
      type: date
    - contextPath: ThreatQ.Adversary.CreatedAt
      description: The last update date of the adversary
      type: date
  dockerimage: demisto/python3:3.7.4.977
  isfetch: false
  runonce: false
  script: '-'
  type: python
  subtype: python3
