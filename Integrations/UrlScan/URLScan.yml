category: Data Enrichment & Threat Intelligence
commonfields:
  id: urlscan.io
  version: -1
configuration:
- display: API Key (needed only for submitting URLs for scanning)
  name: apikey
  required: false
  type: 4
- display: Trust any certificate (unsecure)
  name: insecure
  required: false
  type: 8
- defaultvalue: 'true'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: '1'
  display: URL Threshold. Minimum number of positive results from urlscan.io to consider
    the URL malicious.
  name: url_threshold
  required: false
  type: 0
- display: Submission Privacy Default
  name: privacy
  defaultvalue: public
  type: 15
  required: false
  options:
  - public
  - private
description: Urlscan.io reputation
display: urlscan.io
name: urlscan.io
script:
  commands:
  - arguments:
    - default: true
      description: Enter a parameter to search as a string (IP, File name, sha256,
        url, domain)
      isArray: false
      name: searchParameter
      required: true
      secret: false
    - default: false
      defaultValue: '20'
      description: Limits the returned results
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Search for an indicator that is related to former urlscan.io scans.
    execution: false
    name: urlscan-search
    outputs:
    - contextPath: URLScan.URL
      description: URL found
      type: string
    - contextPath: URLScan.Domain
      description: Domain of the url scanned
      type: string
    - contextPath: URLScan.ASN
      description: ASN of the URL scanned
      type: string
    - contextPath: URLScan.IP
      description: IP of the url scanned
      type: string
    - contextPath: URLScan.ScanID
      description: Scan ID for the URL scanned
      type: string
    - contextPath: URLScan.ScanDate
      description: Latest scan date for the URL
      type: string
    - contextPath: URLScan.Hash
      description: SHA256 of file scanned
      type: string
    - contextPath: URLScan.FileName
      description: Filename of the file scanned
      type: string
    - contextPath: URLScan.FileSize
      description: File size of the file scanned
      type: number
    - contextPath: URLScan.FileType
      description: File type of the file scanned
      type: string
  - arguments:
    - default: true
      description: Url to scan
      isArray: false
      name: url
      required: true
      secret: false
    - default: false
      defaultValue: '60'
      description: How many seconds to wait for the scan id result
      isArray: false
      name: timeout
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: public
      description: Will the submission be public or private
      isArray: false
      name: public
      predefined:
      - public
      - private
      required: false
      secret: false
    - default: false
      defaultValue: '20'
      description: Limits the returned list of Certificates, IP's and ASN's
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: true
    description: 'Deprecated: replaced with url command'
    execution: false
    name: urlscan-submit
    outputs:
    - contextPath: URL.Data
      description: URL submitted
      type: string
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision
      type: string
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason for the vendor to make the decision
      type: string
    - contextPath: URLScan.RelatedIPs
      description: Related IPs found for the URL scanned
      type: string
    - contextPath: URLScan.RelatedASNs
      description: Related ASNs found for the URL scanned
      type: string
    - contextPath: URLScan.Countries
      description: Associated countries for the URL scanned
      type: string
    - contextPath: URLScan.RelatedHash
      description: Related hashes found for the URL scanned
      type: string
    - contextPath: URLScan.Subdomains
      description: Associated subdomains for the url scanned
      type: string
    - contextPath: URLScan.ASN
      description: ASN of the URL scanned
      type: string
    - contextPath: URLScan.Data
      description: URL of the file found
      type: string
    - contextPath: URLScan.Malicious.Vendor
      description: Vendor reporting the malicious indicator for the file
      type: string
    - contextPath: URLScan.Malicious.Description
      description: Description of the malicious indicator
      type: string
    - contextPath: URLScan.File.Hash
      description: SHA256 of file found
      type: string
    - contextPath: URLScan.File.FileName
      description: File name of file found
      type: string
    - contextPath: URLScan.File.FileType
      description: File type of the file found
      type: string
    - contextPath: URLScan.File.Hostname
      description: URL where the file was found
      type: string
    - contextPath: URLScan.Certificates
      description: Certificates found for the URL scanned
      type: string
    - contextPath: DBotScore.Score
      description: Score retrieved for Dbot
      type: number
    - contextPath: DBotScore.Type
      description: Type of indicator tested for
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor who provided DBot Score
      type: string
    - contextPath: DBotScore.Indicator
      description: Indicator URLScan tested for
      type: string
    - contextPath: URLScan.RedirectedURLs
      description: Redirected URLs from the URL scanned
      type: string
    - contextPath: URLScan.EffectiveURL
      description: Effective URL of the original URL
      type: string
  - arguments:
    - default: false
      description: Url to scan
      isArray: false
      name: url
      required: true
      secret: false
    - default: false
      defaultValue: '60'
      description: How many seconds to wait for the scan id result
      isArray: false
      name: timeout
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: public
      description: Will the submission be public or private
      isArray: false
      name: public
      predefined:
      - public
      - private
      required: false
      secret: false
    - default: false
      defaultValue: '20'
      description: Limits the results in the war room
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      defaultValue: '5'
      description: Wait time between tries if we reach the API rate limit in seconds
      isArray: false
      name: wait
      required: false
      secret: false
    - default: false
      defaultValue: '0'
      description: Number of retries for API rate limit
      isArray: false
      name: retries
      required: false
      secret: false
    deprecated: false
    description: Submit a url to scan
    execution: false
    name: url
    outputs:
    - contextPath: URL.Data
      description: URL submitted
      type: string
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision
      type: string
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason for the vendor to make the decision
      type: string
    - contextPath: URLScan.RelatedIPs
      description: Related IPs found for the URL scanned
      type: string
    - contextPath: URLScan.RelatedASNs
      description: Related ASNs found for the URL scanned
      type: string
    - contextPath: URLScan.Countries
      description: Associated countries for the URL scanned
      type: string
    - contextPath: URLScan.RelatedHash
      description: Related hashes found for the URL scanned
      type: string
    - contextPath: URLScan.Subdomains
      description: Associated subdomains for the url scanned
      type: string
    - contextPath: URLScan.ASN
      description: ASN of the URL scanned
      type: string
    - contextPath: URLScan.Data
      description: URL of the file found
      type: string
    - contextPath: URLScan.Malicious.Vendor
      description: Vendor reporting the malicious indicator for the file
      type: string
    - contextPath: URLScan.Malicious.Description
      description: Description of the malicious indicator
      type: string
    - contextPath: URLScan.File.Hash
      description: SHA256 of file found
      type: string
    - contextPath: URLScan.File.FileName
      description: File name of file found
      type: string
    - contextPath: URLScan.File.FileType
      description: File type of the file found
      type: string
    - contextPath: URLScan.File.Hostname
      description: URL where the file was found
      type: string
    - contextPath: URLScan.Certificates
      description: Certificates found for the URL scanned
      type: string
    - contextPath: DBotScore.Score
      description: Score retrieved for Dbot
      type: string
    - contextPath: DBotScore.Type
      description: Type of indicator tested for
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor who provided DBot Score
      type: string
    - contextPath: DBotScore.Indicator
      description: Indicator URLScan tested for
      type: string
    - contextPath: URLScan.RedirectedURLs
      description: Redirected URLs from the URL scanned
      type: string
    - contextPath: URLScan.EffectiveURL
      description: Effective URL of the original URL
      type: string
  - arguments:
    - default: false
      description: The uuid of the URL to search the transaction list for.
      isArray: false
      name: uuid
      required: true
      secret: false
    - default: false
      defaultValue: '20'
      description: Limits the results in the war room(Maximum limit allowed is 100)
      isArray: false
      name: limit
      required: false
      secret: false
    - default: false
      description: The URL to search the transaction list for.
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: true
    description: Get http transaction list for a given url. (This command should be
      used only apart from urlscan-get-http-transactions script)
    execution: false
    name: urlscan-get-http-transaction-list
    outputs:
    - contextPath: URLScan.URL
      description: The URL address that was examined.
      type: string
    - contextPath: URLScan.httpTransaction
      description: A link to the http transaction made during the search on the given
        URL.
      type: string
  - arguments:
    - default: false
      description: The URL sought after.
      isArray: false
      name: url
      required: true
      secret: false
    deprecated: true
    description: Submit a URL to get its uuid.
    execution: false
    name: urlscan-submit-url-command
  - arguments:
    - default: false
      description: The uri of the sought after result.
      isArray: false
      name: uri
      required: true
      secret: false
    deprecated: true
    description: Poll the UrlScan service regarding the results for a given uri.
    execution: false
    name: urlscan-poll-uri
  - arguments:
    - default: false
      description: The uuid of the URL you want to search
      isArray: false
      name: uuid
      required: true
      secret: false
    deprecated: true
    description: Get the results page for the given UUID
    execution: false
    name: urlscan-get-result-page
  isfetch: false
  runonce: false
  script: ''
  type: python
  subtype: python2
defaultEnabled: false
