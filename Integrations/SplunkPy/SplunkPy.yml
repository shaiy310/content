category: Analytics & SIEM
commonfields:
  id: SplunkPy
  version: -1
configuration:
- display: Host - ip (x.x.x.x)
  name: host
  required: true
  type: 0
- display: Username
  name: authentication
  required: true
  type: 9
- defaultvalue: '8089'
  display: Port
  name: port
  required: true
  type: 0
- defaultvalue: search index=notable | eval rule_name=if(isnull(rule_name),source,rule_name)
    | eval rule_title=if(isnull(rule_title),rule_name,rule_title) | `get_urgency`
    | `risk_correlation` | eval rule_description=if(isnull(rule_description),source,rule_description)
    | eval security_domain=if(isnull(security_domain),source,security_domain)
  display: Fetch notable events ES query
  name: fetchQuery
  required: false
  type: 0
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- display: 'Proxy - in format: 127.0.0.1:8080'
  name: proxy
  required: false
  type: 0
- display: Timezone of Splunk server in minutes e.g. for gmt +3 set +180 (set only
    if different than Demisto server), relevent for fetch notable events only
  name: timezone
  required: false
  type: 0
- defaultvalue: 'false'
  display: Parse Raw of notable events
  name: parseNotableEventsRaw
  required: false
  type: 8
- display: Extract Fields - comma separated fields that will be parsed out of _raw
    notable events
  name: extractFields
  required: false
  type: 12
- defaultvalue: 'false'
  display: Use Splunk Clock Time For Fetch
  name: useSplunkTime
  required: false
  type: 8
- defaultvalue: 'true'
  display: Trust any certificate (unsecure)
  name: unsecure
  required: false
  type: 8
- defaultvalue: '200'
  display: Fetch Limit
  name: fetch_limit
  required: false
  type: 0
description: Run queries on Splunk servers
display: SplunkPy
name: SplunkPy
script:
  commands:
  - arguments:
    - default: true
      description: search id
      isArray: false
      name: sid
      required: true
      secret: false
    deprecated: false
    description: fetch splunk search results, can be used in conjunction with splunk-job-create
    execution: false
    name: splunk-results
  - arguments:
    - default: true
      description: The splunk search language string to execute, example :"index=*
        | head 3"
      isArray: false
      name: query
      required: true
      secret: false
    - default: false
      description: 'Specifies the earliest time in the time range to search. The time
        string can be a UTC time (with fractional seconds), a relative time specifier
        (to now), or a formatted time string. Default is 1 week ago, in this format
        "-7d", also possible to do time as: 2014-06-19T12:00:00.000-07:00"'
      isArray: false
      name: earliest_time
      required: false
      secret: false
    - default: false
      description: Specifies the latest time in the time range to search. The time
        string can be a UTC time (with fractional seconds), a relative time specifier
        (to now), or a formatted time string, example "2014-06-19T12:00:00.000-07:00"
        or "-3d" (for time 3 days before now)
      isArray: false
      name: latest_time
      required: false
      secret: false
    - default: false
      description: Limit the amount of events to return, Default is 100, put 0 for
        unlimited
      isArray: false
      name: event_limit
      required: false
      secret: false
    deprecated: false
    description: Search Splunk for events
    execution: false
    name: splunk-search
    outputs:
    - contextPath: Splunk.Result
      description: The splunk search result, json array where each item is a splunk
        event
      type: Unknown
  - arguments:
    - default: false
      description: Splunk index to push data to, run splunk-get-indexes to get all
        indexes
      isArray: false
      name: index
      required: true
      secret: false
    - default: true
      description: The new event data to push, can be any string
      isArray: false
      name: data
      required: true
      secret: false
    - default: false
      description: Event sourcetype
      isArray: false
      name: sourcetype
      required: true
      secret: false
    - default: false
      description: Event host, can be 'Local' or '120.0.0.1' for example
      isArray: false
      name: host
      required: true
      secret: false
    deprecated: false
    description: Create new event in splunk
    execution: false
    name: splunk-submit-event
  - deprecated: false
    description: Print all Splunk index names
    execution: false
    name: splunk-get-indexes
  - arguments:
    - default: false
      description: 'The notable events event_id, comma separated for a list '
      isArray: false
      name: eventIDs
      required: true
      secret: false
    - default: false
      description: Splunk user to assign to notable event
      isArray: false
      name: owner
      required: false
      secret: false
    - default: false
      description: Comment to add to notable event
      isArray: false
      name: comment
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Notable Event urgency
      isArray: false
      name: urgency
      predefined:
      - critical
      - high
      - medium
      - low
      - informational
      required: false
      secret: false
    - default: false
      description: Notable event status- 0 for Unassigned,1 for Assigned, 2 for In
        Progress, 3 for pending, 4 for Resolved, 5 for Closed
      isArray: false
      name: status
      required: false
      secret: false
    deprecated: false
    description: Update an existing Notable event in Splunk ES
    execution: true
    name: splunk-notable-event-edit
  - arguments:
    - default: false
      description: The splunk search language string to execute, example :"index=*
        | head 3"
      isArray: false
      name: query
      required: true
      secret: false
    deprecated: false
    description: Create new search job in Splunk
    execution: false
    name: splunk-job-create
    outputs:
    - contextPath: Splunk.Job
      description: The created job SID
      type: Unknown
  - arguments:
    - default: true
      defaultValue: ${Splunk.Result._raw}
      description: The Raw data of splunk event, in string format
      isArray: false
      name: raw
      required: false
      secret: false
    deprecated: false
    description: Parse the Raw part of the event
    execution: false
    name: splunk-parse-raw
    outputs:
    - contextPath: Splunk.Raw.Parsed
      description: The raw event data parsed
      type: unknown
  dockerimage: demisto/splunksdk:1.0
  isfetch: true
  runonce: false
  script: '-'
  type: python
