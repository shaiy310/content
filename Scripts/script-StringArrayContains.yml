commonfields:
  id: StringArrayContains
  version: -1
name: StringArrayContains
script: |
  var str = args.left;
  var substring = args.right;

  if(!str || !substring){
      return false;
  }

  if (Array.isArray(substring)) {
      var arr = substring;
      for (var i = 0; i < arr.length; ++i) {
          if (arr[i] && str.indexOf(arr[i]) > -1) {
                  return true;
          }
      }
  } else {
      if (str.indexOf(substring) > -1) {
          return true;
      }
  }

  return false;
type: javascript
tags:
- filter
- string
comment: |
  Checks whether a substring is within a string array - each item will be checked. Supports single strings as well.
enabled: true
args:
- name: left
  description: ""
- name: right
  description: ""
scripttarget: 0
runonce: false
releaseNotes: ''
tests:
  - No test - Pending