commonfields:
  id: StringContainsArray
  version: -1
name: StringContainsArray
script: |
  var str = args.left;
  var substring = args.right;

  if(!str || !substring){
      return false;
  }

  if (Array.isArray(substring)) {
      var arr = substring;
      for (var i = 0; i < arr.length; ++i) {
          if (arr[i] && str.indexOf(arr[i]) > -1) {
                  return true;
          }
      }
  } else {
      if (str.indexOf(substring) > -1) {
          return true;
      }
  }

  return false;
type: javascript
tags:
- filter
- string
comment: |
  Checks whether a substring is within a string array - each item will be checked. Supports single strings as well. For example, for a substring 'a' in an array of strings ['a','b','c'] the script will return true.
enabled: true
args:
- name: left
  description: The array of strings to search in
- name: right
  description: The substring to search for
scripttarget: 0
runonce: false
releaseNotes: 'New filter to check if a string contains a substring from an array'
tests:
  - StringContainsArray_test